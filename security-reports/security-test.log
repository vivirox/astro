2025-03-17 15:32:58 Starting security tests...
[1;33mChecking dependencies...[0m
[1;33mts-node is not installed. Installing...[0m
[1;33mInstalling dependencies...[0m
[1;33mRunning security tests...[0m
/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:859
    return new TSError(diagnosticText, diagnosticCodes, diagnostics);
           ^
TSError: â¨¯ Unable to compile TypeScript:
run-security-tests.ts(101,11): error TS7022: 'process' implicitly has type 'any' because it does not have a type annotation and is referenced directly or indirectly in its own initializer.
run-security-tests.ts(103,12): error TS2448: Block-scoped variable 'process' used before its declaration.
run-security-tests.ts(114,32): error TS7006: Parameter 'data' implicitly has an 'any' type.
run-security-tests.ts(119,32): error TS7006: Parameter 'data' implicitly has an 'any' type.
run-security-tests.ts(124,26): error TS7006: Parameter 'code' implicitly has an 'any' type.
run-security-tests.ts(284,42): error TS7006: Parameter 'item' implicitly has an 'any' type.
run-security-tests.ts(297,42): error TS7006: Parameter 'item' implicitly has an 'any' type.
run-security-tests.ts(330,27): error TS7006: Parameter 'item' implicitly has an 'any' type.
run-security-tests.ts(361,38): error TS7006: Parameter 'item' implicitly has an 'any' type.
run-security-tests.ts(369,38): error TS7006: Parameter 'item' implicitly has an 'any' type.
run-security-tests.ts(377,38): error TS7006: Parameter 'item' implicitly has an 'any' type.
run-security-tests.ts(385,38): error TS7006: Parameter 'item' implicitly has an 'any' type.
run-security-tests.ts(448,20): error TS18046: 'error' is of type 'unknown'.
run-security-tests.ts(482,20): error TS7006: Parameter 'item' implicitly has an 'any' type.
run-security-tests.ts(484,11): error TS7053: Element implicitly has an 'any' type because expression of type 'any' can't be used to index type '{ Critical: number; High: number; Medium: number; Low: number; }'.

    at createTSError (/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:859:12)
    at reportTSError (/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:863:19)
    at getOutput (/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:1077:36)
    at Object.compile (/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:1433:41)
    at Module.m._compile (/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:1617:30)
    at loadTS (node:internal/modules/cjs/loader:1826:10)
    at Object.require.extensions.<computed> [as .ts] (/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:1621:12)
    at Module.load (node:internal/modules/cjs/loader:1469:32)
    at Function._load (node:internal/modules/cjs/loader:1286:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14) {
  diagnosticCodes: [
     7022, 2448, 7006, 7006,
     7006, 7006, 7006, 7006,
     7006, 7006, 7006, 7006,
    18046, 7006, 7053
  ]
}
[0;32m
Security tests completed successfully! ðŸŽ‰[0m
[0;32mCheck the report at: /Users/vivi/astro/tests/security/../../security-reports/ai-security-report-2025-03-17.html[0m
2025-03-17 15:35:20 Security tests completed.
2025-03-17 15:36:19 Starting security tests...
[1;33mChecking dependencies...[0m
[1;33mRunning security tests...[0m
/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:859
    return new TSError(diagnosticText, diagnosticCodes, diagnostics);
           ^
TSError: â¨¯ Unable to compile TypeScript:
run-security-tests.ts(337,27): error TS7006: Parameter 'item' implicitly has an 'any' type.
run-security-tests.ts(368,38): error TS7006: Parameter 'item' implicitly has an 'any' type.
run-security-tests.ts(376,38): error TS7006: Parameter 'item' implicitly has an 'any' type.
run-security-tests.ts(384,38): error TS7006: Parameter 'item' implicitly has an 'any' type.
run-security-tests.ts(392,38): error TS7006: Parameter 'item' implicitly has an 'any' type.

    at createTSError (/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:859:12)
    at reportTSError (/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:863:19)
    at getOutput (/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:1077:36)
    at Object.compile (/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:1433:41)
    at Module.m._compile (/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:1617:30)
    at loadTS (node:internal/modules/cjs/loader:1826:10)
    at Object.require.extensions.<computed> [as .ts] (/Users/vivi/Library/pnpm/global/5/.pnpm/ts-node@10.9.2_@types+node@22.13.10_typescript@5.8.2/node_modules/ts-node/src/index.ts:1621:12)
    at Module.load (node:internal/modules/cjs/loader:1469:32)
    at Function._load (node:internal/modules/cjs/loader:1286:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14) {
  diagnosticCodes: [ 7006, 7006, 7006, 7006, 7006 ]
}
[0;32m
Security tests completed successfully! ðŸŽ‰[0m
[0;32mCheck the report at: /Users/vivi/astro/tests/security/../../security-reports/ai-security-report-2025-03-17.html[0m
2025-03-17 15:36:20 Security tests completed.
2025-03-17 15:36:46 Starting security tests...
[1;33mChecking dependencies...[0m
[1;33mRunning security tests...[0m
Starting AI security tests...

Running Endpoint Security...
Error running test suite Endpoint Security: ReferenceError: __dirname is not defined
    at file:///Users/vivi/astro/tests/security/run-security-tests.ts:159:30
    at new Promise (<anonymous>)
    at runTestSuite (file:///Users/vivi/astro/tests/security/run-security-tests.ts:101:10)
    at runTests (file:///Users/vivi/astro/tests/security/run-security-tests.ts:500:15)
    at file:///Users/vivi/astro/tests/security/run-security-tests.ts:507:1
    at ModuleJob.run (node:internal/modules/esm/module_job:274:25)
    at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:644:26)
    at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:98:5)

Running Authentication Bypass...
Error running test suite Authentication Bypass: ReferenceError: __dirname is not defined
    at file:///Users/vivi/astro/tests/security/run-security-tests.ts:159:30
    at new Promise (<anonymous>)
    at runTestSuite (file:///Users/vivi/astro/tests/security/run-security-tests.ts:101:10)
    at runTests (file:///Users/vivi/astro/tests/security/run-security-tests.ts:500:15)

Running Web Vulnerabilities...
Error running test suite Web Vulnerabilities: ReferenceError: __dirname is not defined
    at file:///Users/vivi/astro/tests/security/run-security-tests.ts:159:30
    at new Promise (<anonymous>)
    at runTestSuite (file:///Users/vivi/astro/tests/security/run-security-tests.ts:101:10)
    at runTests (file:///Users/vivi/astro/tests/security/run-security-tests.ts:500:15)

Security testing complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-security-report-2025-03-17.html

Summary:
- Total test suites: 3
- Total duration: 0.00s

Issues by severity:
- Critical: 0
- High: 3
- Medium: 0
- Low: 0
(node:71539) ExperimentalWarning: Type Stripping is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
(node:71539) [MODULE_TYPELESS_PACKAGE_JSON] Warning: Module type of file:///Users/vivi/astro/tests/security/run-security-tests.ts is not specified and it doesn't parse as CommonJS.
Reparsing as ES module because module syntax was detected. This incurs a performance overhead.
To eliminate this warning, add "type": "module" to /Users/vivi/astro/tests/security/package.json.
[0;32m
Security tests completed successfully! ðŸŽ‰[0m
[0;32mCheck the report at: /Users/vivi/astro/tests/security/../../security-reports/ai-security-report-2025-03-17.html[0m
2025-03-17 15:36:47 Security tests completed.
2025-03-17 15:37:26 Starting security tests...
[1;33mChecking dependencies...[0m
[1;33mRunning security tests...[0m
(node:71862) ExperimentalWarning: `--experimental-loader` may be removed in the future; instead use `register()`:
--import 'data:text/javascript,import { register } from "node:module"; import { pathToFileURL } from "node:url"; register("ts-node/esm", pathToFileURL("./"));'
(Use `node --trace-warnings ...` to show where the warning was created)
(node:71862) [DEP0180] DeprecationWarning: fs.Stats constructor is deprecated.
(Use `node --trace-deprecation ...` to show where the warning was created)
Starting AI security tests...

Running Endpoint Security...
(node:71884) ExperimentalWarning: Type Stripping is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)

Starting AI endpoint security scan...


Testing endpoint: /api/ai/completion (POST)
- Test case: Valid request
  - User: Regular User

    Status: 0, Expected: 200, Passed: No

  - User: Admin User

    Status: 0, Expected: 200, Passed: No

- Test case: Missing authentication

  - User: Anonymous

    Status: 0, Expected: 401, Passed: No

- Test case: SQL injection attempt

  - User: Regular User

    Status: 0, Expected: 400, Passed: No

  - User: Admin User

    Status: 0, Expected: 400, Passed: No

- Test case: XSS attempt

  - User: Regular User

    Status: 0, Expected: 400, Passed: No

  - User: Admin User

    Status: 0, Expected: 400, Passed: No

- Test case: Large payload

  - User: Regular User

    Status: 0, Expected: 413, Passed: No

  - User: Admin User

    Status: 0, Expected: 413, Passed: No


Testing endpoint: /api/ai/usage (GET)

- Test case: Valid request
  - User: Admin User

    Status: 0, Expected: 200, Passed: No

- Test case: Missing authentication

  - User: Anonymous

    Status: 0, Expected: 401, Passed: No

- Test case: Insufficient permissions

  - User: Regular User

    Status: 0, Expected: 403, Passed: No


Scan complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-endpoint-scan-2025-03-17.json


Summary:
- Total tests: 12
- Passed: 0
- Failed: 12

Failed tests:
- /api/ai/completion (POST) - Valid request: 
- /api/ai/completion (POST) - Valid request: 
- /api/ai/completion (POST) - Missing authentication: 
- /api/ai/completion (POST) - SQL injection attempt: 
- /api/ai/completion (POST) - SQL injection attempt: 
- /api/ai/completion (POST) - XSS attempt: 
- /api/ai/completion (POST) - XSS attempt: 
- /api/ai/completion (POST) - Large payload: 
- /api/ai/completion (POST) - Large payload: 
- /api/ai/usage (GET) - Valid request: 
- /api/ai/usage (GET) - Missing authentication: 
- /api/ai/usage (GET) - Insufficient permissions: 


Running Authentication Bypass...
Error: Cannot find package 'jsonwebtoken' imported from /Users/vivi/astro/tests/security/ai-auth-bypass-tester.ts
    at Object.getPackageJSONURL (node:internal/modules/package_json_reader:267:9)
    at packageResolve (node:internal/modules/esm/resolve:768:81)
    at moduleResolve (node:internal/modules/esm/resolve:854:18)
    at defaultResolve (node:internal/modules/esm/resolve:984:11)
    at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:780:12)
    at ModuleLoader.#cachedDefaultResolve (node:internal/modules/esm/loader:704:25)
    at ModuleLoader.resolve (node:internal/modules/esm/loader:687:38)
    at ModuleLoader.getModuleJobForImport (node:internal/modules/esm/loader:305:38)
    at ModuleJob._link (node:internal/modules/esm/module_job:137:49) {
  code: 'ERR_MODULE_NOT_FOUND'
}

Error running test suite Authentication Bypass: Error: Test suite Authentication Bypass failed with code 1: Error: Cannot find package 'jsonwebtoken' imported from /Users/vivi/astro/tests/security/ai-auth-bypass-tester.ts
    at Object.getPackageJSONURL (node:internal/modules/package_json_reader:267:9)
    at packageResolve (node:internal/modules/esm/resolve:768:81)
    at moduleResolve (node:internal/modules/esm/resolve:854:18)
    at defaultResolve (node:internal/modules/esm/resolve:984:11)
    at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:780:12)
    at ModuleLoader.#cachedDefaultResolve (node:internal/modules/esm/loader:704:25)
    at ModuleLoader.resolve (node:internal/modules/esm/loader:687:38)
    at ModuleLoader.getModuleJobForImport (node:internal/modules/esm/loader:305:38)
    at ModuleJob._link (node:internal/modules/esm/module_job:137:49) {
  code: 'ERR_MODULE_NOT_FOUND'
}

    at ChildProcess.<anonymous> (file:///Users/vivi/astro/tests/security/run-security-tests.ts:95:24)
    at ChildProcess.emit (node:events:507:28)
    at maybeClose (node:internal/child_process:1101:16)
    at ChildProcess._handle.onexit (node:internal/child_process:305:5)

Running Web Vulnerabilities...
Error: Cannot find package 'cheerio' imported from /Users/vivi/astro/tests/security/ai-web-vulnerability-scanner.ts
    at Object.getPackageJSONURL (node:internal/modules/package_json_reader:267:9)
    at packageResolve (node:internal/modules/esm/resolve:768:81)
    at moduleResolve (node:internal/modules/esm/resolve:854:18)
    at defaultResolve (node:internal/modules/esm/resolve:984:11)
    at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:780:12)
    at ModuleLoader.#cachedDefaultResolve (node:internal/modules/esm/loader:704:25)
    at ModuleLoader.resolve (node:internal/modules/esm/loader:687:38)
    at ModuleLoader.getModuleJobForImport (node:internal/modules/esm/loader:305:38)
    at ModuleJob._link (node:internal/modules/esm/module_job:137:49) {
  code: 'ERR_MODULE_NOT_FOUND'
}

Error running test suite Web Vulnerabilities: Error: Test suite Web Vulnerabilities failed with code 1: Error: Cannot find package 'cheerio' imported from /Users/vivi/astro/tests/security/ai-web-vulnerability-scanner.ts
    at Object.getPackageJSONURL (node:internal/modules/package_json_reader:267:9)
    at packageResolve (node:internal/modules/esm/resolve:768:81)
    at moduleResolve (node:internal/modules/esm/resolve:854:18)
    at defaultResolve (node:internal/modules/esm/resolve:984:11)
    at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:780:12)
    at ModuleLoader.#cachedDefaultResolve (node:internal/modules/esm/loader:704:25)
    at ModuleLoader.resolve (node:internal/modules/esm/loader:687:38)
    at ModuleLoader.getModuleJobForImport (node:internal/modules/esm/loader:305:38)
    at ModuleJob._link (node:internal/modules/esm/module_job:137:49) {
  code: 'ERR_MODULE_NOT_FOUND'
}

    at ChildProcess.<anonymous> (file:///Users/vivi/astro/tests/security/run-security-tests.ts:95:24)
    at ChildProcess.emit (node:events:507:28)
    at maybeClose (node:internal/child_process:1101:16)
    at ChildProcess._handle.onexit (node:internal/child_process:305:5)

Security testing complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-security-report-2025-03-17.html

Summary:
- Total test suites: 3
- Total duration: 6.41s

Issues by severity:
- Critical: 0
- High: 2
- Medium: 0
- Low: 0
[0;32m
Security tests completed successfully! ðŸŽ‰[0m
[0;32mCheck the report at: /Users/vivi/astro/tests/security/../../security-reports/ai-security-report-2025-03-17.html[0m
2025-03-17 15:37:34 Security tests completed.
2025-03-17 19:38:19 Starting security tests...
[1;33mChecking dependencies...[0m
[1;33mRunning security tests...[0m
(node:36972) ExperimentalWarning: `--experimental-loader` may be removed in the future; instead use `register()`:
--import 'data:text/javascript,import { register } from "node:module"; import { pathToFileURL } from "node:url"; register("ts-node/esm", pathToFileURL("./"));'
(Use `node --trace-warnings ...` to show where the warning was created)
(node:36972) [DEP0180] DeprecationWarning: fs.Stats constructor is deprecated.
(Use `node --trace-deprecation ...` to show where the warning was created)
Starting AI security tests...

Running Endpoint Security...
(node:37002) ExperimentalWarning: Type Stripping is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)

Starting AI endpoint security scan...


Testing endpoint: /api/ai/completion (POST)
- Test case: Valid request
  - User: Regular User

    Status: 0, Expected: 200, Passed: No

  - User: Admin User

    Status: 0, Expected: 200, Passed: No

- Test case: Missing authentication

  - User: Anonymous

    Status: 0, Expected: 401, Passed: No

- Test case: SQL injection attempt

  - User: Regular User

    Status: 0, Expected: 400, Passed: No

  - User: Admin User

    Status: 0, Expected: 400, Passed: No

- Test case: XSS attempt

  - User: Regular User

    Status: 0, Expected: 400, Passed: No

  - User: Admin User

    Status: 0, Expected: 400, Passed: No

- Test case: Large payload

  - User: Regular User

    Status: 0, Expected: 413, Passed: No

  - User: Admin User

    Status: 0, Expected: 413, Passed: No


Testing endpoint: /api/ai/usage (GET)

- Test case: Valid request
  - User: Admin User

    Status: 0, Expected: 200, Passed: No

- Test case: Missing authentication
  - User: Anonymous

    Status: 0, Expected: 401, Passed: No

- Test case: Insufficient permissions

  - User: Regular User

    Status: 0, Expected: 403, Passed: No


Scan complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-endpoint-scan-2025-03-17.json


Summary:
- Total tests: 12
- Passed: 0
- Failed: 12

Failed tests:
- /api/ai/completion (POST) - Valid request: 
- /api/ai/completion (POST) - Valid request: 
- /api/ai/completion (POST) - Missing authentication: 
- /api/ai/completion (POST) - SQL injection attempt: 
- /api/ai/completion (POST) - SQL injection attempt: 
- /api/ai/completion (POST) - XSS attempt: 
- /api/ai/completion (POST) - XSS attempt: 
- /api/ai/completion (POST) - Large payload: 
- /api/ai/completion (POST) - Large payload: 

- /api/ai/usage (GET) - Valid request: 
- /api/ai/usage (GET) - Missing authentication: 
- /api/ai/usage (GET) - Insufficient permissions: 


Running Authentication Bypass...
(node:37072) ExperimentalWarning: Type Stripping is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)

Starting AI authentication and authorization bypass tests...


Testing endpoint: /api/ai/completion (POST)
Required role: user

Testing missing authentication for /api/ai/completion (POST)

Testing JWT manipulation for /api/ai/completion (POST)

Testing cookie manipulation for /api/ai/completion (POST)

Testing header manipulation for /api/ai/completion (POST)

Testing parameter pollution for /api/ai/completion (POST)

Testing RBAC bypass for /api/ai/completion (POST)


Results for /api/ai/completion (POST):
- Tests run: 11
- Successful bypasses: 0

Testing endpoint: /api/ai/usage (GET)
Required role: user
Testing missing authentication for /api/ai/usage (GET)

Testing JWT manipulation for /api/ai/usage (GET)

Testing cookie manipulation for /api/ai/usage (GET)

Testing header manipulation for /api/ai/usage (GET)

Testing parameter pollution for /api/ai/usage (GET)

Testing RBAC bypass for /api/ai/usage (GET)


Results for /api/ai/usage (GET):
- Tests run: 11
- Successful bypasses: 0

Testing endpoint: /api/ai/admin/dashboard (GET)
Required role: admin
Testing missing authentication for /api/ai/admin/dashboard (GET)

Testing JWT manipulation for /api/ai/admin/dashboard (GET)

Testing cookie manipulation for /api/ai/admin/dashboard (GET)

Testing header manipulation for /api/ai/admin/dashboard (GET)

Testing parameter pollution for /api/ai/admin/dashboard (GET)

Testing RBAC bypass for /api/ai/admin/dashboard (GET)


Results for /api/ai/admin/dashboard (GET):

- Tests run: 11
- Successful bypasses: 0

Testing endpoint: /api/ai/admin/users (GET)
Required role: admin
Testing missing authentication for /api/ai/admin/users (GET)

Testing JWT manipulation for /api/ai/admin/users (GET)

Testing cookie manipulation for /api/ai/admin/users (GET)

Testing header manipulation for /api/ai/admin/users (GET)

Testing parameter pollution for /api/ai/admin/users (GET)

Testing RBAC bypass for /api/ai/admin/users (GET)


Results for /api/ai/admin/users (GET):

- Tests run: 11
- Successful bypasses: 0

Testing endpoint: /api/ai/admin/settings (POST)
Required role: admin
Testing missing authentication for /api/ai/admin/settings (POST)

Testing JWT manipulation for /api/ai/admin/settings (POST)

Testing cookie manipulation for /api/ai/admin/settings (POST)

Testing header manipulation for /api/ai/admin/settings (POST)

Testing parameter pollution for /api/ai/admin/settings (POST)

Testing RBAC bypass for /api/ai/admin/settings (POST)


Results for /api/ai/admin/settings (POST):

- Tests run: 11
- Successful bypasses: 0


Scan complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-auth-bypass-2025-03-17.json


Summary:
- Total tests: 55
- Successful bypasses: 0
- Failed bypasses: 55


Running Web Vulnerabilities...
(node:37230) ExperimentalWarning: Type Stripping is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)

Starting AI web vulnerability scan...


Testing security headers...
Testing for missing security headers...


Testing CORS misconfigurations...

Testing for CORS misconfigurations...


Testing information disclosure...

Testing for information disclosure...


Scan complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-web-vulnerability-scan-2025-03-17.json


Summary:

- Total tests: 3
- Vulnerable: 3
- Safe: 0

Vulnerabilities found:

High severity (3):

- Security Headers Test: Error testing security headers: 
- CORS Test: Error testing CORS: 
- Information Disclosure Test: Error testing information disclosure: 


Security testing complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-security-report-2025-03-17.html

Summary:
- Total test suites: 3
- Total duration: 33.47s

Issues by severity:
- Critical: 0
- High: 0
- Medium: 0
- Low: 0
[0;32m
Security tests completed successfully! ðŸŽ‰[0m
[0;32mCheck the report at: /Users/vivi/astro/tests/security/../../security-reports/ai-security-report-2025-03-17.html[0m
2025-03-17 19:38:53 Security tests completed.
2025-03-17 19:50:40 Starting security tests...
[1;33mChecking dependencies...[0m
[1;33mRunning security tests...[0m
(node:41536) ExperimentalWarning: `--experimental-loader` may be removed in the future; instead use `register()`:
--import 'data:text/javascript,import { register } from "node:module"; import { pathToFileURL } from "node:url"; register("ts-node/esm", pathToFileURL("./"));'
(Use `node --trace-warnings ...` to show where the warning was created)
(node:41536) [DEP0180] DeprecationWarning: fs.Stats constructor is deprecated.
(Use `node --trace-deprecation ...` to show where the warning was created)
Starting AI security tests...

Running Endpoint Security...
TypeError: Unknown file extension ".ts" for /Users/vivi/astro/tests/security/ai-endpoint-scanner.ts
    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)
    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)
    at defaultLoad (node:internal/modules/esm/load:120:22)
    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)
    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19) {
  code: 'ERR_UNKNOWN_FILE_EXTENSION'
}

Error running test suite Endpoint Security: Error: Test suite Endpoint Security failed with code 1: TypeError: Unknown file extension ".ts" for /Users/vivi/astro/tests/security/ai-endpoint-scanner.ts
    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)
    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)
    at defaultLoad (node:internal/modules/esm/load:120:22)
    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)
    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19) {
  code: 'ERR_UNKNOWN_FILE_EXTENSION'
}

    at ChildProcess.<anonymous> (file:///Users/vivi/astro/tests/security/run-security-tests.ts:95:24)
    at ChildProcess.emit (node:events:524:28)
    at maybeClose (node:internal/child_process:1101:16)
    at ChildProcess._handle.onexit (node:internal/child_process:304:5)

Running Authentication Bypass...
TypeError: Unknown file extension ".ts" for /Users/vivi/astro/tests/security/ai-auth-bypass-tester.ts
    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)
    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)
    at defaultLoad (node:internal/modules/esm/load:120:22)
    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)
    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19) {
  code: 'ERR_UNKNOWN_FILE_EXTENSION'
}

Error running test suite Authentication Bypass: Error: Test suite Authentication Bypass failed with code 1: TypeError: Unknown file extension ".ts" for /Users/vivi/astro/tests/security/ai-auth-bypass-tester.ts
    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)
    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)
    at defaultLoad (node:internal/modules/esm/load:120:22)
    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)
    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19) {
  code: 'ERR_UNKNOWN_FILE_EXTENSION'
}

    at ChildProcess.<anonymous> (file:///Users/vivi/astro/tests/security/run-security-tests.ts:95:24)
    at ChildProcess.emit (node:events:524:28)
    at maybeClose (node:internal/child_process:1101:16)
    at ChildProcess._handle.onexit (node:internal/child_process:304:5)

Running Web Vulnerabilities...
TypeError: Unknown file extension ".ts" for /Users/vivi/astro/tests/security/ai-web-vulnerability-scanner.ts
    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)
    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)
    at defaultLoad (node:internal/modules/esm/load:120:22)
    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)
    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19) {
  code: 'ERR_UNKNOWN_FILE_EXTENSION'
}

Error running test suite Web Vulnerabilities: Error: Test suite Web Vulnerabilities failed with code 1: TypeError: Unknown file extension ".ts" for /Users/vivi/astro/tests/security/ai-web-vulnerability-scanner.ts
    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)
    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)
    at defaultLoad (node:internal/modules/esm/load:120:22)
    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)
    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19) {
  code: 'ERR_UNKNOWN_FILE_EXTENSION'
}

    at ChildProcess.<anonymous> (file:///Users/vivi/astro/tests/security/run-security-tests.ts:95:24)
    at ChildProcess.emit (node:events:524:28)
    at maybeClose (node:internal/child_process:1101:16)
    at ChildProcess._handle.onexit (node:internal/child_process:304:5)

Security testing complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-security-report-2025-03-17.html

Summary:
- Total test suites: 3
- Total duration: 0.00s

Issues by severity:
- Critical: 0
- High: 3
- Medium: 0
- Low: 0
[0;32m
Security tests completed successfully! ðŸŽ‰[0m
[0;32mCheck the report at: /Users/vivi/astro/tests/security/../../security-reports/ai-security-report-2025-03-17.html[0m
2025-03-17 19:50:43 Security tests completed.
2025-03-17 22:40:05 Starting security tests...
[1;33mChecking dependencies...[0m
[1;33mRunning security tests...[0m
(node:33993) ExperimentalWarning: `--experimental-loader` may be removed in the future; instead use `register()`:
--import 'data:text/javascript,import { register } from "node:module"; import { pathToFileURL } from "node:url"; register("ts-node/esm", pathToFileURL("./"));'
(Use `node --trace-warnings ...` to show where the warning was created)
(node:33993) [DEP0180] DeprecationWarning: fs.Stats constructor is deprecated.
(Use `node --trace-deprecation ...` to show where the warning was created)
Starting AI security tests...

Running Endpoint Security...
TypeError: Unknown file extension ".ts" for /Users/vivi/astro/tests/security/ai-endpoint-scanner.ts
    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)
    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)
    at defaultLoad (node:internal/modules/esm/load:120:22)
    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)
    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19) {
  code: 'ERR_UNKNOWN_FILE_EXTENSION'
}

Error running test suite Endpoint Security: Error: Test suite Endpoint Security failed with code 1: TypeError: Unknown file extension ".ts" for /Users/vivi/astro/tests/security/ai-endpoint-scanner.ts
    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)
    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)
    at defaultLoad (node:internal/modules/esm/load:120:22)
    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)
    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19) {
  code: 'ERR_UNKNOWN_FILE_EXTENSION'
}

    at ChildProcess.<anonymous> (file:///Users/vivi/astro/tests/security/run-security-tests.ts:95:24)
    at ChildProcess.emit (node:events:524:28)
    at maybeClose (node:internal/child_process:1101:16)
    at Socket.<anonymous> (node:internal/child_process:456:11)
    at Socket.emit (node:events:524:28)
    at Pipe.<anonymous> (node:net:351:12)

Running Authentication Bypass...
TypeError: Unknown file extension ".ts" for /Users/vivi/astro/tests/security/ai-auth-bypass-tester.ts
    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)
    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)
    at defaultLoad (node:internal/modules/esm/load:120:22)
    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)
    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19) {
  code: 'ERR_UNKNOWN_FILE_EXTENSION'
}

Error running test suite Authentication Bypass: Error: Test suite Authentication Bypass failed with code 1: TypeError: Unknown file extension ".ts" for /Users/vivi/astro/tests/security/ai-auth-bypass-tester.ts
    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)
    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)
    at defaultLoad (node:internal/modules/esm/load:120:22)
    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)
    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19) {
  code: 'ERR_UNKNOWN_FILE_EXTENSION'
}

    at ChildProcess.<anonymous> (file:///Users/vivi/astro/tests/security/run-security-tests.ts:95:24)
    at ChildProcess.emit (node:events:524:28)
    at maybeClose (node:internal/child_process:1101:16)
    at ChildProcess._handle.onexit (node:internal/child_process:304:5)

Running Web Vulnerabilities...
TypeError: Unknown file extension ".ts" for /Users/vivi/astro/tests/security/ai-web-vulnerability-scanner.ts
    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)
    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)
    at defaultLoad (node:internal/modules/esm/load:120:22)
    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)
    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19) {
  code: 'ERR_UNKNOWN_FILE_EXTENSION'
}

Error running test suite Web Vulnerabilities: Error: Test suite Web Vulnerabilities failed with code 1: TypeError: Unknown file extension ".ts" for /Users/vivi/astro/tests/security/ai-web-vulnerability-scanner.ts
    at Object.getFileProtocolModuleFormat [as file:] (node:internal/modules/esm/get_format:219:9)
    at defaultGetFormat (node:internal/modules/esm/get_format:245:36)
    at defaultLoad (node:internal/modules/esm/load:120:22)
    at async ModuleLoader.loadAndTranslate (node:internal/modules/esm/loader:483:32)
    at async ModuleJob._link (node:internal/modules/esm/module_job:115:19) {
  code: 'ERR_UNKNOWN_FILE_EXTENSION'
}

    at ChildProcess.<anonymous> (file:///Users/vivi/astro/tests/security/run-security-tests.ts:95:24)
    at ChildProcess.emit (node:events:524:28)
    at maybeClose (node:internal/child_process:1101:16)
    at Socket.<anonymous> (node:internal/child_process:456:11)
    at Socket.emit (node:events:524:28)
    at Pipe.<anonymous> (node:net:351:12)

Security testing complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-security-report-2025-03-18.html

Summary:
- Total test suites: 3
- Total duration: 0.00s

Issues by severity:
- Critical: 0
- High: 3
- Medium: 0
- Low: 0
[0;32m
Security tests completed successfully! ðŸŽ‰[0m
[0;32mCheck the report at: /Users/vivi/astro/tests/security/../../security-reports/ai-security-report-2025-03-17.html[0m
2025-03-17 22:40:07 Security tests completed.
2025-03-17 23:08:45 Starting security tests...
[1;33mChecking dependencies...[0m
[1;33mRunning security tests...[0m
(node:47847) ExperimentalWarning: `--experimental-loader` may be removed in the future; instead use `register()`:
--import 'data:text/javascript,import { register } from "node:module"; import { pathToFileURL } from "node:url"; register("ts-node/esm", pathToFileURL("./"));'
(Use `node --trace-warnings ...` to show where the warning was created)
(node:47847) [DEP0180] DeprecationWarning: fs.Stats constructor is deprecated.
(Use `node --trace-deprecation ...` to show where the warning was created)
Starting AI security tests...

Running Endpoint Security...
(node:47884) ExperimentalWarning: Type Stripping is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)

Starting AI endpoint security scan...


Testing endpoint: /api/ai/completion (POST)
- Test case: Valid request
  - User: Regular User

    Status: 0, Expected: 200, Passed: No

  - User: Admin User

    Status: 0, Expected: 200, Passed: No

- Test case: Missing authentication

  - User: Anonymous

    Status: 0, Expected: 401, Passed: No

- Test case: SQL injection attempt

  - User: Regular User

    Status: 0, Expected: 400, Passed: No

  - User: Admin User

    Status: 0, Expected: 400, Passed: No

- Test case: XSS attempt
  - User: Regular User

    Status: 0, Expected: 400, Passed: No

  - User: Admin User

    Status: 0, Expected: 400, Passed: No

- Test case: Large payload

  - User: Regular User

    Status: 0, Expected: 413, Passed: No

  - User: Admin User

    Status: 0, Expected: 413, Passed: No


Testing endpoint: /api/ai/usage (GET)

- Test case: Valid request
  - User: Admin User

    Status: 0, Expected: 200, Passed: No

- Test case: Missing authentication

  - User: Anonymous

    Status: 0, Expected: 401, Passed: No

- Test case: Insufficient permissions

  - User: Regular User

    Status: 0, Expected: 403, Passed: No


Scan complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-endpoint-scan-2025-03-18.json


Summary:
- Total tests: 12
- Passed: 0
- Failed: 12

Failed tests:
- /api/ai/completion (POST) - Valid request: 
- /api/ai/completion (POST) - Valid request: 
- /api/ai/completion (POST) - Missing authentication: 
- /api/ai/completion (POST) - SQL injection attempt: 
- /api/ai/completion (POST) - SQL injection attempt: 
- /api/ai/completion (POST) - XSS attempt: 
- /api/ai/completion (POST) - XSS attempt: 
- /api/ai/completion (POST) - Large payload: 
- /api/ai/completion (POST) - Large payload: 
- /api/ai/usage (GET) - Valid request: 
- /api/ai/usage (GET) - Missing authentication: 
- /api/ai/usage (GET) - Insufficient permissions: 


Running Authentication Bypass...
(node:47976) ExperimentalWarning: Type Stripping is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)

Starting AI authentication and authorization bypass tests...


Testing endpoint: /api/ai/completion (POST)
Required role: user

Testing missing authentication for /api/ai/completion (POST)

Testing JWT manipulation for /api/ai/completion (POST)

Testing cookie manipulation for /api/ai/completion (POST)

Testing header manipulation for /api/ai/completion (POST)

Testing parameter pollution for /api/ai/completion (POST)

Testing RBAC bypass for /api/ai/completion (POST)


Results for /api/ai/completion (POST):
- Tests run: 11
- Successful bypasses: 0

Testing endpoint: /api/ai/usage (GET)
Required role: user
Testing missing authentication for /api/ai/usage (GET)

Testing JWT manipulation for /api/ai/usage (GET)

Testing cookie manipulation for /api/ai/usage (GET)

Testing header manipulation for /api/ai/usage (GET)

Testing parameter pollution for /api/ai/usage (GET)

Testing RBAC bypass for /api/ai/usage (GET)


Results for /api/ai/usage (GET):
- Tests run: 11
- Successful bypasses: 0

Testing endpoint: /api/ai/admin/dashboard (GET)
Required role: admin
Testing missing authentication for /api/ai/admin/dashboard (GET)

Testing JWT manipulation for /api/ai/admin/dashboard (GET)

Testing cookie manipulation for /api/ai/admin/dashboard (GET)

Testing header manipulation for /api/ai/admin/dashboard (GET)

Testing parameter pollution for /api/ai/admin/dashboard (GET)

Testing RBAC bypass for /api/ai/admin/dashboard (GET)


Results for /api/ai/admin/dashboard (GET):

- Tests run: 11
- Successful bypasses: 0

Testing endpoint: /api/ai/admin/users (GET)
Required role: admin
Testing missing authentication for /api/ai/admin/users (GET)

Testing JWT manipulation for /api/ai/admin/users (GET)

Testing cookie manipulation for /api/ai/admin/users (GET)

Testing header manipulation for /api/ai/admin/users (GET)

Testing parameter pollution for /api/ai/admin/users (GET)

Testing RBAC bypass for /api/ai/admin/users (GET)


Results for /api/ai/admin/users (GET):

- Tests run: 11
- Successful bypasses: 0

Testing endpoint: /api/ai/admin/settings (POST)
Required role: admin
Testing missing authentication for /api/ai/admin/settings (POST)

Testing JWT manipulation for /api/ai/admin/settings (POST)

Testing cookie manipulation for /api/ai/admin/settings (POST)

Testing header manipulation for /api/ai/admin/settings (POST)

Testing parameter pollution for /api/ai/admin/settings (POST)

Testing RBAC bypass for /api/ai/admin/settings (POST)


Results for /api/ai/admin/settings (POST):

- Tests run: 11
- Successful bypasses: 0


Scan complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-auth-bypass-2025-03-18.json


Summary:
- Total tests: 55
- Successful bypasses: 0
- Failed bypasses: 55


Running Web Vulnerabilities...
(node:48173) ExperimentalWarning: Type Stripping is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)

Starting AI web vulnerability scan...


Testing security headers...

Testing for missing security headers...


Testing CORS misconfigurations...

Testing for CORS misconfigurations...


Testing information disclosure...

Testing for information disclosure...


Scan complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-web-vulnerability-scan-2025-03-18.json


Summary:

- Total tests: 3
- Vulnerable: 3
- Safe: 0

Vulnerabilities found:


High severity (3):

- Security Headers Test: Error testing security headers: 

- CORS Test: Error testing CORS: 
- Information Disclosure Test: Error testing information disclosure: 


Security testing complete. Report saved to: /Users/vivi/astro/tests/security/security-reports/ai-security-report-2025-03-18.html

Summary:
- Total test suites: 3
- Total duration: 33.60s

Issues by severity:
- Critical: 0
- High: 0
- Medium: 0
- Low: 0
[0;32m
Security tests completed successfully! ðŸŽ‰[0m
[0;32mCheck the report at: /Users/vivi/astro/tests/security/../../security-reports/ai-security-report-2025-03-17.html[0m
2025-03-17 23:09:20 Security tests completed.
