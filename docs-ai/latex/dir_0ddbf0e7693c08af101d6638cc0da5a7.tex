\doxysection{node\+\_\+modules/readdirp Directory Reference}
\hypertarget{dir_0ddbf0e7693c08af101d6638cc0da5a7}{}\label{dir_0ddbf0e7693c08af101d6638cc0da5a7}\index{node\_modules/readdirp Directory Reference@{node\_modules/readdirp Directory Reference}}


\doxysubsection{Detailed Description}
Recursive version of fs.\+readdir. Exposes a {\bfseries{stream API}} (with small RAM \& CPU footprint) and a {\bfseries{promise API}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ install\ readdirp}
\DoxyCodeLine{jsr\ add\ jsr:@paulmillr/readdirp}

\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Use\ streams\ to\ achieve\ small\ RAM\ \&\ CPU\ footprint.}
\DoxyCodeLine{//\ 1)\ Streams\ example\ with\ for-\/await.}
\DoxyCodeLine{import\ readdirp\ from\ 'readdirp';}
\DoxyCodeLine{for\ await\ (const\ entry\ of\ readdirp('.'))\ \{}
\DoxyCodeLine{\ \ const\ \{path\}\ =\ entry;}
\DoxyCodeLine{\ \ console.log(`\$\{JSON.stringify(\{path\})\}`);}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{//\ 2)\ Streams\ example,\ non\ for-\/await.}
\DoxyCodeLine{//\ Print\ out\ all\ JS\ files\ along\ with\ their\ size\ within\ the\ current\ folder\ \&\ subfolders.}
\DoxyCodeLine{import\ readdirp\ from\ 'readdirp';}
\DoxyCodeLine{readdirp('.',\ \{alwaysStat:\ true,\ fileFilter:\ (f)\ =>\ f.basename.endsWith('.js')\})}
\DoxyCodeLine{\ \ .on('data',\ (entry)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ const\ \{path,\ stats:\ \{size\}\}\ =\ entry;}
\DoxyCodeLine{\ \ \ \ console.log(`\$\{JSON.stringify(\{path,\ size\})\}`);}
\DoxyCodeLine{\ \ \})}
\DoxyCodeLine{\ \ //\ Optionally\ call\ stream.destroy()\ in\ \`{}warn()`\ in\ order\ to\ abort\ and\ cause\ 'close'\ to\ be\ emitted}
\DoxyCodeLine{\ \ .on('warn',\ error\ =>\ console.error('non-\/fatal\ error',\ error))}
\DoxyCodeLine{\ \ .on('error',\ error\ =>\ console.error('fatal\ error',\ error))}
\DoxyCodeLine{\ \ .on('end',\ ()\ =>\ console.log('done'));}
\DoxyCodeLine{}
\DoxyCodeLine{//\ 3)\ Promise\ example.\ More\ RAM\ and\ CPU\ than\ streams\ /\ for-\/await.}
\DoxyCodeLine{import\ \{\ readdirpPromise\ \}\ from\ 'readdirp';}
\DoxyCodeLine{const\ files\ =\ await\ readdirpPromise('.');}
\DoxyCodeLine{console.log(files.map(file\ =>\ file.path));}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Other\ options.}
\DoxyCodeLine{import\ readdirp\ from\ 'readdirp';}
\DoxyCodeLine{readdirp('test',\ \{}
\DoxyCodeLine{\ \ fileFilter:\ (f)\ =>\ f.basename.endsWith('.js'),}
\DoxyCodeLine{\ \ directoryFilter:\ (d)\ =>\ d.basename\ !==\ '.git',}
\DoxyCodeLine{\ \ //\ directoryFilter:\ (di)\ =>\ di.basename.length\ ===\ 9}
\DoxyCodeLine{\ \ type:\ 'files\_directories',}
\DoxyCodeLine{\ \ depth:\ 1}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md27386}{}\doxysubsection{\texorpdfstring{API}{API}}\label{README.md_autotoc_md27386}
{\ttfamily const stream = readdirp(root\mbox{[}, options\mbox{]})} — {\bfseries{Stream API}}


\begin{DoxyItemize}
\item Reads given root recursively and returns a {\ttfamily stream} of entry infos
\item Optionally can be used like {\ttfamily for await (const entry of stream)} with node.\+js 10+ ({\ttfamily async\+Iterator}).
\item `on(\textquotesingle{}data', (entry) =\texorpdfstring{$>$}{>} \{\}){\ttfamily \mbox{[}entry info\mbox{]}(\#entryinfo) for every file / dir. -\/}on(\textquotesingle{}warn\textquotesingle{}, (error) =\texorpdfstring{$>$}{>} \{\}){\ttfamily non-\/fatal}Error{\ttfamily that prevents a file / dir from being processed. Example\+: inaccessible to the user. -\/}on(\textquotesingle{}error\textquotesingle{}, (error) =\texorpdfstring{$>$}{>} \{\}){\ttfamily fatal}Error{\ttfamily which also ends the stream. Example\+: illegal options where passed. -\/}on(\textquotesingle{}end\textquotesingle{}){\ttfamily — we are done. Called when all entries were found and no more will be emitted. -\/}on(\textquotesingle{}close\textquotesingle{}){\ttfamily — stream is destroyed via}stream.\+destroy(){\ttfamily . Could be useful if you want to manually abort even on a non fatal error. At that point the stream is no longer}readable\`{} and no more entries, warning or errors are emitted
\item To learn more about streams, consult the very detailed \href{https://nodejs.org/api/stream.html}{\texttt{ nodejs streams documentation}} or the \href{https://github.com/substack/stream-handbook}{\texttt{ stream-\/handbook}}
\end{DoxyItemize}

{\ttfamily const entries = await readdirp.\+promise(root\mbox{[}, options\mbox{]})} — {\bfseries{Promise API}}. Returns a list of entry infos.

First argument is awalys {\ttfamily root}, path in which to start reading and recursing into subdirectories.\hypertarget{README.md_autotoc_md27387}{}\doxysubsubsection{\texorpdfstring{options}{options}}\label{README.md_autotoc_md27387}

\begin{DoxyItemize}
\item {\ttfamily file\+Filter}\+: filter to include or exclude files
\begin{DoxyItemize}
\item {\bfseries{Function}}\+: a function that takes an entry info as a parameter and returns true to include or false to exclude the entry
\end{DoxyItemize}
\item {\ttfamily directory\+Filter}\+: filter to include/exclude directories found and to recurse into. Directories that do not pass a filter will not be recursed into.
\item {\ttfamily depth\+: 5}\+: depth at which to stop recursing even if more subdirectories are found
\item `type\+: \textquotesingle{}files'{\ttfamily \+: determines if data events on the stream should be emitted for}\textquotesingle{}files\textquotesingle{}{\ttfamily (default),}\textquotesingle{}directories\textquotesingle{}{\ttfamily ,}\textquotesingle{}files\+\_\+directories\textquotesingle{}{\ttfamily , or}\textquotesingle{}all\textquotesingle{}{\ttfamily . Setting to}\textquotesingle{}all\textquotesingle{}{\ttfamily will also include entries for other types of file descriptors like character devices, unix sockets and named pipes. -\/}always\+Stat\+: false{\ttfamily \+: always return}stats{\ttfamily property for every file. Default is}false{\ttfamily , readdirp will return}Dirent{\ttfamily entries. Setting it to}true{\ttfamily can double readdir execution time -\/ use it only when you need file}size{\ttfamily ,}mtime{\ttfamily etc. Cannot be enabled on node \texorpdfstring{$<$}{<}10.\+10.\+0. -\/}lstat\+: false{\ttfamily \+: include symlink entries in the stream along with files. When}true{\ttfamily ,}fs.\+lstat{\ttfamily would be used instead of}fs.\+stat\`{}
\end{DoxyItemize}\hypertarget{README.md_autotoc_md27388}{}\doxysubsubsection{\texorpdfstring{{\ttfamily Entry\+Info}}{{\ttfamily Entry\+Info}}}\label{README.md_autotoc_md27388}
Has the following properties\+:


\begin{DoxyItemize}
\item `path\+: \textquotesingle{}assets/javascripts/react.\+js'{\ttfamily \+: path to the file/directory (relative to given root) -\/}full\+Path\+: \textquotesingle{}/\+Users/dev/projects/app/assets/javascripts/react.js\textquotesingle{}{\ttfamily \+: full path to the file/directory found -\/}basename\+: \textquotesingle{}react.\+js\textquotesingle{}{\ttfamily \+: name of the file/directory -\/}dirent\+: fs.\+Dirent{\ttfamily \+: built-\/in \mbox{[}dir entry object\mbox{]}(\href{https://nodejs.org/api/fs.html}{\texttt{ https\+://nodejs.\+org/api/fs.\+html}}\#fs\+\_\+class\+\_\+fs\+\_\+dirent) -\/ only with}always\+Stat\+: false{\ttfamily  -\/}stats\+: fs.\+Stats{\ttfamily \+: built in \mbox{[}stat object\mbox{]}(\href{https://nodejs.org/api/fs.html}{\texttt{ https\+://nodejs.\+org/api/fs.\+html}}\#fs\+\_\+class\+\_\+fs\+\_\+stats) -\/ only with}always\+Stat\+: true\`{}
\end{DoxyItemize}\hypertarget{README.md_autotoc_md27389}{}\doxysubsection{\texorpdfstring{Changelog}{Changelog}}\label{README.md_autotoc_md27389}

\begin{DoxyItemize}
\item 4.\+0 (Aug 25, 2024) rewritten in typescript, producing hybrid common.\+js / esm module.
\begin{DoxyItemize}
\item Remove glob support and all dependencies
\item Make sure you\textquotesingle{}re using `let \{readdirp\} = require(\textquotesingle{}readdirp'){\ttfamily in common.\+js}
\end{DoxyItemize}
\item {\ttfamily 3.\+5 (Oct 13, 2020) disallows recursive directory-\/based symlinks. Before, it could have entered infinite loop.}
\item {\ttfamily 3.\+4 (Mar 19, 2020) adds support for directory-\/based symlinks.}
\item {\ttfamily 3.\+3 (Dec 6, 2019) stabilizes RAM consumption and enables perf management with}high\+Water\+Mark{\ttfamily option. Fixes race conditions related to}for-\/await{\ttfamily looping.}
\item {\ttfamily 3.\+2 (Oct 14, 2019) improves performance by 250\% and makes streams implementation more idiomatic.}
\item {\ttfamily 3.\+1 (Jul 7, 2019) brings}bigint{\ttfamily support to}stat{\ttfamily output on Windows. This is backwards-\/incompatible for some cases. Be careful. It you use it incorrectly, you\textquotesingle{}ll see "{}\+Type\+Error\+: Cannot mix Big\+Int and other types, use explicit conversions"{}.}
\item {\ttfamily 3.\+0 brings huge performance improvements and stream backpressure support.}
\item {\ttfamily Upgrading 2.\+x to 3.\+x\+:
\begin{DoxyItemize}
\item Signature changed from
\end{DoxyItemize}}readdirp(options){\ttfamily to}readdirp(root, options){\ttfamily 
\begin{DoxyItemize}
\item Replaced callback API with promise API.
\item Renamed
\end{DoxyItemize}}entry\+Type{\ttfamily option to}type{\ttfamily 
\begin{DoxyItemize}
\item Renamed
\end{DoxyItemize}}entry\+Type\+: \textquotesingle{}both\textquotesingle{}{\ttfamily to}\textquotesingle{}files\+\_\+directories\textquotesingle{}{\ttfamily  -\/}Entry\+Info{\ttfamily 
\begin{DoxyItemize}
\item Renamed
\end{DoxyItemize}}stat{\ttfamily to}stats{\ttfamily 
\begin{DoxyItemize}
\item Emitted only when
\end{DoxyItemize}}always\+Stat\+: true{\ttfamily  -\/}dirent{\ttfamily is emitted instead of}stats{\ttfamily by default with}always\+Stat\+: false{\ttfamily 
\begin{DoxyItemize}
\item Renamed
\end{DoxyItemize}}name{\ttfamily to}basename{\ttfamily 
\begin{DoxyItemize}
\item Removed
\end{DoxyItemize}}parent\+Dir{\ttfamily and}full\+Parent\+Dir\`{} properties
\item Supported node.\+js versions\+:
\begin{DoxyItemize}
\item 4.\+x\+: node 14+
\item 3.\+x\+: node 8+
\item 2.\+x\+: node 0.\+6+
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{README.md_autotoc_md27390}{}\doxysubsection{\texorpdfstring{License}{License}}\label{README.md_autotoc_md27390}
Copyright (c) 2012-\/2019 Thorsten Lorenz, Paul Miller (\href{https://paulmillr.com}{\texttt{ https\+://paulmillr.\+com}})

MIT License, see \mbox{[}LICENSE\mbox{]}(LICENSE) file. 