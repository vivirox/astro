\chapter{@atproto/xrpc}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g}{}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g}\index{"@atproto/xrpc@{"@atproto/xrpc}}
\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2295}%
\Hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2295}%
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2296}{}\doxysection{\texorpdfstring{0.\+6.\+11}{0.\+6.\+11}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2296}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2297}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2297}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+4.\+9
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2298}{}\doxysection{\texorpdfstring{0.\+6.\+10}{0.\+6.\+10}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2298}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2299}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2299}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+4.\+8
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2300}{}\doxysection{\texorpdfstring{0.\+6.\+9}{0.\+6.\+9}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2300}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2301}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2301}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\href{https://github.com/bluesky-social/atproto/commit/c53d943c8be5b8886254e020970a68c0f745b14c}{\texttt{ {\ttfamily c53d943c8}}}, \href{https://github.com/bluesky-social/atproto/commit/c53d943c8be5b8886254e020970a68c0f745b14c}{\texttt{ {\ttfamily c53d943c8}}}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+4.\+7
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2302}{}\doxysection{\texorpdfstring{0.\+6.\+8}{0.\+6.\+8}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2302}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2303}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2303}

\begin{DoxyItemize}
\item \href{https://github.com/bluesky-social/atproto/pull/3220}{\texttt{ \#3220}} \href{https://github.com/bluesky-social/atproto/commit/61dc0d60e19b88c6427a54c6d95a391b5f4da7bd}{\texttt{ {\ttfamily 61dc0d60e}}} Thanks \href{https://github.com/matthieusieben}{\texttt{ @matthieusieben}}! -\/ Apply new linting rules regarding import order
\item Updated dependencies \mbox{[}\href{https://github.com/bluesky-social/atproto/commit/61dc0d60e19b88c6427a54c6d95a391b5f4da7bd}{\texttt{ {\ttfamily 61dc0d60e}}}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+4.\+6
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2304}{}\doxysection{\texorpdfstring{0.\+6.\+7}{0.\+6.\+7}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2304}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2305}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2305}

\begin{DoxyItemize}
\item \href{https://github.com/bluesky-social/atproto/pull/3456}{\texttt{ \#3456}} \href{https://github.com/bluesky-social/atproto/commit/fb64d50ee220316b9f1183e5c3259629489734c9}{\texttt{ {\ttfamily fb64d50ee}}} Thanks \href{https://github.com/matthieusieben}{\texttt{ @matthieusieben}}! -\/ Explicitly allow "{}undefined"{} values in {\ttfamily headers}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2306}{}\doxysection{\texorpdfstring{0.\+6.\+6}{0.\+6.\+6}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2306}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2307}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2307}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+4.\+5
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2308}{}\doxysection{\texorpdfstring{0.\+6.\+5}{0.\+6.\+5}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2308}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2309}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2309}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\href{https://github.com/bluesky-social/atproto/commit/9fd65ba0fa4caca59fd0e6156145e4c2618e3a95}{\texttt{ {\ttfamily 9fd65ba0f}}}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+4.\+4
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2310}{}\doxysection{\texorpdfstring{0.\+6.\+4}{0.\+6.\+4}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2310}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2311}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2311}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\href{https://github.com/bluesky-social/atproto/commit/bac9be2d3ec904d1f984a871f43cf89aca17289d}{\texttt{ {\ttfamily bac9be2d3}}}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+4.\+3
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2312}{}\doxysection{\texorpdfstring{0.\+6.\+3}{0.\+6.\+3}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2312}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2313}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2313}

\begin{DoxyItemize}
\item \href{https://github.com/bluesky-social/atproto/pull/2770}{\texttt{ \#2770}} \href{https://github.com/bluesky-social/atproto/commit/a07b21151f1850340c4b7797ebb11521b1a6cdf3}{\texttt{ {\ttfamily a07b21151}}} Thanks \href{https://github.com/matthieusieben}{\texttt{ @matthieusieben}}! -\/ Add Not\+Acceptable response type
\item Updated dependencies \mbox{[}\href{https://github.com/bluesky-social/atproto/commit/87a1f24262e0e644b6cf31cc7a0446d9127ffa94}{\texttt{ {\ttfamily 87a1f2426}}}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+4.\+2
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2314}{}\doxysection{\texorpdfstring{0.\+6.\+2}{0.\+6.\+2}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2314}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2315}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2315}

\begin{DoxyItemize}
\item \href{https://github.com/bluesky-social/atproto/pull/2464}{\texttt{ \#2464}} \href{https://github.com/bluesky-social/atproto/commit/98711a147a8674337f605c6368f39fc10c2fae93}{\texttt{ {\ttfamily 98711a147}}} Thanks \href{https://github.com/matthieusieben}{\texttt{ @matthieusieben}}! -\/ Add Unsupported\+Media\+Type response type
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2316}{}\doxysection{\texorpdfstring{0.\+6.\+1}{0.\+6.\+1}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2316}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2317}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2317}

\begin{DoxyItemize}
\item \href{https://github.com/bluesky-social/atproto/pull/2714}{\texttt{ \#2714}} \href{https://github.com/bluesky-social/atproto/commit/d9ffa3c460924010d7002b616cb7a0c66111cc6c}{\texttt{ {\ttfamily d9ffa3c46}}} Thanks \href{https://github.com/matthieusieben}{\texttt{ @matthieusieben}}! -\/ Improve handling of fetch\+Handler errors when turning them into {\ttfamily Xrpc\+Error}.
\item \href{https://github.com/bluesky-social/atproto/pull/2714}{\texttt{ \#2714}} \href{https://github.com/bluesky-social/atproto/commit/d9ffa3c460924010d7002b616cb7a0c66111cc6c}{\texttt{ {\ttfamily d9ffa3c46}}} Thanks \href{https://github.com/matthieusieben}{\texttt{ @matthieusieben}}! -\/ Add ability to instantiate Xrpc\+Client from Fetch\+Handler\+Object type
\item \href{https://github.com/bluesky-social/atproto/pull/2714}{\texttt{ \#2714}} \href{https://github.com/bluesky-social/atproto/commit/d9ffa3c460924010d7002b616cb7a0c66111cc6c}{\texttt{ {\ttfamily d9ffa3c46}}} Thanks \href{https://github.com/matthieusieben}{\texttt{ @matthieusieben}}! -\/ Add global headers to {\ttfamily Xrpc\+Client} instances
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2318}{}\doxysection{\texorpdfstring{0.\+6.\+0}{0.\+6.\+0}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2318}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2319}{}\doxysubsection{\texorpdfstring{Minor Changes}{Minor Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2319}

\begin{DoxyItemize}
\item \href{https://github.com/bluesky-social/atproto/pull/2483}{\texttt{ \#2483}} \href{https://github.com/bluesky-social/atproto/commit/b934b396b13ba32bf2bf7e75ecdf6871e5f310dd}{\texttt{ {\ttfamily b934b396b}}} Thanks \href{https://github.com/matthieusieben}{\texttt{ @matthieusieben}}!
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2320}{}\doxysubsubsection{\texorpdfstring{Motivation}{Motivation}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2320}
The motivation for these changes is the need to make the {\ttfamily @atproto/api} package compatible with OAuth session management. We don\textquotesingle{}t have OAuth client support "{}launched"{} and documented quite yet, so you can keep using the current app password authentication system. When we do "{}launch"{} OAuth support and begin encouraging its usage in the near future (see the \href{https://github.com/bluesky-social/atproto/discussions/2656}{\texttt{ OAuth Roadmap}}), these changes will make it easier to migrate.

In addition, the redesigned session management system fixes a bug that could cause the session data to become invalid when Agent clones are created (e.\+g. using {\ttfamily agent.\+with\+Proxy()}).\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2321}{}\doxysubsubsection{\texorpdfstring{New Features}{New Features}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2321}
We\textquotesingle{}ve restructured the {\ttfamily Xrpc\+Client} HTTP fetch handler to be specified during the instantiation of the XRPC client, through the constructor, instead of using a default implementation (which was statically defined).

With this refactor, the XRPC client is now more modular and reusable. Session management, retries, cryptographic signing, and other request-\/specific logic can be implemented in the fetch handler itself rather than by the calling code.

A new abstract class named {\ttfamily Agent}, has been added to {\ttfamily @atproto/api}. This class will be the base class for all Bluesky agents classes in the {\ttfamily @atproto} ecosystem. It is meant to be extended by implementations that provide session management and fetch handling.

As you adapt your code to these changes, make sure to use the {\ttfamily Agent} type wherever you expect to receive an agent, and use the {\ttfamily Atp\+Agent} type (class) only to instantiate your client. The reason for this is to be forward compatible with the OAuth agent implementation that will also extend {\ttfamily Agent}, and not {\ttfamily Atp\+Agent}.


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ Agent,\ AtpAgent\ \}\ from\ "{}@atproto/api"{};}
\DoxyCodeLine{}
\DoxyCodeLine{async\ function\ setupAgent(}
\DoxyCodeLine{\ \ service:\ string,}
\DoxyCodeLine{\ \ username:\ string,}
\DoxyCodeLine{\ \ password:\ string,}
\DoxyCodeLine{):\ Promise<Agent>\ \{}
\DoxyCodeLine{\ \ const\ agent\ =\ new\ AtpAgent(\{}
\DoxyCodeLine{\ \ \ \ service,}
\DoxyCodeLine{\ \ \ \ persistSession:\ (evt,\ session)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ //\ handle\ session\ update}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ await\ agent.login(username,\ password);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ return\ agent;}
\DoxyCodeLine{\}}

\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ Agent\ \}\ from\ "{}@atproto/api"{};}
\DoxyCodeLine{}
\DoxyCodeLine{async\ function\ doStuffWithAgent(agent:\ Agent,\ arg:\ string)\ \{}
\DoxyCodeLine{\ \ return\ agent.resolveHandle(arg);}
\DoxyCodeLine{\}}

\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ Agent,\ AtpAgent\ \}\ from\ "{}@atproto/api"{};}
\DoxyCodeLine{}
\DoxyCodeLine{class\ MyClass\ \{}
\DoxyCodeLine{\ \ agent:\ Agent;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ constructor()\ \{}
\DoxyCodeLine{\ \ \ \ this.agent\ =\ new\ AtpAgent();}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2322}{}\doxysubsubsection{\texorpdfstring{Breaking changes}{Breaking changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2322}
Most of the changes introduced in this version are backward-\/compatible. However, there are a couple of breaking changes you should be aware of\+:


\begin{DoxyItemize}
\item Customizing {\ttfamily fetch}\+: The ability to customize the {\ttfamily fetch\+: Fetch\+Handler} property of {\ttfamily @atproto/xrpc}\textquotesingle{}s {\ttfamily Client} and {\ttfamily @atproto/api}\textquotesingle{}s {\ttfamily Atp\+Agent} classes has been removed. Previously, the {\ttfamily fetch} property could be set to a function that would be used as the fetch handler for that instance, and was initialized to a default fetch handler. That property is still accessible in a read-\/only fashion through the {\ttfamily fetch\+Handler} property and can only be set during the instance creation. Attempting to set/get the {\ttfamily fetch} property will now result in an error.
\item The {\ttfamily fetch()} method, as well as What\+WG compliant {\ttfamily Request} and {\ttfamily Headers} constructors, must be globally available in your environment. Use a polyfill if necessary.
\item The {\ttfamily Atp\+Base\+Client} has been removed. The {\ttfamily Atp\+Service\+Client} has been renamed {\ttfamily Atp\+Base\+Client}. Any code using either of these classes will need to be updated.
\item Instead of {\itshape wrapping} an {\ttfamily Xrpc\+Client} in its {\ttfamily xrpc} property, the {\ttfamily Atp\+Base\+Client} (formerly {\ttfamily Atp\+Service\+Client}) class -\/ created through {\ttfamily lex-\/cli} -\/ now {\itshape extends} the {\ttfamily Xrpc\+Client} class. This means that a client instance now passes the {\ttfamily instanceof Xrpc\+Client} check. The {\ttfamily xrpc} property now returns the instance itself and has been deprecated.
\item {\ttfamily set\+Session\+Persist\+Handler} is no longer available on the {\ttfamily Atp\+Agent} or {\ttfamily Bsky\+Agent} classes. The session handler can only be set though the {\ttfamily persist\+Session} options of the {\ttfamily Atp\+Agent} constructor.
\item The new class hierarchy is as follows\+:
\begin{DoxyItemize}
\item {\ttfamily Bsky\+Agent} extends {\ttfamily Atp\+Agent}\+: but add no functionality (hence its deprecation).
\item {\ttfamily Atp\+Agent} extends {\ttfamily Agent}\+: adds password based session management.
\item {\ttfamily Agent} extends {\ttfamily Atp\+Base\+Client}\+: this abstract class that adds syntactic sugar methods {\ttfamily app.\+bsky} lexicons. It also adds abstract session management methods and adds atproto specific utilities ({\ttfamily labelers} \& {\ttfamily proxy} headers, cloning capability)
\item {\ttfamily Atp\+Base\+Client} extends {\ttfamily Xrpc\+Client}\+: automatically code that adds fully typed lexicon defined namespaces ({\ttfamily instance.\+app.\+bsky.\+feed.\+get\+Posts()}) to the {\ttfamily Xrpc\+Client}.
\item {\ttfamily Xrpc\+Client} is the base class.
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2323}{}\doxysubsubsection{\texorpdfstring{Non-\/breaking changes}{Non-\/breaking changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2323}

\begin{DoxyItemize}
\item The {\ttfamily com.\texorpdfstring{$\ast$}{*}} and {\ttfamily app.\texorpdfstring{$\ast$}{*}} namespaces have been made directly available to every {\ttfamily Agent} instances.
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2324}{}\doxysubsubsection{\texorpdfstring{Deprecations}{Deprecations}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2324}

\begin{DoxyItemize}
\item The default export of the {\ttfamily @atproto/xrpc} package has been deprecated. Use named exports instead.
\item The {\ttfamily Client} and {\ttfamily Service\+Client} classes are now deprecated. They are replaced by a single {\ttfamily Xrpc\+Client} class.
\item The default export of the {\ttfamily @atproto/api} package has been deprecated. Use named exports instead.
\item The {\ttfamily Bsky\+Agent} has been deprecated. Use the {\ttfamily Atp\+Agent} class instead.
\item The {\ttfamily xrpc} property of the {\ttfamily Atp\+Client} instances has been deprecated. The instance itself should be used as the XRPC client.
\item The {\ttfamily api} property of the {\ttfamily Atp\+Agent} and {\ttfamily Bsky\+Agent} instances has been deprecated. Use the instance itself instead.
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2325}{}\doxysubsubsection{\texorpdfstring{Migration}{Migration}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2325}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2326}{}\doxysubsubsubsection{\texorpdfstring{The {\ttfamily @atproto/api} package}{The {\ttfamily @atproto/api} package}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2326}
If you were relying on the {\ttfamily Atp\+Base\+Client} solely to perform validation, use this\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\begin{center}Before\end{center}  &\begin{center}After\end{center}   \\\cline{1-2}



\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ AtpBaseClient,\ ComAtprotoSyncSubscribeRepos\ \}\ from\ "{}@atproto/api"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ baseClient\ =\ new\ AtpBaseClient();}
\DoxyCodeLine{}
\DoxyCodeLine{baseClient.xrpc.lex.assertValidXrpcMessage("{}io.example.doStuff"{},\ \{}
\DoxyCodeLine{\ \ //\ ...}
\DoxyCodeLine{\});}

\end{DoxyCode}


&


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ lexicons\ \}\ from\ "{}@atproto/api"{};}
\DoxyCodeLine{}
\DoxyCodeLine{lexicons.assertValidXrpcMessage("{}io.example.doStuff"{},\ \{}
\DoxyCodeLine{\ \ //\ ...}
\DoxyCodeLine{\});}

\end{DoxyCode}


\\\cline{1-2}
\end{longtabu}


If you are extending the {\ttfamily Bsky\+Agent} to perform custom {\ttfamily session} manipulation, define your own {\ttfamily Agent} subclass instead\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\begin{center}Before\end{center}  &\begin{center}After\end{center}   \\\cline{1-2}



\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ BskyAgent\ \}\ from\ "{}@atproto/api"{};}
\DoxyCodeLine{}
\DoxyCodeLine{class\ MyAgent\ extends\ BskyAgent\ \{}
\DoxyCodeLine{\ \ private\ accessToken?:\ string;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ async\ createOrRefreshSession(identifier:\ string,\ password:\ string)\ \{}
\DoxyCodeLine{\ \ \ \ //\ custom\ logic\ here}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ this.accessToken\ =\ "{}my-\/access-\/jwt"{};}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ async\ doStuff()\ \{}
\DoxyCodeLine{\ \ \ \ return\ this.call("{}io.example.doStuff"{},\ \{}
\DoxyCodeLine{\ \ \ \ \ \ headers:\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Authorization:\ this.accessToken\ \&\&\ \`{}Bearer\ \$\{this.accessToken\}`,}
\DoxyCodeLine{\ \ \ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \});}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}


&


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ Agent\ \}\ from\ "{}@atproto/api"{};}
\DoxyCodeLine{}
\DoxyCodeLine{class\ MyAgent\ extends\ Agent\ \{}
\DoxyCodeLine{\ \ private\ accessToken?:\ string;}
\DoxyCodeLine{\ \ public\ did?:\ string;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ constructor(private\ readonly\ service:\ string\ |\ URL)\ \{}
\DoxyCodeLine{\ \ \ \ super(\{}
\DoxyCodeLine{\ \ \ \ \ \ service,}
\DoxyCodeLine{\ \ \ \ \ \ headers:\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Authorization:\ ()\ =>}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ this.accessToken\ ?\ \`{}Bearer\ \$\{this.accessToken\}`\ :\ null,}
\DoxyCodeLine{\ \ \ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \});}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ clone():\ MyAgent\ \{}
\DoxyCodeLine{\ \ \ \ const\ agent\ =\ new\ MyAgent(this.service);}
\DoxyCodeLine{\ \ \ \ agent.accessToken\ =\ this.accessToken;}
\DoxyCodeLine{\ \ \ \ agent.did\ =\ this.did;}
\DoxyCodeLine{\ \ \ \ return\ this.copyInto(agent);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ async\ createOrRefreshSession(identifier:\ string,\ password:\ string)\ \{}
\DoxyCodeLine{\ \ \ \ //\ custom\ logic\ here}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ this.did\ =\ "{}did:example:123"{};}
\DoxyCodeLine{\ \ \ \ this.accessToken\ =\ "{}my-\/access-\/jwt"{};}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}


\\\cline{1-2}
\end{longtabu}


If you are monkey patching the {\ttfamily xrpc} service client to perform client-\/side rate limiting, you can now do this in the {\ttfamily Fetch\+Handler} function\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\begin{center}Before\end{center}  &\begin{center}After\end{center}   \\\cline{1-2}



\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ BskyAgent\ \}\ from\ "{}@atproto/api"{};}
\DoxyCodeLine{import\ \{\ RateLimitThreshold\ \}\ from\ "{}rate-\/limit-\/threshold"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ agent\ =\ new\ BskyAgent();}
\DoxyCodeLine{const\ limiter\ =\ new\ RateLimitThreshold(3000,\ 300\_000);}
\DoxyCodeLine{}
\DoxyCodeLine{const\ origCall\ =\ agent.api.xrpc.call;}
\DoxyCodeLine{agent.api.xrpc.call\ =\ async\ function\ (...args)\ \{}
\DoxyCodeLine{\ \ await\ limiter.wait();}
\DoxyCodeLine{\ \ return\ origCall.call(this,\ ...args);}
\DoxyCodeLine{\};}

\end{DoxyCode}


&


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ AtpAgent\ \}\ from\ "{}@atproto/api"{};}
\DoxyCodeLine{import\ \{\ RateLimitThreshold\ \}\ from\ "{}rate-\/limit-\/threshold"{};}
\DoxyCodeLine{}
\DoxyCodeLine{class\ LimitedAtpAgent\ extends\ AtpAgent\ \{}
\DoxyCodeLine{\ \ constructor(options:\ AtpAgentOptions)\ \{}
\DoxyCodeLine{\ \ \ \ const\ fetch:\ typeof\ globalThis.fetch\ =\ options.fetch\ ??\ globalThis.fetch;}
\DoxyCodeLine{\ \ \ \ const\ limiter\ =\ new\ RateLimitThreshold(3000,\ 300\_000);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ super(\{}
\DoxyCodeLine{\ \ \ \ \ \ ...options,}
\DoxyCodeLine{\ \ \ \ \ \ fetch:\ async\ (...args)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ await\ limiter.wait();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ return\ fetch(...args);}
\DoxyCodeLine{\ \ \ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \});}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}


\\\cline{1-2}
\end{longtabu}


If you configure a static {\ttfamily fetch} handler on the {\ttfamily Bsky\+Agent} class -\/ for example to modify the headers of every request -\/ you can now do this by providing your own {\ttfamily fetch} function\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\begin{center}Before\end{center}  &\begin{center}After\end{center}   \\\cline{1-2}



\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ BskyAgent,\ defaultFetchHandler\ \}\ from\ "{}@atproto/api"{};}
\DoxyCodeLine{}
\DoxyCodeLine{BskyAgent.configure(\{}
\DoxyCodeLine{\ \ fetch:\ async\ (httpUri,\ httpMethod,\ httpHeaders,\ httpReqBody)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ const\ ua\ =\ httpHeaders["{}User-\/Agent"{}];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ httpHeaders["{}User-\/Agent"{}]\ =\ ua\ ?\ \`{}\$\{ua\}\ \$\{userAgent\}`\ :\ userAgent;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ return\ defaultFetchHandler(httpUri,\ httpMethod,\ httpHeaders,\ httpReqBody);}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\});}

\end{DoxyCode}


&


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ AtpAgent\ \}\ from\ "{}@atproto/api"{};}
\DoxyCodeLine{}
\DoxyCodeLine{class\ MyAtpAgent\ extends\ AtpAgent\ \{}
\DoxyCodeLine{\ \ constructor(options:\ AtpAgentOptions)\ \{}
\DoxyCodeLine{\ \ \ \ const\ fetch\ =\ options.fetch\ ??\ globalThis.fetch;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ super(\{}
\DoxyCodeLine{\ \ \ \ \ \ ...options,}
\DoxyCodeLine{\ \ \ \ \ \ fetch:\ async\ (url,\ init)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ const\ headers\ =\ new\ Headers(init.headers);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ const\ ua\ =\ headersList.get("{}User-\/Agent"{});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ headersList.set("{}User-\/Agent"{},\ ua\ ?\ \`{}\$\{ua\}\ \$\{userAgent\}`\ :\ userAgent);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ return\ fetch(url,\ \{\ ...init,\ headers\ \});}
\DoxyCodeLine{\ \ \ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \});}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}


\\\cline{1-2}
\end{longtabu}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2327}{}\doxysubsubsubsection{\texorpdfstring{The {\ttfamily @atproto/xrpc} package}{The {\ttfamily @atproto/xrpc} package}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2327}
The {\ttfamily Client} and {\ttfamily Service\+Client} classes are now {\bfseries{deprecated}}. If you need a lexicon based client, you should update the code to use the {\ttfamily Xrpc\+Client} class instead.

The deprecated {\ttfamily Service\+Client} class now extends the new {\ttfamily Xrpc\+Client} class. Because of this, the {\ttfamily fetch} {\ttfamily Fetch\+Handler} can no longer be configured on the {\ttfamily Client} instances (including the default export of the package). If you are not relying on the {\ttfamily fetch} {\ttfamily Fetch\+Handler}, the new changes should have no impact on your code. Beware that the deprecated classes will eventually be removed in a future version.

Since its use has completely changed, the {\ttfamily Fetch\+Handler} type has also completely changed. The new {\ttfamily Fetch\+Handler} type is now a function that receives a {\ttfamily url} pathname and a {\ttfamily Request\+Init} object and returns a {\ttfamily Promise\texorpdfstring{$<$}{<}Response\texorpdfstring{$>$}{>}}. This function is responsible for making the actual request to the server.


\begin{DoxyCode}{0}
\DoxyCodeLine{export\ type\ FetchHandler\ =\ (}
\DoxyCodeLine{\ \ this:\ void,}
\DoxyCodeLine{\ \ /**}
\DoxyCodeLine{\ \ \ *\ The\ URL\ (pathname\ +\ query\ parameters)\ to\ make\ the\ request\ to,\ without\ the}
\DoxyCodeLine{\ \ \ *\ origin.\ The\ origin\ (protocol,\ hostname,\ and\ port)\ must\ be\ added\ by\ this}
\DoxyCodeLine{\ \ \ *\ \{@link\ FetchHandler\},\ typically\ based\ on\ authentication\ or\ other\ factors.}
\DoxyCodeLine{\ \ \ */}
\DoxyCodeLine{\ \ url:\ string,}
\DoxyCodeLine{\ \ init:\ RequestInit,}
\DoxyCodeLine{)\ =>\ Promise<Response>;}

\end{DoxyCode}


A noticeable change that has been introduced is that the {\ttfamily uri} field of the {\ttfamily Service\+Client} class has {\itshape not} been ported to the new {\ttfamily Xrpc\+Client} class. It is now the responsibility of the {\ttfamily Fetch\+Handler} to determine the full URL to make the request to. The same goes for the {\ttfamily headers}, which should now be set through the {\ttfamily Fetch\+Handler} function.

If you {\itshape do} rely on the legacy {\ttfamily Client.\+fetch} property to perform custom logic upon request, you will need to migrate your code to use the new {\ttfamily Xrpc\+Client} class. The {\ttfamily Xrpc\+Client} class has a similar API to the old {\ttfamily Service\+Client} class, but with a few differences\+:


\begin{DoxyItemize}
\item The {\ttfamily Client} + {\ttfamily Service\+Client} duality was removed in favor of a single {\ttfamily Xrpc\+Client} class. This means that\+:
\begin{DoxyItemize}
\item There no longer exists a centralized lexicon registry. If you need a global lexicon registry, you can maintain one yourself using a {\ttfamily new Lexicons} (from {\ttfamily @atproto/lexicon}).
\item The {\ttfamily Fetch\+Handler} is no longer a statically defined property of the {\ttfamily Client} class. Instead, it is passed as an argument to the {\ttfamily Xrpc\+Client} constructor.
\end{DoxyItemize}
\item The {\ttfamily Xrpc\+Client} constructor now requires a {\ttfamily Fetch\+Handler} function as the first argument, and an optional {\ttfamily Lexicon} instance as the second argument.
\item The {\ttfamily set\+Header} and {\ttfamily unset\+Header} methods were not ported to the new {\ttfamily Xrpc\+Client} class. If you need to set or unset headers, you should do so in the {\ttfamily Fetch\+Handler} function provided in the constructor arg.
\end{DoxyItemize}

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\begin{center}Before\end{center}  &\begin{center}After\end{center}   \\\cline{1-2}



\begin{DoxyCode}{0}
\DoxyCodeLine{import\ client,\ \{\ defaultFetchHandler\ \}\ from\ "{}@atproto/xrpc"{};}
\DoxyCodeLine{}
\DoxyCodeLine{client.fetch\ =\ function\ (}
\DoxyCodeLine{\ \ httpUri:\ string,}
\DoxyCodeLine{\ \ httpMethod:\ string,}
\DoxyCodeLine{\ \ httpHeaders:\ Headers,}
\DoxyCodeLine{\ \ httpReqBody:\ unknown,}
\DoxyCodeLine{)\ \{}
\DoxyCodeLine{\ \ //\ Custom\ logic\ here}
\DoxyCodeLine{\ \ return\ defaultFetchHandler(httpUri,\ httpMethod,\ httpHeaders,\ httpReqBody);}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{client.addLexicon(\{}
\DoxyCodeLine{\ \ lexicon:\ 1,}
\DoxyCodeLine{\ \ id:\ "{}io.example.doStuff"{},}
\DoxyCodeLine{\ \ defs:\ \{\},}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{const\ instance\ =\ client.service("{}http://my-\/service.com"{});}
\DoxyCodeLine{}
\DoxyCodeLine{instance.setHeader("{}my-\/header"{},\ "{}my-\/value"{});}
\DoxyCodeLine{}
\DoxyCodeLine{await\ instance.call("{}io.example.doStuff"{});}

\end{DoxyCode}


&


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ XrpcClient\ \}\ from\ "{}@atproto/xrpc"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ instance\ =\ new\ XrpcClient(}
\DoxyCodeLine{\ \ async\ (url,\ init)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ const\ headers\ =\ new\ Headers(init.headers);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ headers.set("{}my-\/header"{},\ "{}my-\/value"{});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ //\ Custom\ logic\ here}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ const\ fullUrl\ =\ new\ URL(url,\ "{}http://my-\/service.com"{});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ return\ fetch(fullUrl,\ \{\ ...init,\ headers\ \});}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\ \ [}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ lexicon:\ 1,}
\DoxyCodeLine{\ \ \ \ \ \ id:\ "{}io.example.doStuff"{},}
\DoxyCodeLine{\ \ \ \ \ \ defs:\ \{\},}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ ],}
\DoxyCodeLine{);}
\DoxyCodeLine{}
\DoxyCodeLine{await\ instance.call("{}io.example.doStuff"{});}

\end{DoxyCode}


\\\cline{1-2}
\end{longtabu}


If your fetch handler does not require any "{}custom logic"{}, and all you need is an {\ttfamily Xrpc\+Client} that makes its HTTP requests towards a static service URL, the previous example can be simplified to\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ XrpcClient\ \}\ from\ "{}@atproto/xrpc"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ instance\ =\ new\ XrpcClient("{}http://my-\/service.com"{},\ [}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \ lexicon:\ 1,}
\DoxyCodeLine{\ \ \ \ id:\ "{}io.example.doStuff"{},}
\DoxyCodeLine{\ \ \ \ defs:\ \{\},}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{]);}

\end{DoxyCode}


If you need to add static headers to all requests, you can instead instantiate the {\ttfamily Xrpc\+Client} as follows\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ XrpcClient\ \}\ from\ "{}@atproto/xrpc"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ instance\ =\ new\ XrpcClient(}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \ service:\ "{}http://my-\/service.com"{},}
\DoxyCodeLine{\ \ \ \ headers:\ \{}
\DoxyCodeLine{\ \ \ \ \ \ "{}my-\/header"{}:\ "{}my-\/value"{},}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\ \ [}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ lexicon:\ 1,}
\DoxyCodeLine{\ \ \ \ \ \ id:\ "{}io.example.doStuff"{},}
\DoxyCodeLine{\ \ \ \ \ \ defs:\ \{\},}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ ],}
\DoxyCodeLine{);}

\end{DoxyCode}


If you need the headers or service url to be dynamic, you can define them using functions\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ XrpcClient\ \}\ from\ "{}@atproto/xrpc"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ instance\ =\ new\ XrpcClient(}
\DoxyCodeLine{\ \ \{}
\DoxyCodeLine{\ \ \ \ service:\ ()\ =>\ "{}http://my-\/service.com"{},}
\DoxyCodeLine{\ \ \ \ headers:\ \{}
\DoxyCodeLine{\ \ \ \ \ \ "{}my-\/header"{}:\ ()\ =>\ "{}my-\/value"{},}
\DoxyCodeLine{\ \ \ \ \ \ "{}my-\/ignored-\/header"{}:\ ()\ =>\ null,\ //\ ignored}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\ \ [}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ lexicon:\ 1,}
\DoxyCodeLine{\ \ \ \ \ \ id:\ "{}io.example.doStuff"{},}
\DoxyCodeLine{\ \ \ \ \ \ defs:\ \{\},}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ ],}
\DoxyCodeLine{);}

\end{DoxyCode}



\begin{DoxyItemize}
\item \href{https://github.com/bluesky-social/atproto/pull/2483}{\texttt{ \#2483}} \href{https://github.com/bluesky-social/atproto/commit/b934b396b13ba32bf2bf7e75ecdf6871e5f310dd}{\texttt{ {\ttfamily b934b396b}}} Thanks \href{https://github.com/matthieusieben}{\texttt{ @matthieusieben}}! -\/ Add the ability to use {\ttfamily fetch()} compatible {\ttfamily Body\+Init} body when making XRPC calls.
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2328}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2328}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\href{https://github.com/bluesky-social/atproto/commit/b934b396b13ba32bf2bf7e75ecdf6871e5f310dd}{\texttt{ {\ttfamily b934b396b}}}, \href{https://github.com/bluesky-social/atproto/commit/2bdf75d7a63924c10e7a311f16cb447d595b933e}{\texttt{ {\ttfamily 2bdf75d7a}}}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+4.\+1
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2329}{}\doxysection{\texorpdfstring{0.\+5.\+0}{0.\+5.\+0}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2329}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2330}{}\doxysubsection{\texorpdfstring{Minor Changes}{Minor Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2330}

\begin{DoxyItemize}
\item \href{https://github.com/bluesky-social/atproto/pull/2169}{\texttt{ \#2169}} \href{https://github.com/bluesky-social/atproto/commit/f689bd51a2f4e02d4eca40eb2568a1fcb95494e9}{\texttt{ {\ttfamily f689bd51a}}} Thanks \href{https://github.com/matthieusieben}{\texttt{ @matthieusieben}}! -\/ Build system rework, stop bundling dependencies.
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2331}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2331}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\href{https://github.com/bluesky-social/atproto/commit/f689bd51a2f4e02d4eca40eb2568a1fcb95494e9}{\texttt{ {\ttfamily f689bd51a}}}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+4.\+0
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2332}{}\doxysection{\texorpdfstring{0.\+4.\+3}{0.\+4.\+3}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2332}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2333}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2333}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+3.\+3
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2334}{}\doxysection{\texorpdfstring{0.\+4.\+2}{0.\+4.\+2}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2334}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2335}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2335}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+3.\+2
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2336}{}\doxysection{\texorpdfstring{0.\+4.\+1}{0.\+4.\+1}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2336}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2337}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2337}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+3.\+1
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2338}{}\doxysection{\texorpdfstring{0.\+4.\+0}{0.\+4.\+0}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2338}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2339}{}\doxysubsection{\texorpdfstring{Minor Changes}{Minor Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2339}

\begin{DoxyItemize}
\item \href{https://github.com/bluesky-social/atproto/pull/1801}{\texttt{ \#1801}} \href{https://github.com/bluesky-social/atproto/commit/ce49743d7f8800d33116b88001d7b512553c2c89}{\texttt{ {\ttfamily ce49743d}}} Thanks \href{https://github.com/gaearon}{\texttt{ @gaearon}}! -\/ Methods that accepts lexicons now take {\ttfamily Lexicon\+Doc} type instead of {\ttfamily unknown}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2340}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2340}

\begin{DoxyItemize}
\item \href{https://github.com/bluesky-social/atproto/pull/1788}{\texttt{ \#1788}} \href{https://github.com/bluesky-social/atproto/commit/84e2d4d2b6694f344d80c18672c78b650189d423}{\texttt{ {\ttfamily 84e2d4d2}}} Thanks \href{https://github.com/bnewbold}{\texttt{ @bnewbold}}! -\/ update license to "{}\+MIT or Apache2"{}
\item Updated dependencies \mbox{[}\href{https://github.com/bluesky-social/atproto/commit/ce49743d7f8800d33116b88001d7b512553c2c89}{\texttt{ {\ttfamily ce49743d}}}, \href{https://github.com/bluesky-social/atproto/commit/84e2d4d2b6694f344d80c18672c78b650189d423}{\texttt{ {\ttfamily 84e2d4d2}}}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+3.\+0
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2341}{}\doxysection{\texorpdfstring{0.\+3.\+3}{0.\+3.\+3}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2341}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2342}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2342}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+2.\+3
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2343}{}\doxysection{\texorpdfstring{0.\+3.\+2}{0.\+3.\+2}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2343}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2344}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2344}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+2.\+2
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2345}{}\doxysection{\texorpdfstring{0.\+3.\+1}{0.\+3.\+1}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2345}
\hypertarget{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2346}{}\doxysubsection{\texorpdfstring{Patch Changes}{Patch Changes}}\label{md_node__modules_2_0datproto_2xrpc_2_c_h_a_n_g_e_l_o_g_autotoc_md2346}

\begin{DoxyItemize}
\item Updated dependencies \mbox{[}\mbox{]}\+:
\begin{DoxyItemize}
\item @atproto/lexicon@0.\+2.\+1 
\end{DoxyItemize}
\end{DoxyItemize}