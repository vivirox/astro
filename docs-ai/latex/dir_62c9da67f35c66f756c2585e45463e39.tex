\doxysection{node\+\_\+modules/formdata-\/polyfill Directory Reference}
\hypertarget{dir_62c9da67f35c66f756c2585e45463e39}{}\label{dir_62c9da67f35c66f756c2585e45463e39}\index{node\_modules/formdata-\/polyfill Directory Reference@{node\_modules/formdata-\/polyfill Directory Reference}}


\doxysubsection{Detailed Description}

\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ install\ formdata-\/polyfill}

\end{DoxyCode}


The browser polyfill will likely have done its part already, and i hope you stop supporting old browsers c"{},)$<$br$>$ \+But Node\+JS still laks a proper Form\+Data$<$br$>$\+The good old form-\/data package is a very old and isn\textquotesingle{}t spec compatible and dose some abnormal stuff to construct and read Form\+Data instances that other http libraries are not happy about when it comes to follow the spec.  @subsection autotoc\+\_\+md15795 The Node\+JS / ESM version -\/ The modular (\texorpdfstring{$\sim$}{\string~}2.\+3 Ki\+B minified uncompressed) version of this package is independent of any browser stuff and don\textquotesingle{}t patch anything -\/ It\textquotesingle{}s as pure/spec compatible as it possible gets the test are run by WPT. -\/ It\textquotesingle{}s compatible with $<$a href="{}\href{https://github.com/node-fetch/node-fetch}{\texttt{ https\+://github.\+com/node-\/fetch/node-\/fetch}}"{} $>$node-\/fetch$<$/a$>$. -\/ It have higher platform dependencies as it uses classes, symbols, ESM \& private fields -\/ Only dependency it has is $<$a href="{}\href{https://github.com/node-fetch/fetch-blob}{\texttt{ https\+://github.\+com/node-\/fetch/fetch-\/blob}}"{} $>$fetch-\/blob$<$/a$>$  @icode\{js\}  // Node example import fetch from \textquotesingle{}node-\/fetch\textquotesingle{} import File from \textquotesingle{}fetch-\/blob/file.\+js\textquotesingle{} import \{ file\+From\+Sync \} from \textquotesingle{}fetch-\/blob/from.\+js\textquotesingle{} import \{ Form\+Data \} from \textquotesingle{}formdata-\/polyfill/esm.\+min.\+js\textquotesingle{}  const file = file\+From\+Sync(\textquotesingle{}./\+README.\+md\textquotesingle{}) const fd = new Form\+Data()  fd.\+append(\textquotesingle{}file-\/upload\textquotesingle{}, new File(\mbox{[}\textquotesingle{}abc\textquotesingle{}\mbox{]}, \textquotesingle{}hello-\/world.\+txt\textquotesingle{})) fd.\+append(\textquotesingle{}file-\/upload\textquotesingle{}, file)  // it\textquotesingle{}s also possible to append file/blob look-\/a-\/like items // if you have streams coming from other destinations fd.\+append(\textquotesingle{}file-\/upload\textquotesingle{}, \{   size\+: 123,   type\+: \textquotesingle{}\textquotesingle{},   name\+: \textquotesingle{}cat-\/video.\+mp4\textquotesingle{},   stream() \{ return stream \},   \mbox{[}\+Symbol.\+to\+String\+Tag\mbox{]}\+: \textquotesingle{}\+File\textquotesingle{} \})  fetch(\textquotesingle{}https\+://httpbin.\+org/post\textquotesingle{}, \{ method\+: \textquotesingle{}\+POST\textquotesingle{}, body\+: fd \}) @endicode   $<$hr$>$  \+It also comes with way to convert Form\+Data into Blobs -\/ it\textquotesingle{}s not something that every developer should have to deal with. \+It\textquotesingle{}s mainly for $<$a href="{}\href{https://github.com/node-fetch/node-fetch}{\texttt{ https\+://github.\+com/node-\/fetch/node-\/fetch}}"{} $>$node-\/fetch$<$/a$>$ and other http library to ease the process of serializing a Form\+Data into a blob and just wish to deal with Blobs instead (\+Both Deno and Undici adapted a version of this $<$a href="{}\href{https://github.com/jimmywarting/FormData/blob/5ddea9e0de2fc5e246ab1b2f9d404dee0c319c02/formdata-to-blob.js}{\texttt{ https\+://github.\+com/jimmywarting/\+Form\+Data/blob/5ddea9e0de2fc5e246ab1b2f9d404dee0c319c02/formdata-\/to-\/blob.\+js}}"{} $>$form\+Data\+To\+Blob$<$/a$>$ to the core and passes all WPT tests run by the browser itself) @icode\{js\}  import \{ Readable \} from \textquotesingle{}node\+:stream\textquotesingle{} import \{ Form\+Data, form\+Data\+To\+Blob \} from \textquotesingle{}formdata-\/polyfill/esm.\+min.\+js\textquotesingle{}  const blob = form\+Data\+To\+Blob(new Form\+Data()) fetch(\textquotesingle{}https\+://httpbin.\+org/post\textquotesingle{}, \{ method\+: \textquotesingle{}\+POST\textquotesingle{}, body\+: blob \})  // node built in http and other similar http library have to do\+: const stream = Readable.\+from(blob.\+stream()) const req = http.\+request(\textquotesingle{}http\+://httpbin.\+org/post\textquotesingle{}, \{   method\+: \textquotesingle{}post\textquotesingle{},   headers\+: \{     \textquotesingle{}\+Content-\/\+Length\textquotesingle{}\+: blob.\+size,     \textquotesingle{}\+Content-\/\+Type\textquotesingle{}\+: blob.\+type   \} \}) stream.\+pipe(req) @endicode   \+PS\+: blob \& file that are appended to the Form\+Data will not be read until any of the serialized blob read-\/methods gets called ...\+so uploading very large files is no biggie  @subsection autotoc\+\_\+md15797 Browser polyfill  usage\+:  @icode\{js\}  import \textquotesingle{}formdata-\/polyfill\textquotesingle{} // that\textquotesingle{}s it @endicode   \+The browser polyfill conditionally replaces the native implementation rather than fixing the missing functions, since otherwise there is no way to get or delete existing values in the Form\+Data object. \+Therefore this also patches $<$tt$>$\+XMLHttp\+Request.\+prototype.\+send$<$/tt$>$ and $<$tt$>$fetch$<$/tt$>$ to send the $<$tt$>$\+Form\+Data$<$/tt$>$ as a blob, and $<$tt$>$navigator.\+send\+Beacon$<$/tt$>$ to send native $<$tt$>$\+Form\+Data$<$/tt$>$.  \+I was unable to patch the Response/\+Request constructor so if you are constructing them with Form\+Data then you need to call $<$tt$>$fd.\+\_\+blob()$<$/tt$>$ manually.  @icode\{js\}  new Request(url, \{   method\+: \textquotesingle{}post\textquotesingle{},   body\+: fd.\+\_\+blob ? fd.\+\_\+blob() \+: fd \}) @endicode   @section autotoc\+\_\+md15798 Dependencies   \+If you need to support IE $<$= 9 then I recommend you to include eligrey\textquotesingle{}s \mbox{[}blob.\+js\mbox{]} (which i hope you don\textquotesingle{}t -\/ since IE is now dead)  $<$details$>$     $<$summary$>$\+Updating from 2.\+x to 3.\+x$<$/summary$>$  \+Previously you had to import the polyfill and use that, since it didn\textquotesingle{}t replace the global (existing) Form\+Data implementation. \+But now it transparently calls $<$tt$>$\+\_\+blob()$<$/tt$>$ for you when you are sending something with fetch or XHR, by way of monkey-\/patching the $<$tt$>$\+XMLHttp\+Request.\+prototype.\+send$<$/tt$>$ and $<$tt$>$fetch$<$/tt$>$ functions.  \+So you maybe had something like this\+:  @icode\{javascript\}  var Form\+Data = require(\textquotesingle{}formdata-\/polyfill\textquotesingle{}) var fd = new Form\+Data(form) xhr.\+send(fd.\+\_\+blob()) @endicode   \+There is no longer anything exported from the module (though you of course still need to import it to install the polyfill), so you can now use the Form\+Data object as normal\+:  @icode\{javascript\}  require(\textquotesingle{}formdata-\/polyfill\textquotesingle{}) var fd = new Form\+Data(form) xhr.\+send(fd) @endicode   $<$/details$>$    @section autotoc\+\_\+md15799 Native Browser compatibility (as of 2021-\/05-\/08)  \+Based on this you can decide for yourself if you need this polyfill.  $<$a href="{}\href{https://developer.mozilla.org/en-US/docs/Web/API/FormData\#Browser_compatibility}{\texttt{ https\+://developer.\+mozilla.\+org/en-\/\+US/docs/\+Web/\+API/\+Form\+Data\#\+Browser\+\_\+compatibility}}"{} $>$$<$img src="{}\href{https://user-images.githubusercontent.com/1148376/117550329-0993aa80-b040-11eb-976c-14e31f1a3ba4.png}{\texttt{ https\+://user-\/images.\+githubusercontent.\+com/1148376/117550329-\/0993aa80-\/b040-\/11eb-\/976c-\/14e31f1a3ba4.\+png}}"{} alt="{}screenshot"{}/\texorpdfstring{$>$}{>}

This normalizes support for the Form\+Data API\+:


\begin{DoxyItemize}
\item {\ttfamily append} with filename
\item {\ttfamily delete()}, {\ttfamily get()}, {\ttfamily get\+All()}, {\ttfamily has()}, {\ttfamily set()}
\item {\ttfamily entries()}, {\ttfamily keys()}, {\ttfamily values()}, and support for {\ttfamily for...of}
\item Available in web workers (just include the polyfill) 
\end{DoxyItemize}