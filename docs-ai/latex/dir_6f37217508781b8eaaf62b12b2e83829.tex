\doxysection{node\+\_\+modules/postgres-\/bytea Directory Reference}
\hypertarget{dir_6f37217508781b8eaaf62b12b2e83829}{}\label{dir_6f37217508781b8eaaf62b12b2e83829}\index{node\_modules/postgres-\/bytea Directory Reference@{node\_modules/postgres-\/bytea Directory Reference}}


\doxysubsection{Detailed Description}
\begin{quote}
Decode/encode Postgres bytea strings to Buffers \end{quote}
\hypertarget{readme.md_autotoc_md26250}{}\doxysubsection{\texorpdfstring{Install}{Install}}\label{readme.md_autotoc_md26250}

\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ install\ postgres-\/bytea}

\end{DoxyCode}
\hypertarget{readme.md_autotoc_md26251}{}\doxysubsection{\texorpdfstring{Usage}{Usage}}\label{readme.md_autotoc_md26251}
\hypertarget{readme.md_autotoc_md26252}{}\doxysubsubsection{\texorpdfstring{Decoding}{Decoding}}\label{readme.md_autotoc_md26252}
To decode a bytea string into a buffer\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ bytea\ =\ require('postgres-\/bytea')}
\DoxyCodeLine{}
\DoxyCodeLine{//\ bytea\ hex\ format}
\DoxyCodeLine{bytea.decode('\(\backslash\)\(\backslash\)x1234')\ //\ <Buffer\ 12\ 34>}
\DoxyCodeLine{}
\DoxyCodeLine{//\ bytea\ escape\ format}
\DoxyCodeLine{bytea.decode('\(\backslash\)\(\backslash\)000\(\backslash\)\(\backslash\)100\(\backslash\)\(\backslash\)200')\ //\ <Buffer\ 00\ 40\ 80>}

\end{DoxyCode}


The {\ttfamily decode} function supports both the hex format used in Postgres 9+ and the escape format used in Postgres 8 and earlier. It automatically detects the format from the incoming data.

For backward compatibility, {\ttfamily decode} is also the default export from the package.\hypertarget{readme.md_autotoc_md26253}{}\doxysubsubsection{\texorpdfstring{Decoding (Stream)}{Decoding (Stream)}}\label{readme.md_autotoc_md26253}
To decode a bytea hex stream into binary\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ bytea\ =\ require('postgres-\/bytea')}
\DoxyCodeLine{}
\DoxyCodeLine{readable.pipe(new\ bytea.Decoder())}

\end{DoxyCode}


{\ttfamily Decoder} expects a double-\/escaped {\ttfamily \textbackslash{}\textbackslash{}x} prefix to allow reading from a {\ttfamily COPY TO} statement.\hypertarget{readme.md_autotoc_md26254}{}\doxysubsubsection{\texorpdfstring{Encoding (Stream)}{Encoding (Stream)}}\label{readme.md_autotoc_md26254}

\begin{DoxyCode}{0}
\DoxyCodeLine{const\ bytea\ =\ require('postgres-\/bytea')}
\DoxyCodeLine{}
\DoxyCodeLine{readable.pipe(new\ bytea.Encoder())}

\end{DoxyCode}


{\ttfamily Encoder} adds a double-\/escaped {\ttfamily \textbackslash{}\textbackslash{}x} prefix to allow writing to a {\ttfamily COPY FROM} statement.\hypertarget{readme.md_autotoc_md26255}{}\doxysubsection{\texorpdfstring{API}{API}}\label{readme.md_autotoc_md26255}
\hypertarget{readme.md_autotoc_md26256}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily bytea.\+decode(input)} -\/\texorpdfstring{$>$}{>} {\ttfamily buffer}}{{\ttfamily bytea.\+decode(input)} -\/\texorpdfstring{$>$}{>} {\ttfamily buffer}}}\label{readme.md_autotoc_md26256}
\hypertarget{readme.md_autotoc_md26257}{}\doxysubsubsubsubsection{\texorpdfstring{input}{input}}\label{readme.md_autotoc_md26257}
{\itshape Required} ~\newline
 Type\+: {\ttfamily string}

A Postgres bytea binary string.\hypertarget{readme.md_autotoc_md26258}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily new bytea.\+Decoder()} -\/\texorpdfstring{$>$}{>} {\ttfamily stream.\+Transform}}{{\ttfamily new bytea.\+Decoder()} -\/\texorpdfstring{$>$}{>} {\ttfamily stream.\+Transform}}}\label{readme.md_autotoc_md26258}
Creates a bytea decoder stream that emits buffer chunks.\hypertarget{readme.md_autotoc_md26259}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily new bytea.\+Encoder()} -\/\texorpdfstring{$>$}{>} {\ttfamily stream.\+Transform}}{{\ttfamily new bytea.\+Encoder()} -\/\texorpdfstring{$>$}{>} {\ttfamily stream.\+Transform}}}\label{readme.md_autotoc_md26259}
Creates a bytea encoder stream that receives buffer chunks and emits them as bytea strings.\hypertarget{readme.md_autotoc_md26260}{}\doxysubsection{\texorpdfstring{Prefix Escaping}{Prefix Escaping}}\label{readme.md_autotoc_md26260}
\begin{quote}
The “hex” format encodes binary data as 2 hexadecimal digits per byte, most significant nibble first. The entire string is preceded by the sequence \textbackslash{}x (to distinguish it from the escape format). In some contexts, the initial backslash may need to be escaped by doubling it (see Section 4.\+1.\+2.\+1).

\href{https://www.postgresql.org/docs/12/datatype-binary.html\#id-1.5.7.12.9}{\texttt{ https\+://www.\+postgresql.\+org/docs/12/datatype-\/binary.\+html\#id-\/1.\+5.\+7.\+12.\+9}} \end{quote}


A {\ttfamily SELECT} statement returns bytea values using the single-\/escaped {\ttfamily \textbackslash{}x} prefix. The {\ttfamily COPY TO} and {\ttfamily COPY FROM} commands expect and return bytea values with the double-\/escaped {\ttfamily \textbackslash{}\textbackslash{}x} prefix.

{\ttfamily bytea.\+decode} expects the single-\/escaped prefix. The {\ttfamily Decoder} and {\ttfamily Encoder} streams expect the double-\/escaped prefix, since they are most useful in {\ttfamily COPY FROM} and {\ttfamily COPY TO} statements.\hypertarget{readme.md_autotoc_md26261}{}\doxysubsection{\texorpdfstring{License}{License}}\label{readme.md_autotoc_md26261}
MIT © \href{http://bendrucker.me}{\texttt{ Ben Drucker}} 