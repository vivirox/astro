\doxysection{node\+\_\+modules/rfdc Directory Reference}
\hypertarget{dir_8281646cc0b18e2075a45faa3eeeccb0}{}\label{dir_8281646cc0b18e2075a45faa3eeeccb0}\index{node\_modules/rfdc Directory Reference@{node\_modules/rfdc Directory Reference}}


\doxysubsection{Detailed Description}
Really Fast Deep Clone

\href{https://travis-ci.org/davidmarkclements/rfdc}{\texttt{ }} \href{https://codecov.io/gh/davidmarkclements/rfdc}{\texttt{ }} \href{http://standardjs.com/}{\texttt{ }}\hypertarget{readme.md_autotoc_md29542}{}\doxysubsection{\texorpdfstring{Usage}{Usage}}\label{readme.md_autotoc_md29542}

\begin{DoxyCode}{0}
\DoxyCodeLine{const\ clone\ =\ require('rfdc')()}
\DoxyCodeLine{clone(\{a:\ 1,\ b:\ \{c:\ 2\}\})\ //\ =>\ \{a:\ 1,\ b:\ \{c:\ 2\}\}}

\end{DoxyCode}
\hypertarget{readme.md_autotoc_md29543}{}\doxysubsection{\texorpdfstring{API}{API}}\label{readme.md_autotoc_md29543}
\hypertarget{readme.md_autotoc_md29544}{}\doxysubsubsection{\texorpdfstring{`require(\textquotesingle{}rfdc')(opts = \{ proto\+: false, circles\+: false, constructor\+Handlers\+: \mbox{[}\mbox{]} \}) =\texorpdfstring{$>$}{>} clone(obj) =\texorpdfstring{$>$}{>} obj2\`{}}{`require(\textquotesingle{}rfdc')(opts = \{ proto\+: false, circles\+: false, constructor\+Handlers\+: \mbox{[}\mbox{]} \}) =\texorpdfstring{$>$}{>} clone(obj) =\texorpdfstring{$>$}{>} obj2\`{}}}\label{readme.md_autotoc_md29544}
\hypertarget{readme.md_autotoc_md29545}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily proto} option}{{\ttfamily proto} option}}\label{readme.md_autotoc_md29545}
Copy prototype properties as well as own properties into the new object.

It\textquotesingle{}s marginally faster to allow enumerable properties on the prototype to be copied into the cloned object (not onto it\textquotesingle{}s prototype, directly onto the object).

To explain by way of code\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{require('rfdc')(\{\ proto:\ false\ \})(Object.create(\{a:\ 1\}))\ //\ =>\ \{\}}
\DoxyCodeLine{require('rfdc')(\{\ proto:\ true\ \})(Object.create(\{a:\ 1\}))\ //\ =>\ \{a:\ 1\}}

\end{DoxyCode}


Setting {\ttfamily proto} to {\ttfamily true} will provide an additional 2\% performance boost.\hypertarget{readme.md_autotoc_md29546}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily circles} option}{{\ttfamily circles} option}}\label{readme.md_autotoc_md29546}
Keeping track of circular references will slow down performance with an additional 25\% overhead. Even if an object doesn\textquotesingle{}t have any circular references, the tracking overhead is the cost. By default if an object with a circular reference is passed to {\ttfamily rfdc}, it will throw (similar to how {\ttfamily JSON.\+stringify} \textbackslash{} would throw).

Use the {\ttfamily circles} option to detect and preserve circular references in the object. If performance is important, try removing the circular reference from the object (set to {\ttfamily undefined}) and then add it back manually after cloning instead of using this option.\hypertarget{readme.md_autotoc_md29547}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily constructor\+Handlers} option}{{\ttfamily constructor\+Handlers} option}}\label{readme.md_autotoc_md29547}
Sometimes consumers may want to add custom clone behaviour for particular classes (for example {\ttfamily Reg\+Exp} or {\ttfamily Object\+Id}, which aren\textquotesingle{}t supported out-\/of-\/the-\/box).

This can be done by passing {\ttfamily constructor\+Handlers}, which takes an array of tuples, where the first item is the class to match, and the second item is a function that takes the input and returns a cloned output\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ clone\ =\ require('rfdc')(\{}
\DoxyCodeLine{\ \ constructorHandlers:\ [}
\DoxyCodeLine{\ \ \ \ [RegExp,\ (o)\ =>\ new\ RegExp(o)],}
\DoxyCodeLine{\ \ ]}
\DoxyCodeLine{\})}
\DoxyCodeLine{}
\DoxyCodeLine{clone(\{r:\ /foo/\})\ //\ =>\ \{r:\ /foo/\}}

\end{DoxyCode}


{\bfseries{NOTE}}\+: For performance reasons, the handlers will only match an instance of the {\itshape exact} class (not a subclass). Subclasses will need to be added separately if they also need special clone behaviour.\hypertarget{readme.md_autotoc_md29548}{}\doxysubsubsection{\texorpdfstring{{\ttfamily default} import}{{\ttfamily default} import}}\label{readme.md_autotoc_md29548}
It is also possible to directly import the clone function with all options set to their default\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ clone\ =\ require("{}rfdc/default"{})}
\DoxyCodeLine{clone(\{a:\ 1,\ b:\ \{c:\ 2\}\})\ //\ =>\ \{a:\ 1,\ b:\ \{c:\ 2\}\}}

\end{DoxyCode}
\hypertarget{readme.md_autotoc_md29549}{}\doxysubsubsection{\texorpdfstring{Types}{Types}}\label{readme.md_autotoc_md29549}
{\ttfamily rfdc} clones all JSON types\+:


\begin{DoxyItemize}
\item {\ttfamily Object}
\item {\ttfamily Array}
\item {\ttfamily Number}
\item {\ttfamily String}
\item {\ttfamily null}
\end{DoxyItemize}

With additional support for\+:


\begin{DoxyItemize}
\item {\ttfamily Date} (copied)
\item {\ttfamily undefined} (copied)
\item {\ttfamily Buffer} (copied)
\item {\ttfamily Typed\+Array} (copied)
\item {\ttfamily Map} (copied)
\item {\ttfamily Set} (copied)
\item {\ttfamily Function} (referenced)
\item {\ttfamily Async\+Function} (referenced)
\item {\ttfamily Generator\+Function} (referenced)
\item {\ttfamily arguments} (copied to a normal object)
\end{DoxyItemize}

All other types have output values that match the output of {\ttfamily JSON.\+parse(JSON.\+stringify(o))}.

For instance\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ rfdc\ =\ require('rfdc')()}
\DoxyCodeLine{const\ err\ =\ Error()}
\DoxyCodeLine{err.code\ =\ 1}
\DoxyCodeLine{JSON.parse(JSON.stringify(e))\ //\ \{code:\ 1\}}
\DoxyCodeLine{rfdc(e)\ //\ \{code:\ 1\}}
\DoxyCodeLine{}
\DoxyCodeLine{JSON.parse(JSON.stringify(\{rx:\ /foo/\}))\ //\ \{rx:\ \{\}\}}
\DoxyCodeLine{rfdc(\{rx:\ /foo/\})\ //\ \{rx:\ \{\}\}}

\end{DoxyCode}
\hypertarget{readme.md_autotoc_md29550}{}\doxysubsection{\texorpdfstring{Benchmarks}{Benchmarks}}\label{readme.md_autotoc_md29550}

\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ run\ bench}

\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{benchDeepCopy*100:\ 671.675ms}
\DoxyCodeLine{benchLodashCloneDeep*100:\ 1.574s}
\DoxyCodeLine{benchCloneDeep*100:\ 936.792ms}
\DoxyCodeLine{benchFastCopy*100:\ 822.668ms}
\DoxyCodeLine{benchFastestJsonCopy*100:\ 363.898ms\ //\ See\ note\ below}
\DoxyCodeLine{benchPlainObjectClone*100:\ 556.635ms}
\DoxyCodeLine{benchNanoCopy*100:\ 770.234ms}
\DoxyCodeLine{benchRamdaClone*100:\ 2.695s}
\DoxyCodeLine{benchJsonParseJsonStringify*100:\ 2.290s\ //\ JSON.parse(JSON.stringify(obj))}
\DoxyCodeLine{benchRfdc*100:\ 412.818ms}
\DoxyCodeLine{benchRfdcProto*100:\ 424.076ms}
\DoxyCodeLine{benchRfdcCircles*100:\ 443.357ms}
\DoxyCodeLine{benchRfdcCirclesProto*100:\ 465.053ms}

\end{DoxyCode}


It is true that \href{https://www.npmjs.com/package/fastest-json-copy}{\texttt{ fastest-\/json-\/copy}} may be faster, BUT it has such huge limitations that it is rarely useful. For example, it treats things like {\ttfamily Date} and {\ttfamily Map} instances the same as empty {\ttfamily \{\}}. It can\textquotesingle{}t handle circular references. \href{https://www.npmjs.com/package/plain-object-clone}{\texttt{ plain-\/object-\/clone}} is also really limited in capability.\hypertarget{readme.md_autotoc_md29551}{}\doxysubsection{\texorpdfstring{Tests}{Tests}}\label{readme.md_autotoc_md29551}

\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ test}

\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{169\ passing\ (342.514ms)}

\end{DoxyCode}
\hypertarget{readme.md_autotoc_md29552}{}\doxysubsubsection{\texorpdfstring{Coverage}{Coverage}}\label{readme.md_autotoc_md29552}

\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ run\ cov}

\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|}
\DoxyCodeLine{File\ \ \ \ \ \ |\ \ \%\ Stmts\ |\ \%\ Branch\ |\ \ \%\ Funcs\ |\ \ \%\ Lines\ |\ Uncovered\ Line\ \#s\ |}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|}
\DoxyCodeLine{All\ files\ |\ \ \ \ \ \ 100\ |\ \ \ \ \ \ 100\ |\ \ \ \ \ \ 100\ |\ \ \ \ \ \ 100\ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{\ index.js\ |\ \ \ \ \ \ 100\ |\ \ \ \ \ \ 100\ |\ \ \ \ \ \ 100\ |\ \ \ \ \ \ 100\ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|}

\end{DoxyCode}
\hypertarget{readme.md_autotoc_md29553}{}\doxysubsubsection{\texorpdfstring{{\ttfamily \+\_\+\+\_\+proto\+\_\+\+\_\+} own property copying}{{\ttfamily \+\_\+\+\_\+proto\+\_\+\+\_\+} own property copying}}\label{readme.md_autotoc_md29553}
{\ttfamily rfdc} works the same way as {\ttfamily Object.\+assign} when it comes to copying `\mbox{[}'{\bfseries{proto}}\textquotesingle{}\mbox{]}` (e.\+g. when an object has an own property key called '{\bfseries{proto}}\textquotesingle{}). It results in the target object prototype object being set per the value of the `\mbox{[}'{\bfseries{proto}}\textquotesingle{}\mbox{]}\`{} own property.

For detailed write-\/up on how a way to handle this security-\/wise see \href{https://www.fastify.io/docs/latest/Guides/Prototype-Poisoning/}{\texttt{ https\+://www.\+fastify.\+io/docs/latest/\+Guides/\+Prototype-\/\+Poisoning/}}.\hypertarget{readme.md_autotoc_md29554}{}\doxysubsection{\texorpdfstring{License}{License}}\label{readme.md_autotoc_md29554}
MIT 