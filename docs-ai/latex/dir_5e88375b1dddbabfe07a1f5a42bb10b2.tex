\doxysection{node\+\_\+modules/sitemap Directory Reference}
\hypertarget{dir_5e88375b1dddbabfe07a1f5a42bb10b2}{}\label{dir_5e88375b1dddbabfe07a1f5a42bb10b2}\index{node\_modules/sitemap Directory Reference@{node\_modules/sitemap Directory Reference}}
\doxysubsubsection*{Directories}
\begin{DoxyCompactItemize}
\item 
directory \mbox{\hyperlink{dir_6de0f4096a7b806870a2fd089371653f}{node\+\_\+modules}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
{\bfseries{sitemap}} is a high-\/level streaming sitemap-\/generating library/\+CLI that makes creating \href{http://www.sitemaps.org/}{\texttt{ sitemap XML}} files easy. \href{https://support.google.com/webmasters/answer/156184?hl=en&ref_topic=4581190}{\texttt{ What is a sitemap?}}\hypertarget{README.md_autotoc_md30853}{}\doxysubsection{\texorpdfstring{Table of Contents}{Table of Contents}}\label{README.md_autotoc_md30853}

\begin{DoxyItemize}
\item \doxylink{README.md_installation}{Installation}
\item Generate a one time sitemap from a list of urls
\item Example of using sitemap.js with \href{https://expressjs.com/}{\texttt{ express}}
\item Generating more than one sitemap
\item Options you can pass
\item \doxylink{README.md_examples}{Examples}
\item \doxylink{README.md_api}{API}
\item Maintainers
\item \doxylink{README.md_license}{License}
\end{DoxyItemize}\hypertarget{README.md_autotoc_md30854}{}\doxysubsection{\texorpdfstring{Installation}{Installation}}\label{README.md_autotoc_md30854}

\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ install\ -\/-\/save\ sitemap}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md30855}{}\doxysubsection{\texorpdfstring{Generate a one time sitemap from a list of urls}{Generate a one time sitemap from a list of urls}}\label{README.md_autotoc_md30855}
If you are just looking to take a giant list of URLs and turn it into some sitemaps, try out our CLI. The cli can also parse, update and validate existing sitemaps.


\begin{DoxyCode}{0}
\DoxyCodeLine{npx\ sitemap\ <\ listofurls.txt\ \#\ \`{}npx\ sitemap\ -\/h`\ for\ more\ examples\ and\ a\ list\ of\ options.}

\end{DoxyCode}


For programmatic one time generation of a sitemap try\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ \{\ SitemapStream,\ streamToPromise\ \}\ =\ require(\ 'sitemap'\ )}
\DoxyCodeLine{const\ \{\ Readable\ \}\ =\ require(\ 'stream'\ )}
\DoxyCodeLine{}
\DoxyCodeLine{//\ An\ array\ with\ your\ links}
\DoxyCodeLine{const\ links\ =\ [\{\ url:\ '/page-\/1/',\ \ changefreq:\ 'daily',\ priority:\ 0.3\ \ \}]}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Create\ a\ stream\ to\ write\ to}
\DoxyCodeLine{const\ stream\ =\ new\ SitemapStream(\ \{\ hostname:\ 'https://...'\ \}\ )}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Return\ a\ promise\ that\ resolves\ with\ your\ XML\ string}
\DoxyCodeLine{return\ streamToPromise(Readable.from(links).pipe(stream)).then((data)\ =>}
\DoxyCodeLine{\ \ data.toString()}
\DoxyCodeLine{)}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md30856}{}\doxysubsection{\texorpdfstring{Serve a sitemap from a server and periodically update it}{Serve a sitemap from a server and periodically update it}}\label{README.md_autotoc_md30856}
Use this if you have less than 50 thousand urls. See Sitemap\+And\+Index\+Stream for if you have more.


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ express\ =\ require('express')}
\DoxyCodeLine{const\ \{\ SitemapStream,\ streamToPromise\ \}\ =\ require('sitemap')}
\DoxyCodeLine{const\ \{\ createGzip\ \}\ =\ require('zlib')}
\DoxyCodeLine{const\ \{\ Readable\ \}\ =\ require('stream')}
\DoxyCodeLine{}
\DoxyCodeLine{const\ app\ =\ express()}
\DoxyCodeLine{let\ sitemap}
\DoxyCodeLine{}
\DoxyCodeLine{app.get('/sitemap.xml',\ function(req,\ res)\ \{}
\DoxyCodeLine{\ \ res.header('Content-\/Type',\ 'application/xml');}
\DoxyCodeLine{\ \ res.header('Content-\/Encoding',\ 'gzip');}
\DoxyCodeLine{\ \ //\ if\ we\ have\ a\ cached\ entry\ send\ it}
\DoxyCodeLine{\ \ if\ (sitemap)\ \{}
\DoxyCodeLine{\ \ \ \ res.send(sitemap)}
\DoxyCodeLine{\ \ \ \ return}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ try\ \{}
\DoxyCodeLine{\ \ \ \ const\ smStream\ =\ new\ SitemapStream(\{\ hostname:\ 'https://example.com/'\ \})}
\DoxyCodeLine{\ \ \ \ const\ pipeline\ =\ smStream.pipe(createGzip())}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ //\ pipe\ your\ entries\ or\ directly\ write\ them.}
\DoxyCodeLine{\ \ \ \ smStream.write(\{\ url:\ '/page-\/1/',\ \ changefreq:\ 'daily',\ priority:\ 0.3\ \})}
\DoxyCodeLine{\ \ \ \ smStream.write(\{\ url:\ '/page-\/2/',\ \ changefreq:\ 'monthly',\ \ priority:\ 0.7\ \})}
\DoxyCodeLine{\ \ \ \ smStream.write(\{\ url:\ '/page-\/3/'\})\ \ \ \ //\ changefreq:\ 'weekly',\ \ priority:\ 0.5}
\DoxyCodeLine{\ \ \ \ smStream.write(\{\ url:\ '/page-\/4/',\ \ \ img:\ "{}http://urlTest.com"{}\ \})}
\DoxyCodeLine{\ \ \ \ /*\ or\ use}
\DoxyCodeLine{\ \ \ \ Readable.from([\{url:\ '/page-\/1'\}...]).pipe(smStream)}
\DoxyCodeLine{\ \ \ \ if\ you\ are\ looking\ to\ avoid\ writing\ your\ own\ loop.}
\DoxyCodeLine{\ \ \ \ */}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ //\ cache\ the\ response}
\DoxyCodeLine{\ \ \ \ streamToPromise(pipeline).then(sm\ =>\ sitemap\ =\ sm)}
\DoxyCodeLine{\ \ \ \ //\ make\ sure\ to\ attach\ a\ write\ stream\ such\ as\ streamToPromise\ before\ ending}
\DoxyCodeLine{\ \ \ \ smStream.end()}
\DoxyCodeLine{\ \ \ \ //\ stream\ write\ the\ response}
\DoxyCodeLine{\ \ \ \ pipeline.pipe(res).on('error',\ (e)\ =>\ \{throw\ e\})}
\DoxyCodeLine{\ \ \}\ catch\ (e)\ \{}
\DoxyCodeLine{\ \ \ \ console.error(e)}
\DoxyCodeLine{\ \ \ \ res.status(500).end()}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\})}
\DoxyCodeLine{}
\DoxyCodeLine{app.listen(3000,\ ()\ =>\ \{}
\DoxyCodeLine{\ \ console.log('listening')}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md30857}{}\doxysubsection{\texorpdfstring{Create sitemap and index files from one large list}{Create sitemap and index files from one large list}}\label{README.md_autotoc_md30857}
If you know you are definitely going to have more than 50,000 urls in your sitemap, you can use this slightly more complex interface to create a new sitemap every 45,000 entries and add that file to a sitemap index.


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ \{\ createReadStream,\ createWriteStream\ \}\ =\ require('fs');}
\DoxyCodeLine{const\ \{\ resolve\ \}\ =\ require('path');}
\DoxyCodeLine{const\ \{\ createGzip\ \}\ =\ require('zlib')}
\DoxyCodeLine{const\ \{}
\DoxyCodeLine{\ \ simpleSitemapAndIndex,}
\DoxyCodeLine{\ \ lineSeparatedURLsToSitemapOptions}
\DoxyCodeLine{\}\ =\ require('sitemap')}
\DoxyCodeLine{}
\DoxyCodeLine{//\ writes\ sitemaps\ and\ index\ out\ to\ the\ destination\ you\ provide.}
\DoxyCodeLine{simpleSitemapAndIndex(\{}
\DoxyCodeLine{\ \ hostname:\ 'https://example.com',}
\DoxyCodeLine{\ \ destinationDir:\ './',}
\DoxyCodeLine{\ \ sourceData:\ lineSeparatedURLsToSitemapOptions(}
\DoxyCodeLine{\ \ \ \ createReadStream('./your-\/data.json.txt')}
\DoxyCodeLine{\ \ ),}
\DoxyCodeLine{\ \ //\ or\ (only\ works\ with\ node\ 10.17\ and\ up)}
\DoxyCodeLine{\ \ sourceData:\ [\{\ url:\ '/page-\/1/',\ changefreq:\ 'daily'\},\ ...],}
\DoxyCodeLine{\ \ //\ or}
\DoxyCodeLine{\ \ sourceData:\ './your-\/data.json.txt',}
\DoxyCodeLine{\}).then(()\ =>\ \{}
\DoxyCodeLine{\ \ //\ Do\ follow\ up\ actions}
\DoxyCodeLine{\})}

\end{DoxyCode}


Want to customize that?


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ \{\ createReadStream,\ createWriteStream\ \}\ =\ require('fs');}
\DoxyCodeLine{const\ \{\ resolve\ \}\ =\ require('path');}
\DoxyCodeLine{const\ \{\ createGzip\ \}\ =\ require('zlib')}
\DoxyCodeLine{const\ \{\ Readable\ \}\ =\ require('stream')}
\DoxyCodeLine{const\ \{}
\DoxyCodeLine{\ \ SitemapAndIndexStream,}
\DoxyCodeLine{\ \ SitemapStream,}
\DoxyCodeLine{\ \ lineSeparatedURLsToSitemapOptions}
\DoxyCodeLine{\}\ =\ require('sitemap')}
\DoxyCodeLine{}
\DoxyCodeLine{const\ sms\ =\ new\ SitemapAndIndexStream(\{}
\DoxyCodeLine{\ \ limit:\ 50000,\ //\ defaults\ to\ 45k}
\DoxyCodeLine{\ \ lastmodDateOnly:\ false,\ //\ print\ date\ not\ time}
\DoxyCodeLine{\ \ //\ SitemapAndIndexStream\ will\ call\ this\ user\ provided\ function\ every\ time}
\DoxyCodeLine{\ \ //\ it\ needs\ to\ create\ a\ new\ sitemap\ file.\ You\ merely\ need\ to\ return\ a\ stream}
\DoxyCodeLine{\ \ //\ for\ it\ to\ write\ the\ sitemap\ urls\ to\ and\ the\ expected\ url\ where\ that\ sitemap\ will\ be\ hosted}
\DoxyCodeLine{\ \ getSitemapStream:\ (i)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ const\ sitemapStream\ =\ new\ SitemapStream(\{\ hostname:\ 'https://example.com'\ \});}
\DoxyCodeLine{\ \ \ \ //\ if\ your\ server\ automatically\ serves\ sitemap.xml.gz\ when\ requesting\ sitemap.xml\ leave\ this\ line\ be}
\DoxyCodeLine{\ \ \ \ //\ otherwise\ you\ will\ need\ to\ add\ .gz\ here\ and\ remove\ it\ a\ couple\ lines\ below\ so\ that\ both\ the\ index\ }
\DoxyCodeLine{\ \ \ \ //\ and\ the\ actual\ file\ have\ a\ .gz\ extension}
\DoxyCodeLine{\ \ \ \ const\ path\ =\ \`{}./sitemap-\/\$\{i\}.xml`;\ }
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ const\ ws\ =\ sitemapStream}
\DoxyCodeLine{\ \ \ \ \ \ .pipe(createGzip())\ //\ compress\ the\ output\ of\ the\ sitemap}
\DoxyCodeLine{\ \ \ \ \ \ .pipe(createWriteStream(resolve(path\ +\ '.gz')));\ //\ write\ it\ to\ sitemap-\/NUMBER.xml}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ return\ [new\ URL(path,\ 'https://example.com/subdir/').toString(),\ sitemapStream,\ ws];}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{//\ when\ reading\ from\ a\ file}
\DoxyCodeLine{lineSeparatedURLsToSitemapOptions(}
\DoxyCodeLine{\ \ createReadStream('./your-\/data.json.txt')}
\DoxyCodeLine{)}
\DoxyCodeLine{.pipe(sms)}
\DoxyCodeLine{.pipe(createGzip())}
\DoxyCodeLine{.pipe(createWriteStream(resolve('./sitemap-\/index.xml.gz')));}
\DoxyCodeLine{}
\DoxyCodeLine{//\ or\ reading\ straight\ from\ an\ in-\/memory\ array}
\DoxyCodeLine{sms}
\DoxyCodeLine{.pipe(createGzip())}
\DoxyCodeLine{.pipe(createWriteStream(resolve('./sitemap-\/index.xml.gz')));}
\DoxyCodeLine{}
\DoxyCodeLine{const\ arrayOfSitemapItems\ =\ [\{\ url:\ '/page-\/1/',\ changefreq:\ 'daily'\},\ ...]}
\DoxyCodeLine{Readable.from(arrayOfSitemapItems).pipe(sms)\ //\ available\ as\ of\ node\ 10.17.0}
\DoxyCodeLine{//\ or}
\DoxyCodeLine{arrayOfSitemapItems.forEach(item\ =>\ sms.write(item))}
\DoxyCodeLine{sms.end()\ //\ necessary\ to\ let\ it\ know\ you've\ got\ nothing\ else\ to\ write}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md30858}{}\doxysubsubsection{\texorpdfstring{Options you can pass}{Options you can pass}}\label{README.md_autotoc_md30858}

\begin{DoxyCode}{0}
\DoxyCodeLine{const\ \{\ SitemapStream,\ streamToPromise\ \}\ =\ require('sitemap');}
\DoxyCodeLine{const\ smStream\ =\ new\ SitemapStream(\{}
\DoxyCodeLine{\ \ hostname:\ 'http://www.mywebsite.com',}
\DoxyCodeLine{\ \ xslUrl:\ "{}https://example.com/style.xsl"{},}
\DoxyCodeLine{\ \ lastmodDateOnly:\ false,\ //\ print\ date\ not\ time}
\DoxyCodeLine{\ \ xmlns:\ \{\ //\ trim\ the\ xml\ namespace}
\DoxyCodeLine{\ \ \ \ news:\ true,\ //\ flip\ to\ false\ to\ omit\ the\ xml\ namespace\ for\ news}
\DoxyCodeLine{\ \ \ \ xhtml:\ true,}
\DoxyCodeLine{\ \ \ \ image:\ true,}
\DoxyCodeLine{\ \ \ \ video:\ true,}
\DoxyCodeLine{\ \ \ \ custom:\ [}
\DoxyCodeLine{\ \ \ \ \ \ 'xsi:schemaLocation="{}http://www.sitemaps.org/schemas/sitemap/0.9\ http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd"{}',}
\DoxyCodeLine{\ \ \ \ \ \ 'xmlns:xsi="{}http://www.w3.org/2001/XMLSchema-\/instance"{}',}
\DoxyCodeLine{\ \ \ \ ],}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \})}
\DoxyCodeLine{//\ coalesce\ stream\ to\ value}
\DoxyCodeLine{//\ alternatively\ you\ can\ pipe\ to\ another\ stream}
\DoxyCodeLine{streamToPromise(smStream).then(console.log)}
\DoxyCodeLine{}
\DoxyCodeLine{smStream.write(\{}
\DoxyCodeLine{\ \ url:\ '/page1',}
\DoxyCodeLine{\ \ changefreq:\ 'weekly',}
\DoxyCodeLine{\ \ priority:\ 0.8,\ //\ A\ hint\ to\ the\ crawler\ that\ it\ should\ prioritize\ this\ over\ items\ less\ than\ 0.8}
\DoxyCodeLine{\})}
\DoxyCodeLine{}
\DoxyCodeLine{//\ each\ sitemap\ entry\ supports\ many\ options}
\DoxyCodeLine{//\ See\ [Sitemap\ Item\ Options](./api.md\#sitemap-\/item-\/options)\ below\ for\ details}
\DoxyCodeLine{smStream.write(\{}
\DoxyCodeLine{\ \ url:\ 'http://test.com/page-\/1/',}
\DoxyCodeLine{\ \ img:\ [}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ url:\ 'http://test.com/img1.jpg',}
\DoxyCodeLine{\ \ \ \ \ \ caption:\ 'An\ image',}
\DoxyCodeLine{\ \ \ \ \ \ title:\ 'The\ Title\ of\ Image\ One',}
\DoxyCodeLine{\ \ \ \ \ \ geoLocation:\ 'London,\ United\ Kingdom',}
\DoxyCodeLine{\ \ \ \ \ \ license:\ 'https://creativecommons.org/licenses/by/4.0/'}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ url:\ 'http://test.com/img2.jpg',}
\DoxyCodeLine{\ \ \ \ \ \ caption:\ 'Another\ image',}
\DoxyCodeLine{\ \ \ \ \ \ title:\ 'The\ Title\ of\ Image\ Two',}
\DoxyCodeLine{\ \ \ \ \ \ geoLocation:\ 'London,\ United\ Kingdom',}
\DoxyCodeLine{\ \ \ \ \ \ license:\ 'https://creativecommons.org/licenses/by/4.0/'}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ ],}
\DoxyCodeLine{\ \ video:\ [}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ thumbnail\_loc:\ 'http://test.com/tmbn1.jpg',}
\DoxyCodeLine{\ \ \ \ \ \ title:\ 'A\ video\ title',}
\DoxyCodeLine{\ \ \ \ \ \ description:\ 'This\ is\ a\ video'}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ thumbnail\_loc:\ 'http://test.com/tmbn2.jpg',}
\DoxyCodeLine{\ \ \ \ \ \ title:\ 'A\ video\ with\ an\ attribute',}
\DoxyCodeLine{\ \ \ \ \ \ description:\ 'This\ is\ another\ video',}
\DoxyCodeLine{\ \ \ \ \ \ 'player\_loc':\ 'http://www.example.com/videoplayer.mp4?video=123',}
\DoxyCodeLine{\ \ \ \ \ \ 'player\_loc:autoplay':\ 'ap=1',}
\DoxyCodeLine{\ \ \ \ \ \ 'player\_loc:allow\_embed':\ 'yes'}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ ],}
\DoxyCodeLine{\ \ links:\ [}
\DoxyCodeLine{\ \ \ \ \{\ lang:\ 'en',\ url:\ 'http://test.com/page-\/1/'\ \},}
\DoxyCodeLine{\ \ \ \ \{\ lang:\ 'ja',\ url:\ 'http://test.com/page-\/1/ja/'\ \}}
\DoxyCodeLine{\ \ ],}
\DoxyCodeLine{\ \ androidLink:\ 'android-\/app://com.company.test/page-\/1/',}
\DoxyCodeLine{\ \ news:\ \{}
\DoxyCodeLine{\ \ \ \ publication:\ \{}
\DoxyCodeLine{\ \ \ \ \ \ name:\ 'The\ Example\ Times',}
\DoxyCodeLine{\ \ \ \ \ \ language:\ 'en'}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ genres:\ 'PressRelease,\ Blog',}
\DoxyCodeLine{\ \ \ \ publication\_date:\ '2008-\/12-\/23',}
\DoxyCodeLine{\ \ \ \ title:\ 'Companies\ A,\ B\ in\ Merger\ Talks',}
\DoxyCodeLine{\ \ \ \ keywords:\ 'business,\ merger,\ acquisition,\ A,\ B',}
\DoxyCodeLine{\ \ \ \ stock\_tickers:\ 'NASDAQ:A,\ NASDAQ:B'}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\})}
\DoxyCodeLine{//\ indicate\ there\ is\ nothing\ left\ to\ write}
\DoxyCodeLine{smStream.end()}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md30859}{}\doxysubsection{\texorpdfstring{Examples}{Examples}}\label{README.md_autotoc_md30859}
For more examples see the \href{./examples/}{\texttt{ examples directory}}\hypertarget{README.md_autotoc_md30860}{}\doxysubsection{\texorpdfstring{API}{API}}\label{README.md_autotoc_md30860}
Full API docs can be found \doxysectlink{md_node__modules_2sitemap_2api}{here}{0}\hypertarget{README.md_autotoc_md30861}{}\doxysubsection{\texorpdfstring{Maintainers}{Maintainers}}\label{README.md_autotoc_md30861}

\begin{DoxyItemize}
\item \href{https://github.com/ekalinin}{\texttt{ @ekalinin}}
\item \href{https://github.com/derduher}{\texttt{ @derduher}}
\end{DoxyItemize}\hypertarget{README.md_autotoc_md30862}{}\doxysubsection{\texorpdfstring{License}{License}}\label{README.md_autotoc_md30862}
See \href{https://github.com/ekalinin/sitemap.js/blob/master/LICENSE}{\texttt{ LICENSE}} file. 