\doxysection{node\+\_\+modules/toad-\/cache Directory Reference}
\hypertarget{dir_3fed020540b20f5c68a0ebd2bcd8c7cd}{}\label{dir_3fed020540b20f5c68a0ebd2bcd8c7cd}\index{node\_modules/toad-\/cache Directory Reference@{node\_modules/toad-\/cache Directory Reference}}


\doxysubsection{Detailed Description}
\href{https://npmjs.org/package/toad-cache}{\texttt{ }} \href{https://npmjs.org/package/toad-cache}{\texttt{ }}  \href{https://coveralls.io/r/kibertoad/toad-cache?branch=main}{\texttt{ }}

Least-\/\+Recently-\/\+Used and First-\/\+In-\/\+First-\/\+Out caches for Client or Server.\hypertarget{README.md_autotoc_md33024}{}\doxysubsection{\texorpdfstring{Getting started}{Getting started}}\label{README.md_autotoc_md33024}

\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ Lru,\ Fifo\ \}\ from\ 'toad-\/cache'}
\DoxyCodeLine{const\ lruCache\ =\ new\ Lru(max,\ ttl\ =\ 0)}
\DoxyCodeLine{const\ fifoCache\ =\ new\ Fifo(max,\ ttl\ =\ 0)}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33025}{}\doxysubsection{\texorpdfstring{clear}{clear}}\label{README.md_autotoc_md33025}
\hypertarget{README.md_autotoc_md33026}{}\doxysubsubsection{\texorpdfstring{Method}{Method}}\label{README.md_autotoc_md33026}
Clears the contents of the cache

{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{cache.clear()}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33027}{}\doxysubsection{\texorpdfstring{delete}{delete}}\label{README.md_autotoc_md33027}
\hypertarget{README.md_autotoc_md33028}{}\doxysubsubsection{\texorpdfstring{Method}{Method}}\label{README.md_autotoc_md33028}
Removes item from cache \begin{DoxyVerb}param  {String} key Item key
\end{DoxyVerb}


{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{cache.delete('myKey')}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33029}{}\doxysubsection{\texorpdfstring{delete\+Many}{delete\+Many}}\label{README.md_autotoc_md33029}
\hypertarget{README.md_autotoc_md33030}{}\doxysubsubsection{\texorpdfstring{Method}{Method}}\label{README.md_autotoc_md33030}
Removes items from cache \begin{DoxyVerb}param  {String[]} keys Item keys
\end{DoxyVerb}


{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{cache.deleteMany(['myKey',\ 'myKey2'])}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33031}{}\doxysubsection{\texorpdfstring{evict}{evict}}\label{README.md_autotoc_md33031}
\hypertarget{README.md_autotoc_md33032}{}\doxysubsubsection{\texorpdfstring{Method}{Method}}\label{README.md_autotoc_md33032}
Evicts the least recently used item from cache

{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{cache.evict()}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33033}{}\doxysubsection{\texorpdfstring{expires\+At}{expires\+At}}\label{README.md_autotoc_md33033}
\hypertarget{README.md_autotoc_md33034}{}\doxysubsubsection{\texorpdfstring{Method}{Method}}\label{README.md_autotoc_md33034}
Gets expiration time for cached item \begin{DoxyVerb}param  {String} key Item key
return {Mixed}      Undefined or number (epoch time)
\end{DoxyVerb}


{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ item\ =\ cache.expiresAt('myKey')}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33035}{}\doxysubsection{\texorpdfstring{first}{first}}\label{README.md_autotoc_md33035}
\hypertarget{README.md_autotoc_md33036}{}\doxysubsubsection{\texorpdfstring{Property}{Property}}\label{README.md_autotoc_md33036}
Item in "{}first"{} or "{}bottom"{} position

{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ cache\ =\ new\ Lru()}
\DoxyCodeLine{}
\DoxyCodeLine{cache.first\ //\ null\ -\/\ it's\ a\ new\ cache!}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33037}{}\doxysubsection{\texorpdfstring{get}{get}}\label{README.md_autotoc_md33037}
\hypertarget{README.md_autotoc_md33038}{}\doxysubsubsection{\texorpdfstring{Method}{Method}}\label{README.md_autotoc_md33038}
Gets cached item and marks it as recently used (pushes to the back of the list of the candidates for the eviction) \begin{DoxyVerb}param  {String} key Item key
return {Mixed}      Undefined or Item value
\end{DoxyVerb}


{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ item\ =\ cache.get('myKey')}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33039}{}\doxysubsection{\texorpdfstring{get\+Many}{get\+Many}}\label{README.md_autotoc_md33039}
\hypertarget{README.md_autotoc_md33040}{}\doxysubsubsection{\texorpdfstring{Method}{Method}}\label{README.md_autotoc_md33040}
Gets multiple cached items and marks them as recently used (pushes to the back of the list of the candidates for the eviction) \begin{DoxyVerb}param  {String[]} keys Item keys
return {Mixed[]}      Undefined or Item values
\end{DoxyVerb}


{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ item\ =\ cache.getMany(['myKey',\ 'myKey2'])}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33041}{}\doxysubsection{\texorpdfstring{keys}{keys}}\label{README.md_autotoc_md33041}
\hypertarget{README.md_autotoc_md33042}{}\doxysubsubsection{\texorpdfstring{Method}{Method}}\label{README.md_autotoc_md33042}
Returns an {\ttfamily Array} of cache item keys. \begin{DoxyVerb}return {Array} Array of keys
\end{DoxyVerb}


{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{console.log(cache.keys())}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33043}{}\doxysubsection{\texorpdfstring{max}{max}}\label{README.md_autotoc_md33043}
\hypertarget{README.md_autotoc_md33044}{}\doxysubsubsection{\texorpdfstring{Property}{Property}}\label{README.md_autotoc_md33044}
Max items to hold in cache (1000)

{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ cache\ =\ new\ Lru(500)}
\DoxyCodeLine{}
\DoxyCodeLine{cache.max\ //\ 500}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33045}{}\doxysubsection{\texorpdfstring{last}{last}}\label{README.md_autotoc_md33045}
\hypertarget{README.md_autotoc_md33046}{}\doxysubsubsection{\texorpdfstring{Property}{Property}}\label{README.md_autotoc_md33046}
Item in "{}last"{} or "{}top"{} position

{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ cache\ =\ new\ Lru()}
\DoxyCodeLine{}
\DoxyCodeLine{cache.last\ //\ null\ -\/\ it's\ a\ new\ cache!}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33047}{}\doxysubsection{\texorpdfstring{set}{set}}\label{README.md_autotoc_md33047}
\hypertarget{README.md_autotoc_md33048}{}\doxysubsubsection{\texorpdfstring{Method}{Method}}\label{README.md_autotoc_md33048}
Sets item in cache as {\ttfamily first} \begin{DoxyVerb}param  {String} key   Item key
param  {Mixed}  value Item value
\end{DoxyVerb}


{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{cache.set('myKey',\ \{\ prop:\ true\ \})}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33049}{}\doxysubsection{\texorpdfstring{size}{size}}\label{README.md_autotoc_md33049}
\hypertarget{README.md_autotoc_md33050}{}\doxysubsubsection{\texorpdfstring{Property}{Property}}\label{README.md_autotoc_md33050}
Number of items in cache

{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ cache\ =\ new\ Lru()}
\DoxyCodeLine{}
\DoxyCodeLine{cache.size\ //\ 0\ -\/\ it's\ a\ new\ cache!}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33051}{}\doxysubsection{\texorpdfstring{ttl}{ttl}}\label{README.md_autotoc_md33051}
\hypertarget{README.md_autotoc_md33052}{}\doxysubsubsection{\texorpdfstring{Property}{Property}}\label{README.md_autotoc_md33052}
Milliseconds an item will remain in cache; lazy expiration upon next {\ttfamily get()} of an item

{\bfseries{Example}}


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ cache\ =\ new\ Lru()}
\DoxyCodeLine{}
\DoxyCodeLine{cache.ttl\ =\ 3e4}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33053}{}\doxysubsection{\texorpdfstring{Hit/miss/expiration tracking}{Hit/miss/expiration tracking}}\label{README.md_autotoc_md33053}
In case you want to gather information on cache hit/miss/expiration ratio, as well as cache size and eviction statistics, you can use Lru\+Hit\+Statistics class\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ sharedRecord\ =\ new\ HitStatisticsRecord()\ //\ if\ you\ want\ to\ use\ single\ record\ object\ for\ all\ of\ caches,\ create\ it\ manually\ and\ pass\ to\ each\ cache}
\DoxyCodeLine{}
\DoxyCodeLine{const\ cache\ =\ new\ LruHitStatistics(\{}
\DoxyCodeLine{\ \ cacheId:\ 'some-\/cache-\/id',}
\DoxyCodeLine{\ \ globalStatisticsRecord:\ sharedRecord,}
\DoxyCodeLine{\ \ statisticTtlInHours:\ 24,\ //\ how\ often\ to\ reset\ statistics.\ On\ every\ rotation\ previously\ accumulated\ data\ is\ removed}
\DoxyCodeLine{\ \ max:\ 1000,}
\DoxyCodeLine{\ \ ttlInMsecs:\ 0,}
\DoxyCodeLine{\})}

\end{DoxyCode}


You can retrieve accumulated statistics from the cache, or from the record directly\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ this\ is\ the\ same}
\DoxyCodeLine{const\ statistics\ =\ sharedRecord.getStatistics()}
\DoxyCodeLine{const\ alsoStatistics\ =\ cache.getStatistics()}
\DoxyCodeLine{}
\DoxyCodeLine{/*}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ 'some-\/cache-\/id':\ \{}
\DoxyCodeLine{\ \ \ \ '2023-\/04-\/06':\ \{}
\DoxyCodeLine{\ \ \ \ \ \ cacheSize:\ 100,\ //\ how\ many\ elements\ does\ cache\ currently\ have}
\DoxyCodeLine{\ \ \ \ \ \ evictions:\ 5,\ //\ how\ many\ elements\ were\ evicted\ due\ to\ cache\ being\ at\ max\ capacity\ \ \ \ }
\DoxyCodeLine{\ \ \ \ \ \ expirations:\ 0,\ //\ how\ many\ elements\ were\ removed\ during\ get\ due\ to\ their\ ttl\ being\ exceeded}
\DoxyCodeLine{\ \ \ \ \ \ hits:\ 0,\ //\ how\ many\ times\ element\ was\ successfully\ retrieved\ from\ cache\ during\ get}
\DoxyCodeLine{\ \ \ \ \ \ emptyHits:\ 0,\ //\ out\ of\ all\ hits,\ how\ many\ were\ null,\ undefined\ or\ ''?}
\DoxyCodeLine{\ \ \ \ \ \ falsyHits:\ 0,\ //\ out\ of\ all\ hits,\ how\ many\ were\ falsy?\ \ \ \ \ \ }
\DoxyCodeLine{\ \ \ \ \ \ misses:\ 1,\ //\ how\ many\ times\ element\ was\ not\ in\ cache\ or\ expired\ during\ get}
\DoxyCodeLine{\ \ \ \ \ \ invalidateOne:\ 1,\ //\ how\ many\ times\ element\ was\ invalidated\ individually}
\DoxyCodeLine{\ \ \ \ \ \ invalidateAll:\ 2,\ //\ how\ many\ times\ entire\ cache\ was\ invalidated}
\DoxyCodeLine{\ \ \ \ \ \ sets:\ 0,\ //\ how\ many\ times\ new\ element\ was\ added\ \ \ \ \ \ }
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{Note\ that\ date\ here\ reflects\ start\ of\ the\ rotation.\ If\ statistics\ weren't\ rotated\ yet,\ and\ another\ day\ started,\ it\ will\ still\ be\ counted\ against\ the\ day\ of\ the\ rotation\ start}
\DoxyCodeLine{*/}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33054}{}\doxysubsection{\texorpdfstring{License}{License}}\label{README.md_autotoc_md33054}
Copyright (c) 2023 Igor Savin

Based on \href{https://github.com/avoidwork/tiny-lru}{\texttt{ tiny-\/lru}}, created by Jason Mulligan

Licensed under the MIT license. 