\doxysection{node\+\_\+modules/parseley Directory Reference}
\hypertarget{dir_58025dee9b45d54f9069816eb73f8228}{}\label{dir_58025dee9b45d54f9069816eb73f8228}\index{node\_modules/parseley Directory Reference@{node\_modules/parseley Directory Reference}}


\doxysubsection{Detailed Description}
  \href{https://github.com/mxxii/parseley/blob/main/LICENSE}{\texttt{ }} \href{https://www.npmjs.com/package/parseley}{\texttt{ }} \href{https://www.npmjs.com/package/parseley}{\texttt{ }} \href{https://deno.land/x/parseley}{\texttt{ }}

\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}\+Par\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}ser for CSS \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}sele\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}ctors.

\DoxyHorRuler{0}
\hypertarget{README.md_autotoc_md25648}{}\doxysubsection{\texorpdfstring{Features}{Features}}\label{README.md_autotoc_md25648}

\begin{DoxyItemize}
\item Convert CSS selector strings into objects that are easy to work with;
\item Serialize back if needed;
\item Get specificity for free.
\end{DoxyItemize}\hypertarget{README.md_autotoc_md25649}{}\doxysubsection{\texorpdfstring{Changelog}{Changelog}}\label{README.md_autotoc_md25649}
Available here\+: \href{https://github.com/mxxii/parseley/blob/main/CHANGELOG.md}{\texttt{ CHANGELOG.\+md}}.\hypertarget{README.md_autotoc_md25650}{}\doxysubsection{\texorpdfstring{Install}{Install}}\label{README.md_autotoc_md25650}
\hypertarget{README.md_autotoc_md25651}{}\doxysubsubsection{\texorpdfstring{Node}{Node}}\label{README.md_autotoc_md25651}

\begin{DoxyCode}{0}
\DoxyCodeLine{>\ npm\ i\ parseley}

\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{import\ *\ as\ parseley\ from\ 'parseley';}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md25652}{}\doxysubsubsection{\texorpdfstring{Deno}{Deno}}\label{README.md_autotoc_md25652}

\begin{DoxyCode}{0}
\DoxyCodeLine{import\ *\ as\ parseley\ from\ 'https://deno.land/x/parseley@.../parseley.ts';}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md25653}{}\doxysubsection{\texorpdfstring{Usage example}{Usage example}}\label{README.md_autotoc_md25653}

\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ parse1,\ serialize,\ normalize\ \}\ from\ 'parseley';}
\DoxyCodeLine{import\ \{\ inspect\ \}\ from\ 'node:util';}
\DoxyCodeLine{}
\DoxyCodeLine{const\ str\ =\ 'div\#id1\ >\ .class2.class1[attr1]';}
\DoxyCodeLine{}
\DoxyCodeLine{const\ ast\ =\ parse1(str);}
\DoxyCodeLine{console.log(inspect(ast,\ \{\ breakLength:\ 45,\ depth:\ null\ \}));}
\DoxyCodeLine{}
\DoxyCodeLine{const\ serialized\ =\ serialize(ast);}
\DoxyCodeLine{console.log(`Serialized:\ '\$\{serialized\}'`);}
\DoxyCodeLine{}
\DoxyCodeLine{normalize(ast);}
\DoxyCodeLine{const\ normalized\ =\ serialize(ast);}
\DoxyCodeLine{console.log(`Normalized:\ '\$\{normalized\}'`);}

\end{DoxyCode}




{\bfseries{Example output}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ type:\ 'compound',}
\DoxyCodeLine{\ \ list:\ [}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ type:\ 'class',}
\DoxyCodeLine{\ \ \ \ \ \ name:\ 'class2',}
\DoxyCodeLine{\ \ \ \ \ \ specificity:\ [\ 0,\ 1,\ 0\ ]}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ type:\ 'class',}
\DoxyCodeLine{\ \ \ \ \ \ name:\ 'class1',}
\DoxyCodeLine{\ \ \ \ \ \ specificity:\ [\ 0,\ 1,\ 0\ ]}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ type:\ 'attrPresence',}
\DoxyCodeLine{\ \ \ \ \ \ name:\ 'attr1',}
\DoxyCodeLine{\ \ \ \ \ \ namespace:\ null,}
\DoxyCodeLine{\ \ \ \ \ \ specificity:\ [\ 0,\ 1,\ 0\ ]}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ type:\ 'combinator',}
\DoxyCodeLine{\ \ \ \ \ \ combinator:\ '>',}
\DoxyCodeLine{\ \ \ \ \ \ left:\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ type:\ 'compound',}
\DoxyCodeLine{\ \ \ \ \ \ \ \ list:\ [}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ type:\ 'tag',}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ name:\ 'div',}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ namespace:\ null,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ specificity:\ [\ 0,\ 0,\ 1\ ]}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ type:\ 'id',}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ name:\ 'id1',}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ specificity:\ [\ 1,\ 0,\ 0\ ]}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ],}
\DoxyCodeLine{\ \ \ \ \ \ \ \ specificity:\ [\ 1,\ 0,\ 1\ ]}
\DoxyCodeLine{\ \ \ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \ \ specificity:\ [\ 1,\ 0,\ 1\ ]}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ ],}
\DoxyCodeLine{\ \ specificity:\ [\ 1,\ 3,\ 1\ ]}
\DoxyCodeLine{\}}
\DoxyCodeLine{Serialized:\ 'div\#id1>.class2.class1[attr1]'}
\DoxyCodeLine{Normalized:\ 'div\#id1>.class1.class2[attr1]'}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md25654}{}\doxysubsection{\texorpdfstring{Documentation}{Documentation}}\label{README.md_autotoc_md25654}

\begin{DoxyItemize}
\item \href{https://github.com/mxxii/parseley/blob/main/docs/index.md}{\texttt{ Functions}}
\item \href{https://github.com/mxxii/parseley/blob/main/docs/modules/Ast.md}{\texttt{ AST types}}
\item \href{https://github.com/mxxii/parseley/blob/main/test/snapshots/snapshots.ts.md}{\texttt{ Snapshots}}
\end{DoxyItemize}\hypertarget{README.md_autotoc_md25655}{}\doxysubsection{\texorpdfstring{Input reference}{Input reference}}\label{README.md_autotoc_md25655}
\href{https://www.w3.org/TR/selectors-4/\#grammar}{\texttt{ https\+://www.\+w3.\+org/\+TR/selectors-\/4/\#grammar}}

\href{https://www.w3.org/TR/css-syntax-3/\#token-diagrams}{\texttt{ https\+://www.\+w3.\+org/\+TR/css-\/syntax-\/3/\#token-\/diagrams}}

Terminology used in this project is more or less consistent to the spec, with some exceptions made for clarity. The term "{}type"{} is way too overloaded in particular, the term "{}tag"{} is used where appropriate instead.

Any pseudo elements are left for possible future implementation. I have no immediate need for them and they require some careful consideration.\hypertarget{README.md_autotoc_md25656}{}\doxysubsection{\texorpdfstring{Output AST}{Output AST}}\label{README.md_autotoc_md25656}
Consistency\+: overall AST shape is always the same. This makes client code simpler, at least for a certain processing tasks.

For example, always use compound selectors, even when there is only one simple selector inside.

Comma-\/separated selectors might not be needed for every use case. So there are two functions -\/ one can parse commas and always returns the top-\/level list regardless of the comma presence in a particular selector, and the other can\textquotesingle{}t parse commas and returns a compound selector AST directly.

Complex selectors are represented in the way that makes the left side to be an another condition on the right side element. This was made with the right-\/to-\/left processing direction in mind. One consequence of this is that there is no such thing as a "{}complex selector"{} node in the AST hierarchy, but there are "{}combinator"{} nodes attached to "{}compound selector"{} nodes.

All AST nodes have their specificity computed (except the top-\/level list of comma-\/separated selectors where it doesn\textquotesingle{}t really make sense).\hypertarget{README.md_autotoc_md25657}{}\doxysubsection{\texorpdfstring{Motivation and inspiration}{Motivation and inspiration}}\label{README.md_autotoc_md25657}
\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Package   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Hits   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Misses    }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Package   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Hits   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Misses    }\\\cline{1-3}
\endhead
\href{https://github.com/leaverou/parsel}{\texttt{ parsel}}   &Sensible AST; specificity calculation; cool name   &Not friendly to node.\+js; based on regex    \\\cline{1-3}
\href{https://github.com/fb55/css-what}{\texttt{ css-\/what}} and \href{https://github.com/fb55/css-select}{\texttt{ css-\/select}}   &The idea to process complex selectors in right-\/to-\/left order   &{\ttfamily css-\/select} is a solution for a different problem compared to what I needed; {\ttfamily css-\/what} produces only a list of tokens    \\\cline{1-3}
\href{https://github.com/gajus/scalpel}{\texttt{ scalpel}}   &Introduced me to \href{https://nearley.js.org/}{\texttt{ nearley}} parsing toolkit (albeit I\textquotesingle{}m not using it here anymore)   &AST it produces is very far from what I can use    \\\cline{1-3}
\href{https://github.com/mdevils/css-selector-parser}{\texttt{ css-\/selector-\/parser}}   &Configurable and lightweight   &Again, AST is far from my needs   \\\cline{1-3}
\end{longtabu}
