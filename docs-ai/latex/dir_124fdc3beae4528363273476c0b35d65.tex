\doxysection{node\+\_\+modules/node-\/fetch-\/native Directory Reference}
\hypertarget{dir_124fdc3beae4528363273476c0b35d65}{}\label{dir_124fdc3beae4528363273476c0b35d65}\index{node\_modules/node-\/fetch-\/native Directory Reference@{node\_modules/node-\/fetch-\/native Directory Reference}}


\doxysubsection{Detailed Description}
\href{https://npmjs.com/package/node-fetch-native}{\texttt{ }} \href{https://github.com/unjs/node-fetch-native/actions?query=workflow\%3Aci}{\texttt{ }} \href{https://packagephobia.com/result?p=node-fetch-native}{\texttt{ }} \href{https://npmjs.com/package/node-fetch-native}{\texttt{ }}

A redistribution of \href{https://github.com/node-fetch/node-fetch}{\texttt{ node-\/fetch v3}} (+ more!) for better backward and forward compatibility.

{\bfseries{Why this package?}}


\begin{DoxyItemize}
\item We can no longer `require(\textquotesingle{}node-\/fetch'){\ttfamily with the latest version. This stopped popular libraries from upgrading and dependency conflicts between}node-\/fetch@2{\ttfamily and}node-\/fetch@3{\ttfamily .}
\item {\ttfamily With upcoming versions of Node.\+js, native}fetch\`{} is being supported. We are prepared for native fetch support using this package yet keep supporting older Node versions.
\item With the introduction of native fetch to Node.\+js via \href{https://github.com/nodejs/undici}{\texttt{ undici}} there is no easy way to support http proxies!
\end{DoxyItemize}

{\bfseries{Features\+:}}

✅ Prefer to {\bfseries{native globals}} when available (See Node.\+js \href{https://nodejs.org/dist/latest-v17.x/docs/api/cli.html\#--experimental-fetch}{\texttt{ experimental fetch}}).

✅ Compact build and less install size with {\bfseries{zero dependencies}} \href{https://packagephobia.com/result?p=node-fetch-native}{\texttt{ }} \textsuperscript{vs} \href{https://packagephobia.com/result?p=node-fetch}{\texttt{ }}

✅ Support both {\bfseries{Common\+JS}} ({\ttfamily require}) and {\bfseries{ESM}} ({\ttfamily import}) usage

✅ Use native version if imported without {\ttfamily node} condition using \href{https://nodejs.org/api/packages.html\#packages_conditional_exports}{\texttt{ conditional exports}} with {\bfseries{zero bundle overhead}}

✅ Polyfill support for Node.\+js

✅ Compact and simple proxy supporting both Node.\+js versions without native fetch using \href{https://github.com/TooTallNate/proxy-agents/tree/main/packages/proxy-agent}{\texttt{ HTTP Agent}} and versions with native fetch using \href{https://undici.nodejs.org/\#/docs/api/ProxyAgent}{\texttt{ Undici Proxy Agent}}\hypertarget{README.md_autotoc_md24574}{}\doxysubsection{\texorpdfstring{Usage}{Usage}}\label{README.md_autotoc_md24574}
Install {\ttfamily node-\/fetch-\/native} dependency\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\#\ npm}
\DoxyCodeLine{npm\ i\ node-\/fetch-\/native}
\DoxyCodeLine{}
\DoxyCodeLine{\#\ yarn}
\DoxyCodeLine{yarn\ add\ node-\/fetch-\/native}
\DoxyCodeLine{}
\DoxyCodeLine{\#\ pnpm}
\DoxyCodeLine{pnpm\ i\ node-\/fetch-\/native}

\end{DoxyCode}


You can now either import or require the dependency\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ ESM}
\DoxyCodeLine{import\ fetch\ from\ "{}node-\/fetch-\/native"{};}
\DoxyCodeLine{}
\DoxyCodeLine{//\ CommonJS}
\DoxyCodeLine{const\ fetch\ =\ require("{}node-\/fetch-\/native"{});}

\end{DoxyCode}


More named exports\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ ESM}
\DoxyCodeLine{import\ \{}
\DoxyCodeLine{\ \ fetch,}
\DoxyCodeLine{\ \ Blob,}
\DoxyCodeLine{\ \ FormData,}
\DoxyCodeLine{\ \ Headers,}
\DoxyCodeLine{\ \ Request,}
\DoxyCodeLine{\ \ Response,}
\DoxyCodeLine{\ \ AbortController,}
\DoxyCodeLine{\}\ from\ "{}node-\/fetch-\/native"{};}
\DoxyCodeLine{}
\DoxyCodeLine{//\ CommonJS}
\DoxyCodeLine{const\ \{}
\DoxyCodeLine{\ \ fetch,}
\DoxyCodeLine{\ \ Blob,}
\DoxyCodeLine{\ \ FormData,}
\DoxyCodeLine{\ \ Headers,}
\DoxyCodeLine{\ \ Request,}
\DoxyCodeLine{\ \ Response,}
\DoxyCodeLine{\ \ AbortController,}
\DoxyCodeLine{\}\ =\ require("{}node-\/fetch-\/native"{});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md24575}{}\doxysubsection{\texorpdfstring{Force using non-\/native version}{Force using non-\/native version}}\label{README.md_autotoc_md24575}
Sometimes you want to explicitly use none native ({\ttfamily node-\/fetch}) implementation of {\ttfamily fetch} in case of issues with the native/polyfill version of {\ttfamily global\+This.\+fetch} with Node.\+js or runtime environment.

You have two ways to do this\+:


\begin{DoxyItemize}
\item Set the {\ttfamily FORCE\+\_\+\+NODE\+\_\+\+FETCH} environment variable before starting the application.
\item Import from {\ttfamily node-\/fetch-\/native/node}
\end{DoxyItemize}\hypertarget{README.md_autotoc_md24576}{}\doxysubsection{\texorpdfstring{Disable runtime check}{Disable runtime check}}\label{README.md_autotoc_md24576}
Once the {\ttfamily node-\/fetch-\/native/node} module is loaded, it pushes a log warning if the current runtime differs from the Node.\+js. Set the {\ttfamily DISABLE\+\_\+\+NODE\+\_\+\+FETCH\+\_\+\+NATIVE\+\_\+\+WARN} environment variable to turn this check off.\hypertarget{README.md_autotoc_md24577}{}\doxysubsection{\texorpdfstring{Polyfill support}{Polyfill support}}\label{README.md_autotoc_md24577}
Using the polyfill method, we can ensure global fetch is available in the environment and all files. Natives are always preferred.

{\bfseries{Note\+:}} I don\textquotesingle{}t recommend this if you are authoring a library! Please prefer the explicit methods.


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ ESM}
\DoxyCodeLine{import\ "{}node-\/fetch-\/native/polyfill"{};}
\DoxyCodeLine{}
\DoxyCodeLine{//\ CJS}
\DoxyCodeLine{require("{}node-\/fetch-\/native/polyfill"{});}
\DoxyCodeLine{}
\DoxyCodeLine{//\ You\ can\ now\ use\ fetch()\ without\ any\ import!}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md24578}{}\doxysubsection{\texorpdfstring{Proxy Support}{Proxy Support}}\label{README.md_autotoc_md24578}
Node.\+js has no built-\/in support for HTTP Proxies for fetch (see \href{https://github.com/nodejs/undici/issues/1650}{\texttt{ nodejs/undici\#1650}} and \href{https://github.com/nodejs/node/issues/8381}{\texttt{ nodejs/node\#8381}})

This package bundles a compact and simple proxy-\/supported solution for both Node.\+js versions without native fetch using \href{https://github.com/TooTallNate/proxy-agents/tree/main/packages/proxy-agent}{\texttt{ HTTP Agent}} and versions with native fetch using \href{https://undici.nodejs.org/\#/docs/api/ProxyAgent}{\texttt{ Undici Proxy Agent}}.

By default, {\ttfamily https\+\_\+proxy}, {\ttfamily http\+\_\+proxy}, {\ttfamily HTTPS\+\_\+\+PROXY}, and {\ttfamily HTTP\+\_\+\+PROXY} environment variables will be checked and used (in order) for the proxy and if not any of them are set, the proxy will be disabled. You can override it using the {\ttfamily url} option passed to {\ttfamily create\+Fetch} and {\ttfamily create\+Proxy} utils.

By default, {\ttfamily no\+\_\+proxy} and {\ttfamily NO\+\_\+\+PROXY} environment variables will be checked and used for the (comma-\/separated) list of hosts to ignore the proxy for. You can override it using the {\ttfamily no\+Proxy} option passed to {\ttfamily create\+Fetch} and {\ttfamily create\+Proxy} utils. The entries starting with a dot will be used to check the domain and also any subdomain.

\begin{DoxyNote}{Note}
Using export conditions, this utility adds proxy support for Node.\+js and for other runtimes, it will simply return native fetch.
\end{DoxyNote}
\hypertarget{README.md_autotoc_md24579}{}\doxysubsubsection{\texorpdfstring{{\ttfamily fetch} with proxy support}{{\ttfamily fetch} with proxy support}}\label{README.md_autotoc_md24579}
You can simply import {\ttfamily \{ fetch \}} from {\ttfamily node-\/fetch-\/native/proxy} with a preconfigured {\ttfamily fetch} function that has proxy support.


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ fetch\ \}\ from\ "{}node-\/fetch-\/native/proxy"{};}
\DoxyCodeLine{}
\DoxyCodeLine{console.log(await\ fetch("{}https://icanhazip.com"{}).then((r)\ =>\ r.text()));}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md24580}{}\doxysubsubsection{\texorpdfstring{{\ttfamily create\+Fetch} utility}{{\ttfamily create\+Fetch} utility}}\label{README.md_autotoc_md24580}
You can use the {\ttfamily create\+Fetch} utility to instantiate a {\ttfamily fetch} instance with custom proxy options.


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ createFetch\ \}\ from\ "{}node-\/fetch-\/native/proxy"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ fetch\ =\ createFetch(\{\ url:\ "{}http://localhost:9080"{}\ \});}
\DoxyCodeLine{}
\DoxyCodeLine{console.log(await\ fetch("{}https://icanhazip.com"{}).then((r)\ =>\ r.text()));}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md24581}{}\doxysubsubsection{\texorpdfstring{{\ttfamily create\+Proxy} utility}{{\ttfamily create\+Proxy} utility}}\label{README.md_autotoc_md24581}
{\ttfamily create\+Proxy} returns an object with {\ttfamily agent} and {\ttfamily dispatcher} keys that can be passed as fetch options.


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ fetch\ \}\ from\ "{}node-\/fetch-\/native"{};}
\DoxyCodeLine{import\ \{\ createProxy\ \}\ from\ "{}node-\/fetch-\/native/proxy"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ proxy\ =\ createProxy();}
\DoxyCodeLine{//\ const\ proxy\ =\ createProxy(\{\ url:\ "{}http://localhost:8080"{}\ \});}
\DoxyCodeLine{}
\DoxyCodeLine{console.log(}
\DoxyCodeLine{\ \ await\ fetch("{}https://icanhazip.com"{},\ \{\ ...proxy\ \}).then((r)\ =>\ r.text()),}
\DoxyCodeLine{);}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md24582}{}\doxysubsection{\texorpdfstring{Alias to {\ttfamily node-\/fetch}}{Alias to {\ttfamily node-\/fetch}}}\label{README.md_autotoc_md24582}
Using this method, you can ensure all project dependencies and usages of {\ttfamily node-\/fetch} can benefit from improved {\ttfamily node-\/fetch-\/native} and won\textquotesingle{}t conflict between {\ttfamily node-\/fetch@2} and {\ttfamily node-\/fetch@3}.\hypertarget{README.md_autotoc_md24583}{}\doxysubsubsection{\texorpdfstring{npm}{npm}}\label{README.md_autotoc_md24583}
Using npm \href{https://docs.npmjs.com/cli/v8/configuring-npm/package-json\#overrides}{\texttt{ overrides}}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ package.json}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}overrides"{}:\ \{}
\DoxyCodeLine{\ \ \ \ "{}node-\/fetch"{}:\ "{}npm:node-\/fetch-\/native@latest"{},}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md24584}{}\doxysubsubsection{\texorpdfstring{yarn}{yarn}}\label{README.md_autotoc_md24584}
Using yarn \href{https://classic.yarnpkg.com/lang/en/docs/selective-version-resolutions/}{\texttt{ selective dependency resolutions}}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ package.json}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}resolutions"{}:\ \{}
\DoxyCodeLine{\ \ \ \ "{}node-\/fetch"{}:\ "{}npm:node-\/fetch-\/native@latest"{},}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md24585}{}\doxysubsubsection{\texorpdfstring{pnpm}{pnpm}}\label{README.md_autotoc_md24585}
Using \href{https://pnpm.io/package_json\#pnpmoverrides}{\texttt{ pnpm.\+overrides}}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ package.json}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}pnpm"{}:\ \{}
\DoxyCodeLine{\ \ \ \ "{}overrides"{}:\ \{}
\DoxyCodeLine{\ \ \ \ \ \ "{}node-\/fetch"{}:\ "{}npm:node-\/fetch-\/native@latest"{},}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md24586}{}\doxysubsection{\texorpdfstring{License}{License}}\label{README.md_autotoc_md24586}
Made with 💛 Published under the \href{./LICENSE}{\texttt{ MIT}} license. 