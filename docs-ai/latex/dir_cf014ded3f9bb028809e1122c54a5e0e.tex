\doxysection{node\+\_\+modules/lint-\/staged Directory Reference}
\hypertarget{dir_cf014ded3f9bb028809e1122c54a5e0e}{}\label{dir_cf014ded3f9bb028809e1122c54a5e0e}\index{node\_modules/lint-\/staged Directory Reference@{node\_modules/lint-\/staged Directory Reference}}
\doxysubsubsection*{Directories}
\begin{DoxyCompactItemize}
\item 
directory \mbox{\hyperlink{dir_0b3ba90a23adfb726c9c5c3f0f858296}{node\+\_\+modules}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\href{https://badge.fury.io/js/lint-staged}{\texttt{ }}

\DoxyHorRuler{0}


Run tasks like formatters and linters against staged git files and don\textquotesingle{}t let \+:poop\+: slip into your code base!


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ install\ -\/-\/save-\/dev\ lint-\/staged\ \#\ requires\ further\ setup}

\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{\$\ git\ commit}
\DoxyCodeLine{}
\DoxyCodeLine{✔\ Backed\ up\ original\ state\ in\ git\ stash\ (5bda95f)}
\DoxyCodeLine{❯\ Running\ tasks\ for\ staged\ files...}
\DoxyCodeLine{\ \ ❯\ packages/frontend/.lintstagedrc.json\ —\ 1\ file}
\DoxyCodeLine{\ \ \ \ ↓\ *.js\ —\ no\ files\ [SKIPPED]}
\DoxyCodeLine{\ \ \ \ ❯\ *.\{json,md\}\ —\ 1\ file}
\DoxyCodeLine{\ \ \ \ \ \ ⠹\ prettier\ -\/-\/write}
\DoxyCodeLine{\ \ ↓\ packages/backend/.lintstagedrc.json\ —\ 2\ files}
\DoxyCodeLine{\ \ \ \ ❯\ *.js\ —\ 2\ files}
\DoxyCodeLine{\ \ \ \ \ \ ⠼\ eslint\ -\/-\/fix}
\DoxyCodeLine{\ \ \ \ ↓\ *.\{json,md\}\ —\ no\ files\ [SKIPPED]}
\DoxyCodeLine{◼\ Applying\ modifications\ from\ tasks...}
\DoxyCodeLine{◼\ Cleaning\ up\ temporary\ files...}

\end{DoxyCode}




{\bfseries{See asciinema video}}\begin{adjustwidth}{1em}{0em}


\href{https://asciinema.org/a/199934}{\texttt{ }}

\end{adjustwidth}
\hypertarget{README.md_autotoc_md21803}{}\doxysubsection{\texorpdfstring{Why}{Why}}\label{README.md_autotoc_md21803}
Code quality tasks like formatters and linters make more sense when run before committing your code. By doing so you can ensure no errors go into the repository and enforce code style. But running a task on a whole project can be slow, and opinionated tasks such as linting can sometimes produce irrelevant results. Ultimately you only want to check files that will be committed.

This project contains a script that will run arbitrary shell tasks with a list of staged files as an argument, filtered by a specified glob pattern.\hypertarget{README.md_autotoc_md21804}{}\doxysubsection{\texorpdfstring{Related blog posts and talks}{Related blog posts and talks}}\label{README.md_autotoc_md21804}

\begin{DoxyItemize}
\item \href{https://medium.com/@okonetchnikov/make-linting-great-again-f3890e1ad6b8\#.8qepn2b5l}{\texttt{ Introductory Medium post -\/ Andrey Okonetchnikov, 2016}}
\item \href{https://benmccormick.org/2017/02/26/running-jest-tests-before-each-git-commit/}{\texttt{ Running Jest Tests Before Each Git Commit -\/ Ben Mc\+Cormick, 2017}}
\item \href{https://www.youtube.com/watch?v=-mhY7e-EsC4}{\texttt{ Agent\+Conf presentation -\/ Andrey Okonetchnikov, 2018}}
\item \href{https://survivejs.com/blog/lint-staged-interview/}{\texttt{ Survive\+JS interview -\/ Juho Vepsäläinen and Andrey Okonetchnikov, 2018}}
\item \href{https://johnnyreilly.com/2020/12/22/prettier-your-csharp-with-dotnet-format-and-lint-staged}{\texttt{ Prettier your CSharp with {\ttfamily dotnet-\/format} and {\ttfamily lint-\/staged}}}
\end{DoxyItemize}

\begin{quote}
If you\textquotesingle{}ve written one, please submit a PR with the link to it! \end{quote}
\hypertarget{README.md_autotoc_md21805}{}\doxysubsection{\texorpdfstring{Installation and setup}{Installation and setup}}\label{README.md_autotoc_md21805}
To install {\itshape lint-\/staged} in the recommended way, you need to\+:


\begin{DoxyEnumerate}
\item Install {\itshape lint-\/staged} itself\+:
\begin{DoxyItemize}
\item {\ttfamily npm install -\/-\/save-\/dev lint-\/staged}
\end{DoxyItemize}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item Set up the {\ttfamily pre-\/commit} git hook to run {\itshape lint-\/staged}
\begin{DoxyItemize}
\item \href{https://github.com/typicode/husky}{\texttt{ Husky}} is a popular choice for configuring git hooks
\item Read more about git hooks \href{https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks}{\texttt{ here}}
\end{DoxyItemize}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item Install some tools like \href{https://eslint.org}{\texttt{ ESLint}} or \href{https://prettier.io}{\texttt{ Prettier}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item Configure {\itshape lint-\/staged} to run code checkers and other tasks\+:
\begin{DoxyItemize}
\item for example\+: {\ttfamily \{ "{}\texorpdfstring{$\ast$}{*}.\+js"{}\+: "{}eslint"{} \}} to run ESLint for all staged JS files
\item See \doxylink{README.md_configuration}{Configuration} for more info
\end{DoxyItemize}
\end{DoxyEnumerate}

Don\textquotesingle{}t forget to commit changes to {\ttfamily package.\+json} and {\ttfamily .husky} to share this setup with your team!

Now change a few files, {\ttfamily git add} or {\ttfamily git add -\/-\/patch} some of them to your commit, and try to {\ttfamily git commit} them.

See \doxylink{README.md_examples}{examples} and \doxylink{README.md_configuration}{configuration} for more information.

\begin{DoxyAttention}{Attention}
{\itshape Lint-\/staged} runs {\ttfamily git} operations affecting the files in your repository. By default {\itshape lint-\/staged} creates a {\ttfamily git stash} as a backup of the original state before running any configured tasks to help prevent data loss.
\end{DoxyAttention}
\hypertarget{README.md_autotoc_md21806}{}\doxysubsection{\texorpdfstring{Changelog}{Changelog}}\label{README.md_autotoc_md21806}
See \href{https://github.com/okonet/lint-staged/releases}{\texttt{ Releases}}.\hypertarget{README.md_autotoc_md21807}{}\doxysubsubsection{\texorpdfstring{Migration}{Migration}}\label{README.md_autotoc_md21807}
\hypertarget{README.md_autotoc_md21808}{}\doxysubsubsubsection{\texorpdfstring{v15}{v15}}\label{README.md_autotoc_md21808}

\begin{DoxyItemize}
\item Since {\ttfamily v15.\+0.\+0} {\itshape lint-\/staged} no longer supports Node.\+js 16. Please upgrade your Node.\+js version to at least {\ttfamily 18.\+12.\+0}.
\end{DoxyItemize}\hypertarget{README.md_autotoc_md21809}{}\doxysubsubsubsection{\texorpdfstring{v14}{v14}}\label{README.md_autotoc_md21809}

\begin{DoxyItemize}
\item Since {\ttfamily v14.\+0.\+0} {\itshape lint-\/staged} no longer supports Node.\+js 14. Please upgrade your Node.\+js version to at least {\ttfamily 16.\+14.\+0}.
\end{DoxyItemize}\hypertarget{README.md_autotoc_md21810}{}\doxysubsubsubsection{\texorpdfstring{v13}{v13}}\label{README.md_autotoc_md21810}

\begin{DoxyItemize}
\item Since {\ttfamily v13.\+0.\+0} {\itshape lint-\/staged} no longer supports Node.\+js 12. Please upgrade your Node.\+js version to at least {\ttfamily 14.\+13.\+1}, or {\ttfamily 16.\+0.\+0} onward.
\item Version {\ttfamily v13.\+3.\+0} was incorrectly released including code of version {\ttfamily v14.\+0.\+0}. This means the breaking changes of {\ttfamily v14} are also included in {\ttfamily v13.\+3.\+0}, the last {\ttfamily v13} version released
\end{DoxyItemize}\hypertarget{README.md_autotoc_md21811}{}\doxysubsubsubsection{\texorpdfstring{v12}{v12}}\label{README.md_autotoc_md21811}

\begin{DoxyItemize}
\item Since {\ttfamily v12.\+0.\+0} {\itshape lint-\/staged} is a pure ESM module, so make sure your Node.\+js version is at least {\ttfamily 12.\+20.\+0}, {\ttfamily 14.\+13.\+1}, or {\ttfamily 16.\+0.\+0}. Read more about ESM modules from the official \href{https://nodejs.org/api/esm.html\#introduction}{\texttt{ Node.\+js Documentation site here}}.
\end{DoxyItemize}\hypertarget{README.md_autotoc_md21812}{}\doxysubsubsubsection{\texorpdfstring{v10}{v10}}\label{README.md_autotoc_md21812}

\begin{DoxyItemize}
\item From {\ttfamily v10.\+0.\+0} onwards any new modifications to originally staged files will be automatically added to the commit. If your task previously contained a {\ttfamily git add} step, please remove this. The automatic behaviour ensures there are less race-\/conditions, since trying to run multiple git operations at the same time usually results in an error.
\item From {\ttfamily v10.\+0.\+0} onwards, lint-\/staged uses git stashes to improve speed and provide backups while running. Since git stashes require at least an initial commit, you shouldn\textquotesingle{}t run lint-\/staged in an empty repo.
\item From {\ttfamily v10.\+0.\+0} onwards, lint-\/staged requires Node.\+js version 10.\+13.\+0 or later.
\item From {\ttfamily v10.\+0.\+0} onwards, lint-\/staged will abort the commit if linter tasks undo all staged changes. To allow creating an empty commit, please use the {\ttfamily -\/-\/allow-\/empty} option.
\end{DoxyItemize}\hypertarget{README.md_autotoc_md21813}{}\doxysubsection{\texorpdfstring{Command line flags}{Command line flags}}\label{README.md_autotoc_md21813}

\begin{DoxyCode}{0}
\DoxyCodeLine{❯\ npx\ lint-\/staged\ -\/-\/help}
\DoxyCodeLine{Usage:\ lint-\/staged\ [options]}
\DoxyCodeLine{}
\DoxyCodeLine{Options:}
\DoxyCodeLine{\ \ -\/V,\ -\/-\/version\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ output\ the\ version\ number}
\DoxyCodeLine{\ \ -\/-\/allow-\/empty\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ allow\ empty\ commits\ when\ tasks\ revert\ all\ staged\ changes\ (default:\ false)}
\DoxyCodeLine{\ \ -\/p,\ -\/-\/concurrent\ <number|boolean>\ \ the\ number\ of\ tasks\ to\ run\ concurrently,\ or\ false\ for\ serial\ (default:\ true)}
\DoxyCodeLine{\ \ -\/c,\ -\/-\/config\ [path]\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ path\ to\ configuration\ file,\ or\ -\/\ to\ read\ from\ stdin}
\DoxyCodeLine{\ \ -\/-\/cwd\ [path]\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ run\ all\ tasks\ in\ specific\ directory,\ instead\ of\ the\ current}
\DoxyCodeLine{\ \ -\/d,\ -\/-\/debug\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print\ additional\ debug\ information\ (default:\ false)}
\DoxyCodeLine{\ \ -\/-\/diff\ [string]\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ override\ the\ default\ "{}-\/-\/staged"{}\ flag\ of\ "{}git\ diff"{}\ to\ get\ list\ of\ files.}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Implies\ "{}-\/-\/no-\/stash"{}.}
\DoxyCodeLine{\ \ -\/-\/diff-\/filter\ [string]\ \ \ \ \ \ \ \ \ \ \ \ \ override\ the\ default\ "{}-\/-\/diff-\/filter=ACMR"{}\ flag\ of\ "{}git\ diff"{}\ to\ get\ list\ of}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ files}
\DoxyCodeLine{\ \ -\/-\/max-\/arg-\/length\ [number]\ \ \ \ \ \ \ \ \ \ maximum\ length\ of\ the\ command-\/line\ argument\ string\ (default:\ 0)}
\DoxyCodeLine{\ \ -\/-\/no-\/stash\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disable\ the\ backup\ stash,\ and\ do\ not\ revert\ in\ case\ of\ errors.\ Implies}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}-\/-\/no-\/hide-\/partially-\/staged"{}.}
\DoxyCodeLine{\ \ -\/-\/no-\/hide-\/partially-\/staged\ \ \ \ \ \ \ \ \ disable\ hiding\ unstaged\ changes\ from\ partially\ staged\ files}
\DoxyCodeLine{\ \ -\/q,\ -\/-\/quiet\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disable\ lint-\/staged’s\ own\ console\ output\ (default:\ false)}
\DoxyCodeLine{\ \ -\/r,\ -\/-\/relative\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pass\ relative\ filepaths\ to\ tasks\ (default:\ false)}
\DoxyCodeLine{\ \ -\/x,\ -\/-\/shell\ [path]\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ skip\ parsing\ of\ tasks\ for\ better\ shell\ support\ (default:\ false)}
\DoxyCodeLine{\ \ -\/v,\ -\/-\/verbose\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ show\ task\ output\ even\ when\ tasks\ succeed;\ by\ default\ only\ failed\ output\ is}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shown\ (default:\ false)}
\DoxyCodeLine{\ \ -\/h,\ -\/-\/help\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ display\ help\ for\ command}
\DoxyCodeLine{}
\DoxyCodeLine{Any\ lost\ modifications\ can\ be\ restored\ from\ a\ git\ stash:}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ >\ git\ stash\ list}
\DoxyCodeLine{\ \ stash@\{0\}:\ automatic\ lint-\/staged\ backup}
\DoxyCodeLine{\ \ >\ git\ stash\ apply\ -\/-\/index\ stash@\{0\}}

\end{DoxyCode}



\begin{DoxyItemize}
\item {\bfseries{{\ttfamily -\/-\/allow-\/empty}}}\+: By default, when tasks undo all staged changes, lint-\/staged will exit with an error and abort the commit. Use this flag to allow creating empty git commits.
\item {\bfseries{{\ttfamily -\/-\/concurrent \mbox{[}number\texorpdfstring{$\vert$}{|}boolean\mbox{]}}}}\+: Controls the concurrency of tasks being run by lint-\/staged. {\bfseries{NOTE}}\+: This does NOT affect the concurrency of subtasks (they will always be run sequentially). Possible values are\+:
\begin{DoxyItemize}
\item {\ttfamily false}\+: Run all tasks serially
\item {\ttfamily true} (default) \+: {\itshape Infinite} concurrency. Runs as many tasks in parallel as possible.
\item {\ttfamily \{number\}}\+: Run the specified number of tasks in parallel, where {\ttfamily 1} is equivalent to {\ttfamily false}.
\end{DoxyItemize}
\item {\bfseries{{\ttfamily -\/-\/config \mbox{[}path\mbox{]}}}}\+: Manually specify a path to a config file or npm package name. Note\+: when used, lint-\/staged won\textquotesingle{}t perform the config file search and will print an error if the specified file cannot be found. If \textquotesingle{}-\/\textquotesingle{} is provided as the filename then the config will be read from stdin, allowing piping in the config like {\ttfamily cat my-\/config.\+json \texorpdfstring{$\vert$}{|} npx lint-\/staged -\/-\/config -\/}.
\item {\bfseries{{\ttfamily -\/-\/cwd \mbox{[}path\mbox{]}}}}\+: By default tasks run in the current working directory. Use the {\ttfamily -\/-\/cwd some/directory} to override this. The path can be absolute or relative to the current working directory.
\item {\bfseries{{\ttfamily -\/-\/debug}}}\+: Run in debug mode. When set, it does the following\+:
\begin{DoxyItemize}
\item uses \href{https://github.com/visionmedia/debug}{\texttt{ debug}} internally to log additional information about staged files, commands being executed, location of binaries, etc. Debug logs, which are automatically enabled by passing the flag, can also be enabled by setting the environment variable {\ttfamily \$DEBUG} to {\ttfamily lint-\/staged\texorpdfstring{$\ast$}{*}}.
\item uses \href{https://listr2.kilic.dev/renderers/verbose-renderer/}{\texttt{ {\ttfamily verbose} renderer}} for {\ttfamily listr2}; this causes serial, uncoloured output to the terminal, instead of the default (beautified, dynamic) output. (the \href{https://listr2.kilic.dev/renderers/verbose-renderer/}{\texttt{ {\ttfamily verbose} renderer}} can also be activated by setting the {\ttfamily TERM=dumb} or {\ttfamily NODE\+\_\+\+ENV=test} environment variables)
\end{DoxyItemize}
\item {\bfseries{{\ttfamily -\/-\/diff}}}\+: By default tasks are filtered against all files staged in git, generated from {\ttfamily git diff -\/-\/staged}. This option allows you to override the {\ttfamily -\/-\/staged} flag with arbitrary revisions. For example to get a list of changed files between two branches, use {\ttfamily -\/-\/diff="{}branch1...\+branch2"{}}. You can also read more from about \href{https://git-scm.com/docs/git-diff}{\texttt{ git diff}} and \href{https://git-scm.com/docs/gitrevisions}{\texttt{ gitrevisions}}. This option also implies {\ttfamily -\/-\/no-\/stash}.
\item {\bfseries{{\ttfamily -\/-\/diff-\/filter}}}\+: By default only files that are {\itshape added}, {\itshape copied}, {\itshape modified}, or {\itshape renamed} are included. Use this flag to override the default {\ttfamily ACMR} value with something else\+: {\itshape added} ({\ttfamily A}), {\itshape copied} ({\ttfamily C}), {\itshape deleted} ({\ttfamily D}), {\itshape modified} ({\ttfamily M}), {\itshape renamed} ({\ttfamily R}), {\itshape type changed} ({\ttfamily T}), {\itshape unmerged} ({\ttfamily U}), {\itshape unknown} ({\ttfamily X}), or {\itshape pairing broken} ({\ttfamily B}). See also the {\ttfamily git diff} docs for \href{https://git-scm.com/docs/git-diff\#Documentation/git-diff.txt---diff-filterACDMRTUXB82308203}{\texttt{ --diff-\/filter}}.
\item {\bfseries{{\ttfamily -\/-\/max-\/arg-\/length}}}\+: long commands (a lot of files) are automatically split into multiple chunks when it detects the current shell cannot handle them. Use this flag to override the maximum length of the generated command string.
\item {\bfseries{{\ttfamily -\/-\/no-\/stash}}}\+: By default a backup stash will be created before running the tasks, and all task modifications will be reverted in case of an error. This option will disable creating the stash, and instead leave all modifications in the index when aborting the commit. Can be re-\/enabled with {\ttfamily -\/-\/stash}. This option also implies {\ttfamily -\/-\/no-\/hide-\/partially-\/staged}.
\item {\bfseries{{\ttfamily -\/-\/no-\/hide-\/partially-\/staged}}}\+: By default, unstaged changes from partially staged files will be hidden. This option will disable this behavior and include all unstaged changes in partially staged files. Can be re-\/enabled with {\ttfamily -\/-\/hide-\/partially-\/staged}
\item {\bfseries{{\ttfamily -\/-\/quiet}}}\+: Supress all CLI output, except from tasks.
\item {\bfseries{{\ttfamily -\/-\/relative}}}\+: Pass filepaths relative to {\ttfamily process.\+cwd()} (where {\ttfamily lint-\/staged} runs) to tasks. Default is {\ttfamily false}.
\item {\bfseries{{\ttfamily -\/-\/shell}}}\+: By default task commands will be parsed for speed and security. This has the side-\/effect that regular shell scripts might not work as expected. You can skip parsing of commands with this option. To use a specific shell, use a path like {\ttfamily -\/-\/shell "{}/bin/bash"{}}.
\item {\bfseries{{\ttfamily -\/-\/verbose}}}\+: Show task output even when tasks succeed. By default only failed output is shown.
\end{DoxyItemize}\hypertarget{README.md_autotoc_md21814}{}\doxysubsection{\texorpdfstring{Configuration}{Configuration}}\label{README.md_autotoc_md21814}
{\itshape Lint-\/staged} can be configured in many ways\+:


\begin{DoxyItemize}
\item {\ttfamily lint-\/staged} object in your {\ttfamily package.\+json}, or \href{https://github.com/pnpm/pnpm/pull/1799}{\texttt{ {\ttfamily package.\+yaml}}}
\item {\ttfamily .lintstagedrc} file in JSON or YML format, or you can be explicit with the file extension\+:
\begin{DoxyItemize}
\item {\ttfamily .lintstagedrc.\+json}
\item {\ttfamily .lintstagedrc.\+yaml}
\item {\ttfamily .lintstagedrc.\+yml}
\end{DoxyItemize}
\item {\ttfamily .lintstagedrc.\+mjs} or {\ttfamily lint-\/staged.\+config.\+mjs} file in ESM format
\begin{DoxyItemize}
\item the default export value should be a configuration\+: {\ttfamily export default \{ ... \}}
\end{DoxyItemize}
\item {\ttfamily .lintstagedrc.\+cjs} or {\ttfamily lint-\/staged.\+config.\+cjs} file in Common\+JS format
\begin{DoxyItemize}
\item the exports value should be a configuration\+: {\ttfamily module.\+exports = \{ ... \}}
\end{DoxyItemize}
\item {\ttfamily lint-\/staged.\+config.\+js} or {\ttfamily .lintstagedrc.\+js} in either ESM or Common\+JS format, depending on whether your project\textquotesingle{}s {\itshape package.\+json} contains the {\ttfamily "{}type"{}\+: "{}module"{}} option or not.
\item Pass a configuration file using the {\ttfamily -\/-\/config} or {\ttfamily -\/c} flag
\end{DoxyItemize}

Configuration should be an object where each value is a command to run and its key is a glob pattern to use for this command. This package uses \href{https://github.com/micromatch/micromatch}{\texttt{ micromatch}} for glob patterns. Java\+Script files can also export advanced configuration as a function. See Using JS configuration files for more info.

You can also place multiple configuration files in different directories inside a project. For a given staged file, the closest configuration file will always be used. See "{}How to use \`{}lint-\/staged\`{} in a multi-\/package monorepo?"{} for more info and an example.\hypertarget{README.md_autotoc_md21815}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily package.\+json} example\+:}{{\ttfamily package.\+json} example\+:}}\label{README.md_autotoc_md21815}

\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}lint-\/staged"{}:\ \{}
\DoxyCodeLine{\ \ \ \ "{}*"{}:\ "{}your-\/cmd"{}}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md21816}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily .lintstagedrc} example}{{\ttfamily .lintstagedrc} example}}\label{README.md_autotoc_md21816}

\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*"{}:\ "{}your-\/cmd"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


This config will execute {\ttfamily your-\/cmd} with the list of currently staged files passed as arguments.

So, considering you did {\ttfamily git add file1.\+ext file2.\+ext}, lint-\/staged will run the following command\+:

{\ttfamily your-\/cmd file1.\+ext file2.\+ext}\hypertarget{README.md_autotoc_md21817}{}\doxysubsubsection{\texorpdfstring{Type\+Script}{Type\+Script}}\label{README.md_autotoc_md21817}
{\itshape Lint-\/staged} provides Type\+Script types for the configuration and main Node.\+js API. You can use the JSDoc syntax in your JS configuration files\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{/**}
\DoxyCodeLine{\ *\ @filename:\ lint-\/staged.config.js}
\DoxyCodeLine{\ *\ @type\ \{import('lint-\/staged').Configuration\}}
\DoxyCodeLine{\ */}
\DoxyCodeLine{export\ default\ \{}
\DoxyCodeLine{\ \ '*':\ 'prettier\ -\/-\/write',}
\DoxyCodeLine{\}}

\end{DoxyCode}


It\textquotesingle{}s also possible to use the {\ttfamily .ts} file extension for the configuration if your Node.\+js version supports it. The {\ttfamily -\/-\/experimental-\/strip-\/types} flag was introduced in \href{https://github.com/nodejs/node/releases/tag/v22.6.0}{\texttt{ Node.\+js v22.\+6.\+0}} and unflagged in \href{https://github.com/nodejs/node/releases/tag/v23.6.0}{\texttt{ v23.\+6.\+0}}, enabling Node.\+js to execute Type\+Script files without additional configuration.


\begin{DoxyCode}{0}
\DoxyCodeLine{export\ NODE\_OPTIONS="{}-\/-\/experimental-\/strip-\/types"{}}
\DoxyCodeLine{}
\DoxyCodeLine{npx\ lint-\/staged\ -\/-\/config\ lint-\/staged.config.ts}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md21818}{}\doxysubsubsection{\texorpdfstring{Task concurrency}{Task concurrency}}\label{README.md_autotoc_md21818}
By default {\itshape lint-\/staged} will run configured tasks concurrently. This means that for every glob, all the commands will be started at the same time. With the following config, both {\ttfamily eslint} and {\ttfamily prettier} will run at the same time\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.ts"{}:\ "{}eslint"{},}
\DoxyCodeLine{\ \ "{}*.md"{}:\ "{}prettier\ -\/-\/list-\/different"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


This is typically not a problem since the globs do not overlap, and the commands do not make changes to the files, but only report possible errors (aborting the git commit). If you want to run multiple commands for the same set of files, you can use the array syntax to make sure commands are run in order. In the following example, {\ttfamily prettier} will run for both globs, and in addition {\ttfamily eslint} will run for {\ttfamily \texorpdfstring{$\ast$}{*}.ts} files {\itshape after} it. Both sets of commands (for each glob) are still started at the same time (but do not overlap).


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.ts"{}:\ ["{}prettier\ -\/-\/list-\/different"{},\ "{}eslint"{}],}
\DoxyCodeLine{\ \ "{}*.md"{}:\ "{}prettier\ -\/-\/list-\/different"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


Pay extra attention when the configured globs overlap, and tasks make edits to files. For example, in this configuration {\ttfamily prettier} and {\ttfamily eslint} might try to make changes to the same {\ttfamily \texorpdfstring{$\ast$}{*}.ts} file at the same time, causing a {\itshape race condition}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*"{}:\ "{}prettier\ -\/-\/write"{},}
\DoxyCodeLine{\ \ "{}*.ts"{}:\ "{}eslint\ -\/-\/fix"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


You can solve it using the negation pattern and the array syntax\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}!(*.ts)"{}:\ "{}prettier\ -\/-\/write"{},}
\DoxyCodeLine{\ \ "{}*.ts"{}:\ ["{}eslint\ -\/-\/fix"{},\ "{}prettier\ -\/-\/write"{}]}
\DoxyCodeLine{\}}

\end{DoxyCode}


Another example in which tasks make edits to files and globs match multiple files but don\textquotesingle{}t overlap\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.css"{}:\ ["{}stylelint\ -\/-\/fix"{},\ "{}prettier\ -\/-\/write"{}],}
\DoxyCodeLine{\ \ "{}*.\{js,jsx\}"{}:\ ["{}eslint\ -\/-\/fix"{},\ "{}prettier\ -\/-\/write"{}],}
\DoxyCodeLine{\ \ "{}!(*.css|*.js|*.jsx)"{}:\ ["{}prettier\ -\/-\/write"{}]}
\DoxyCodeLine{\}}

\end{DoxyCode}


Or, if necessary, you can limit the concurrency using {\ttfamily -\/-\/concurrent \texorpdfstring{$<$}{<}number\texorpdfstring{$>$}{>}} or disable it entirely with {\ttfamily -\/-\/concurrent false}.\hypertarget{README.md_autotoc_md21819}{}\doxysubsection{\texorpdfstring{Filtering files}{Filtering files}}\label{README.md_autotoc_md21819}
Task commands work on a subset of all staged files, defined by a {\itshape glob pattern}. lint-\/staged uses \href{https://github.com/micromatch/micromatch}{\texttt{ micromatch}} for matching files with the following rules\+:


\begin{DoxyItemize}
\item If the glob pattern contains no slashes ({\ttfamily /}), micromatch\textquotesingle{}s {\ttfamily match\+Base} option will be enabled, so globs match a file\textquotesingle{}s basename regardless of directory\+:
\begin{DoxyItemize}
\item {\ttfamily "{}\texorpdfstring{$\ast$}{*}.\+js"{}} will match all JS files, like {\ttfamily /test.js} and {\ttfamily /foo/bar/test.js}
\item {\ttfamily "{}!(\texorpdfstring{$\ast$}{*}test).\+js"{}} will match all JS files, except those ending in {\ttfamily test.\+js}, so {\ttfamily foo.\+js} but not {\ttfamily foo.\+test.\+js}
\item {\ttfamily "{}!(\texorpdfstring{$\ast$}{*}.\+css\texorpdfstring{$\vert$}{|}\texorpdfstring{$\ast$}{*}.\+js)"{}} will match all files except CSS and JS files
\end{DoxyItemize}
\item If the glob pattern does contain a slash ({\ttfamily /}), it will match for paths as well\+:
\begin{DoxyItemize}
\item {\ttfamily "{}./\texorpdfstring{$\ast$}{*}.\+js"{}} will match all JS files in the git repo root, so {\ttfamily /test.js} but not {\ttfamily /foo/bar/test.js}
\item {\ttfamily "{}foo/\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}/\texorpdfstring{$\ast$}{*}.\+js"{}} will match all JS files inside the {\ttfamily /foo} directory, so {\ttfamily /foo/bar/test.js} but not {\ttfamily /test.js}
\end{DoxyItemize}
\end{DoxyItemize}

When matching, lint-\/staged will do the following


\begin{DoxyItemize}
\item Resolve the git root automatically, no configuration needed.
\item Pick the staged files which are present inside the project directory.
\item Filter them using the specified glob patterns.
\item Pass absolute paths to the tasks as arguments.
\end{DoxyItemize}

{\bfseries{NOTE\+:}} {\ttfamily lint-\/staged} will pass {\itshape absolute} paths to the tasks to avoid any confusion in case they\textquotesingle{}re executed in a different working directory (i.\+e. when your {\ttfamily .git} directory isn\textquotesingle{}t the same as your {\ttfamily package.\+json} directory).

Also see How to use \`{}lint-\/staged\`{} in a multi-\/package monorepo?\hypertarget{README.md_autotoc_md21820}{}\doxysubsubsection{\texorpdfstring{Ignoring files}{Ignoring files}}\label{README.md_autotoc_md21820}
The concept of {\ttfamily lint-\/staged} is to run configured linter tasks (or other tasks) on files that are staged in git. {\ttfamily lint-\/staged} will always pass a list of all staged files to the task, and ignoring any files should be configured in the task itself.

Consider a project that uses \href{https://prettier.io/}{\texttt{ {\ttfamily prettier}}} to keep code format consistent across all files. The project also stores minified 3rd-\/party vendor libraries in the {\ttfamily vendor/} directory. To keep {\ttfamily prettier} from throwing errors on these files, the vendor directory should be added to prettier\textquotesingle{}s ignore configuration, the {\ttfamily .prettierignore} file. Running {\ttfamily npx prettier .} will ignore the entire vendor directory, throwing no errors. When {\ttfamily lint-\/staged} is added to the project and configured to run prettier, all modified and staged files in the vendor directory will be ignored by prettier, even though it receives them as input.

In advanced scenarios, where it is impossible to configure the linter task itself to ignore files, but some staged files should still be ignored by {\ttfamily lint-\/staged}, it is possible to filter filepaths before passing them to tasks by using the function syntax. See Example\+: Ignore files from match.\hypertarget{README.md_autotoc_md21821}{}\doxysubsection{\texorpdfstring{What commands are supported?}{What commands are supported?}}\label{README.md_autotoc_md21821}
Supported are any executables installed locally or globally via {\ttfamily npm} as well as any executable from your \$PATH.

\begin{quote}
Using globally installed scripts is discouraged, since lint-\/staged may not work for someone who doesn\textquotesingle{}t have it installed. \end{quote}


{\ttfamily lint-\/staged} uses \href{https://github.com/sindresorhus/execa\#preferlocal}{\texttt{ execa}} to locate locally installed scripts. So in your {\ttfamily .lintstagedrc} you can write\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.js"{}:\ "{}eslint\ -\/-\/fix"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


This will result in {\itshape lint-\/staged} running {\ttfamily eslint -\/-\/fix file-\/1.\+js file-\/2.\+js}, when you have staged files {\ttfamily file-\/1.\+js}, {\ttfamily file-\/2.\+js} and {\ttfamily README.\+md}.

Pass arguments to your commands separated by space as you would do in the shell. See \doxylink{README.md_examples}{examples} below.\hypertarget{README.md_autotoc_md21822}{}\doxysubsection{\texorpdfstring{Running multiple commands in a sequence}{Running multiple commands in a sequence}}\label{README.md_autotoc_md21822}
You can run multiple commands in a sequence on every glob. To do so, pass an array of commands instead of a single one. This is useful for running autoformatting tools like {\ttfamily eslint -\/-\/fix} or {\ttfamily stylefmt} but can be used for any arbitrary sequences.

For example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.js"{}:\ ["{}eslint"{},\ "{}prettier\ -\/-\/write"{}]}
\DoxyCodeLine{\}}

\end{DoxyCode}


going to execute {\ttfamily eslint} and if it exits with {\ttfamily 0} code, it will execute {\ttfamily prettier -\/-\/write} on all staged {\ttfamily \texorpdfstring{$\ast$}{*}.js} files.

This will result in {\itshape lint-\/staged} running {\ttfamily eslint file-\/1.\+js file-\/2.\+js}, when you have staged files {\ttfamily file-\/1.\+js}, {\ttfamily file-\/2.\+js} and {\ttfamily README.\+md}, and if it passes, {\ttfamily prettier -\/-\/write file-\/1.\+js file-\/2.\+js}.\hypertarget{README.md_autotoc_md21823}{}\doxysubsection{\texorpdfstring{Using JS configuration files}{Using JS configuration files}}\label{README.md_autotoc_md21823}
Writing the configuration file in Java\+Script is the most powerful way to configure lint-\/staged ({\ttfamily lint-\/staged.\+config.\+js}, \href{https://github.com/okonet/lint-staged\#configuration}{\texttt{ similar}}, or passed via {\ttfamily -\/-\/config}). From the configuration file, you can export either a single function or an object.

If the {\ttfamily exports} value is a function, it will receive an array of all staged filenames. You can then build your own matchers for the files and return a command string or an array of command strings. These strings are considered complete and should include the filename arguments, if wanted.

If the {\ttfamily exports} value is an object, its keys should be glob matches (like in the normal non-\/js config format). The values can either be like in the normal config or individual functions like described above. Instead of receiving all matched files, the functions in the exported object will only receive the staged files matching the corresponding glob key.

To summarize, by default {\itshape lint-\/staged} automatically adds the list of matched staged files to your command, but when building the command using JS functions it is expected to do this manually. For example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{export\ default\ \{}
\DoxyCodeLine{\ \ '*.js':\ (stagedFiles)\ =>\ [`eslint\ .`,\ \`{}prettier\ -\/-\/write\ \$\{stagedFiles.join('\ ')\}`],}
\DoxyCodeLine{\}}

\end{DoxyCode}


This will result in {\itshape lint-\/staged} first running {\ttfamily eslint .} (matching {\itshape all} files), and if it passes, {\ttfamily prettier -\/-\/write file-\/1.\+js file-\/2.\+js}, when you have staged files {\ttfamily file-\/1.\+js}, {\ttfamily file-\/2.\+js} and {\ttfamily README.\+md}.\hypertarget{README.md_autotoc_md21824}{}\doxysubsubsection{\texorpdfstring{Function signature}{Function signature}}\label{README.md_autotoc_md21824}
The function can also be async\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{(filenames:\ string[])\ =>\ string\ |\ string[]\ |\ Promise<string\ |\ string[]>}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md21825}{}\doxysubsubsection{\texorpdfstring{Example\+: Export a function to build your own matchers}{Example\+: Export a function to build your own matchers}}\label{README.md_autotoc_md21825}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{//\ lint-\/staged.config.js}
\DoxyCodeLine{import\ micromatch\ from\ 'micromatch'}
\DoxyCodeLine{}
\DoxyCodeLine{export\ default\ (allStagedFiles)\ =>\ \{}
\DoxyCodeLine{\ \ const\ shFiles\ =\ micromatch(allStagedFiles,\ ['**/src/**/*.sh'])}
\DoxyCodeLine{\ \ if\ (shFiles.length)\ \{}
\DoxyCodeLine{\ \ \ \ return\ \`{}printf\ '\%s\(\backslash\)n'\ "{}Script\ files\ aren't\ allowed\ in\ src\ directory"{}\ >\&2`}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \ const\ codeFiles\ =\ micromatch(allStagedFiles,\ ['**/*.js',\ '**/*.ts'])}
\DoxyCodeLine{\ \ const\ docFiles\ =\ micromatch(allStagedFiles,\ ['**/*.md'])}
\DoxyCodeLine{\ \ return\ [`eslint\ \$\{codeFiles.join('\ ')\}`,\ \`{}mdl\ \$\{docFiles.join('\ ')\}`]}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21826}{}\doxysubsubsection{\texorpdfstring{Example\+: Wrap filenames in single quotes and run once per file}{Example\+: Wrap filenames in single quotes and run once per file}}\label{README.md_autotoc_md21826}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{//\ .lintstagedrc.js}
\DoxyCodeLine{export\ default\ \{}
\DoxyCodeLine{\ \ '**/*.js?(x)':\ (filenames)\ =>\ filenames.map((filename)\ =>\ \`{}prettier\ -\/-\/write\ '\$\{filename\}'`),}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21827}{}\doxysubsubsection{\texorpdfstring{Example\+: Run {\ttfamily tsc} on changes to Type\+Script files, but do not pass any filename arguments}{Example\+: Run {\ttfamily tsc} on changes to Type\+Script files, but do not pass any filename arguments}}\label{README.md_autotoc_md21827}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{//\ lint-\/staged.config.js}
\DoxyCodeLine{export\ default\ \{}
\DoxyCodeLine{\ \ '**/*.ts?(x)':\ ()\ =>\ 'tsc\ -\/p\ tsconfig.json\ -\/-\/noEmit',}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21828}{}\doxysubsubsection{\texorpdfstring{Example\+: Run ESLint on entire repo if more than 10 staged files}{Example\+: Run ESLint on entire repo if more than 10 staged files}}\label{README.md_autotoc_md21828}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{//\ .lintstagedrc.js}
\DoxyCodeLine{export\ default\ \{}
\DoxyCodeLine{\ \ '**/*.js?(x)':\ (filenames)\ =>}
\DoxyCodeLine{\ \ \ \ filenames.length\ >\ 10\ ?\ 'eslint\ .'\ :\ \`{}eslint\ \$\{filenames.join('\ ')\}`,}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21829}{}\doxysubsubsection{\texorpdfstring{Example\+: Use your own globs}{Example\+: Use your own globs}}\label{README.md_autotoc_md21829}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


It\textquotesingle{}s better to use the \href{https://github.com/okonet/lint-staged\#example-export-a-function-to-build-your-own-matchers}{\texttt{ function-\/based configuration (seen above)}}, if your use case is this.


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ lint-\/staged.config.js}
\DoxyCodeLine{import\ micromatch\ from\ 'micromatch'}
\DoxyCodeLine{}
\DoxyCodeLine{export\ default\ \{}
\DoxyCodeLine{\ \ '*':\ (allFiles)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ const\ codeFiles\ =\ micromatch(allFiles,\ ['**/*.js',\ '**/*.ts'])}
\DoxyCodeLine{\ \ \ \ const\ docFiles\ =\ micromatch(allFiles,\ ['**/*.md'])}
\DoxyCodeLine{\ \ \ \ return\ [`eslint\ \$\{codeFiles.join('\ ')\}`,\ \`{}mdl\ \$\{docFiles.join('\ ')\}`]}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21830}{}\doxysubsubsection{\texorpdfstring{Example\+: Ignore files from match}{Example\+: Ignore files from match}}\label{README.md_autotoc_md21830}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


If for some reason you want to ignore files from the glob match, you can use {\ttfamily micromatch.\+not()}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ lint-\/staged.config.js}
\DoxyCodeLine{import\ micromatch\ from\ 'micromatch'}
\DoxyCodeLine{}
\DoxyCodeLine{export\ default\ \{}
\DoxyCodeLine{\ \ '*.js':\ (files)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ //\ from\ \`{}files`\ filter\ those\ \_NOT\_\ matching\ \`{}*test.js`}
\DoxyCodeLine{\ \ \ \ const\ match\ =\ micromatch.not(files,\ '*test.js')}
\DoxyCodeLine{\ \ \ \ return\ \`{}eslint\ \$\{match.join('\ ')\}`}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\}}

\end{DoxyCode}


Please note that for most cases, globs can achieve the same effect. For the above example, a matching glob would be {\ttfamily !(\texorpdfstring{$\ast$}{*}test).js}.

\end{adjustwidth}
\hypertarget{README.md_autotoc_md21831}{}\doxysubsubsection{\texorpdfstring{Example\+: Use relative paths for commands}{Example\+: Use relative paths for commands}}\label{README.md_autotoc_md21831}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{import\ path\ from\ 'path'}
\DoxyCodeLine{}
\DoxyCodeLine{export\ default\ \{}
\DoxyCodeLine{\ \ '*.ts':\ (absolutePaths)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ const\ cwd\ =\ process.cwd()}
\DoxyCodeLine{\ \ \ \ const\ relativePaths\ =\ absolutePaths.map((file)\ =>\ path.relative(cwd,\ file))}
\DoxyCodeLine{\ \ \ \ return\ \`{}ng\ lint\ myProjectName\ -\/-\/files\ \$\{relativePaths.join('\ ')\}`}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21832}{}\doxysubsection{\texorpdfstring{Reformatting the code}{Reformatting the code}}\label{README.md_autotoc_md21832}
Tools like \href{https://prettier.io}{\texttt{ Prettier}}, ESLint/\+TSLint, or stylelint can reformat your code according to an appropriate config by running {\ttfamily prettier -\/-\/write}/{\ttfamily eslint -\/-\/fix}/{\ttfamily tslint -\/-\/fix}/{\ttfamily stylelint -\/-\/fix}. Lint-\/staged will automatically add any modifications to the commit as long as there are no errors.


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.js"{}:\ "{}prettier\ -\/-\/write"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


Prior to version 10, tasks had to manually include {\ttfamily git add} as the final step. This behavior has been integrated into lint-\/staged itself in order to prevent race conditions with multiple tasks editing the same files. If lint-\/staged detects {\ttfamily git add} in task configurations, it will show a warning in the console. Please remove {\ttfamily git add} from your configuration after upgrading.\hypertarget{README.md_autotoc_md21833}{}\doxysubsection{\texorpdfstring{Examples}{Examples}}\label{README.md_autotoc_md21833}
All examples assume you\textquotesingle{}ve already set up lint-\/staged in the {\ttfamily package.\+json} file and \href{https://github.com/typicode/husky}{\texttt{ husky}} in its own config file.


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}name"{}:\ "{}My\ project"{},}
\DoxyCodeLine{\ \ "{}version"{}:\ "{}0.1.0"{},}
\DoxyCodeLine{\ \ "{}scripts"{}:\ \{}
\DoxyCodeLine{\ \ \ \ "{}my-\/custom-\/script"{}:\ "{}linter\ -\/-\/arg1\ -\/-\/arg2"{}}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\ \ "{}lint-\/staged"{}:\ \{\}}
\DoxyCodeLine{\}}

\end{DoxyCode}


In {\ttfamily .husky/pre-\/commit}


\begin{DoxyCode}{0}
\DoxyCodeLine{\#\ .husky/pre-\/commit}
\DoxyCodeLine{}
\DoxyCodeLine{npx\ lint-\/staged}

\end{DoxyCode}


{\itshape Note\+: we don\textquotesingle{}t pass a path as an argument for the runners. This is important since lint-\/staged will do this for you.}\hypertarget{README.md_autotoc_md21834}{}\doxysubsubsection{\texorpdfstring{ESLint with default parameters for {\ttfamily \texorpdfstring{$\ast$}{*}.js} and {\ttfamily \texorpdfstring{$\ast$}{*}.jsx} running as a pre-\/commit hook}{ESLint with default parameters for {\ttfamily \texorpdfstring{$\ast$}{*}.js} and {\ttfamily \texorpdfstring{$\ast$}{*}.jsx} running as a pre-\/commit hook}}\label{README.md_autotoc_md21834}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.\{js,jsx\}"{}:\ "{}eslint"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21835}{}\doxysubsubsection{\texorpdfstring{Automatically fix code style with {\ttfamily -\/-\/fix} and add to commit}{Automatically fix code style with {\ttfamily -\/-\/fix} and add to commit}}\label{README.md_autotoc_md21835}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.js"{}:\ "{}eslint\ -\/-\/fix"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


This will run {\ttfamily eslint -\/-\/fix} and automatically add changes to the commit.

\end{adjustwidth}
\hypertarget{README.md_autotoc_md21836}{}\doxysubsubsection{\texorpdfstring{Reuse npm script}{Reuse npm script}}\label{README.md_autotoc_md21836}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


If you wish to reuse a npm script defined in your package.\+json\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.js"{}:\ "{}npm\ run\ my-\/custom-\/script\ -\/-\/"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


The following is equivalent\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.js"{}:\ "{}linter\ -\/-\/arg1\ -\/-\/arg2"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21837}{}\doxysubsubsection{\texorpdfstring{Use environment variables with task commands}{Use environment variables with task commands}}\label{README.md_autotoc_md21837}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


Task commands {\itshape do not} support the shell convention of expanding environment variables. To enable the convention yourself, use a tool like \href{https://github.com/kentcdodds/cross-env}{\texttt{ {\ttfamily cross-\/env}}}.

For example, here is {\ttfamily jest} running on all {\ttfamily .js} files with the {\ttfamily NODE\+\_\+\+ENV} variable being set to {\ttfamily "{}test"{}}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.js"{}:\ ["{}cross-\/env\ NODE\_ENV=test\ jest\ -\/-\/bail\ -\/-\/findRelatedTests"{}]}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21838}{}\doxysubsubsection{\texorpdfstring{Automatically fix code style with {\ttfamily prettier} for any format Prettier supports}{Automatically fix code style with {\ttfamily prettier} for any format Prettier supports}}\label{README.md_autotoc_md21838}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*"{}:\ "{}prettier\ -\/-\/ignore-\/unknown\ -\/-\/write"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21839}{}\doxysubsubsection{\texorpdfstring{Automatically fix code style with {\ttfamily prettier} for Java\+Script, Type\+Script, Markdown, HTML, or CSS}{Automatically fix code style with {\ttfamily prettier} for Java\+Script, Type\+Script, Markdown, HTML, or CSS}}\label{README.md_autotoc_md21839}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.\{js,jsx,ts,tsx,md,html,css\}"{}:\ "{}prettier\ -\/-\/write"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21840}{}\doxysubsubsection{\texorpdfstring{Stylelint for CSS with defaults and for SCSS with SCSS syntax}{Stylelint for CSS with defaults and for SCSS with SCSS syntax}}\label{README.md_autotoc_md21840}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.css"{}:\ "{}stylelint"{},}
\DoxyCodeLine{\ \ "{}*.scss"{}:\ "{}stylelint\ -\/-\/syntax=scss"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21841}{}\doxysubsubsection{\texorpdfstring{Run Post\+CSS sorting and Stylelint to check}{Run Post\+CSS sorting and Stylelint to check}}\label{README.md_autotoc_md21841}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.scss"{}:\ ["{}postcss\ -\/-\/config\ path/to/your/config\ -\/-\/replace"{},\ "{}stylelint"{}]}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21842}{}\doxysubsubsection{\texorpdfstring{Minify the images}{Minify the images}}\label{README.md_autotoc_md21842}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.\{png,jpeg,jpg,gif,svg\}"{}:\ "{}imagemin-\/lint-\/staged"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}




{\bfseries{More about {\ttfamily imagemin-\/lint-\/staged}}}\begin{adjustwidth}{1em}{0em}


\href{https://github.com/tomchentw/imagemin-lint-staged}{\texttt{ imagemin-\/lint-\/staged}} is a CLI tool designed for lint-\/staged usage with sensible defaults.

See more on \href{https://medium.com/@tomchentw/imagemin-lint-staged-in-place-minify-the-images-before-adding-to-the-git-repo-5acda0b4c57e}{\texttt{ this blog post}} for benefits of this approach.

\end{adjustwidth}
\end{adjustwidth}
\hypertarget{README.md_autotoc_md21843}{}\doxysubsubsection{\texorpdfstring{Typecheck your staged files with flow}{Typecheck your staged files with flow}}\label{README.md_autotoc_md21843}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.\{js,jsx\}"{}:\ "{}flow\ focus-\/check"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21844}{}\doxysubsubsection{\texorpdfstring{Integrate with Next.\+js}{Integrate with Next.\+js}}\label{README.md_autotoc_md21844}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{//\ .lintstagedrc.js}
\DoxyCodeLine{//\ See\ https://nextjs.org/docs/basic-\/features/eslint\#lint-\/staged\ for\ details}
\DoxyCodeLine{}
\DoxyCodeLine{const\ path\ =\ require('path')}
\DoxyCodeLine{}
\DoxyCodeLine{const\ buildEslintCommand\ =\ (filenames)\ =>}
\DoxyCodeLine{\ \ \`{}next\ lint\ -\/-\/fix\ -\/-\/file\ \$\{filenames.map((f)\ =>\ path.relative(process.cwd(),\ f)).join('\ -\/-\/file\ ')\}`}
\DoxyCodeLine{}
\DoxyCodeLine{module.exports\ =\ \{}
\DoxyCodeLine{\ \ '*.\{js,jsx,ts,tsx\}':\ [buildEslintCommand],}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21845}{}\doxysubsection{\texorpdfstring{Frequently Asked Questions}{Frequently Asked Questions}}\label{README.md_autotoc_md21845}
\hypertarget{README.md_autotoc_md21846}{}\doxysubsubsection{\texorpdfstring{The output of commit hook looks weird (no colors, duplicate lines, verbose output on Windows, …)}{The output of commit hook looks weird (no colors, duplicate lines, verbose output on Windows, …)}}\label{README.md_autotoc_md21846}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


Git 2.\+36.\+0 introduced a change to hooks where they were no longer run in the original TTY. This was fixed in 2.\+37.\+0\+:

\href{https://raw.githubusercontent.com/git/git/master/Documentation/RelNotes/2.37.0.txt}{\texttt{ https\+://raw.\+githubusercontent.\+com/git/git/master/\+Documentation/\+Rel\+Notes/2.\+37.\+0.\+txt}}

\begin{quote}

\begin{DoxyItemize}
\item In Git 2.\+36 we revamped the way how hooks are invoked. One change that is end-\/user visible is that the output of a hook is no longer directly connected to the standard output of "{}git"{} that spawns the hook, which was noticed post release. This is getting corrected. (merge \href{https://github.com/git/git/commit/a082345372}{\texttt{ a082345372}} ab/hooks-\/regression-\/fix later to maint). 
\end{DoxyItemize}\end{quote}


If updating Git doesn\textquotesingle{}t help, you can try to manually redirect the output in your Git hook; for example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\#\ .husky/pre-\/commit}
\DoxyCodeLine{}
\DoxyCodeLine{if\ sh\ -\/c\ "{}:\ >/dev/tty"{}\ >/dev/null\ 2>/dev/null;\ then\ exec\ >/dev/tty\ 2>\&1;\ fi}
\DoxyCodeLine{}
\DoxyCodeLine{npx\ lint-\/staged}

\end{DoxyCode}


Source\+: \href{https://github.com/typicode/husky/issues/968\#issuecomment-1176848345}{\texttt{ https\+://github.\+com/typicode/husky/issues/968\#issuecomment-\/1176848345}}

\end{adjustwidth}
\hypertarget{README.md_autotoc_md21847}{}\doxysubsubsection{\texorpdfstring{Can I use {\ttfamily lint-\/staged} via node?}{Can I use {\ttfamily lint-\/staged} via node?}}\label{README.md_autotoc_md21847}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


Yes!


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ lintStaged\ from\ 'lint-\/staged'}
\DoxyCodeLine{}
\DoxyCodeLine{try\ \{}
\DoxyCodeLine{\ \ const\ success\ =\ await\ lintStaged()}
\DoxyCodeLine{\ \ console.log(success\ ?\ 'Linting\ was\ successful!'\ :\ 'Linting\ failed!')}
\DoxyCodeLine{\}\ catch\ (e)\ \{}
\DoxyCodeLine{\ \ //\ Failed\ to\ load\ configuration}
\DoxyCodeLine{\ \ console.error(e)}
\DoxyCodeLine{\}}

\end{DoxyCode}


Parameters to {\ttfamily lint\+Staged} are equivalent to their CLI counterparts\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ success\ =\ await\ lintStaged(\{}
\DoxyCodeLine{\ \ allowEmpty:\ false,}
\DoxyCodeLine{\ \ concurrent:\ true,}
\DoxyCodeLine{\ \ configPath:\ './path/to/configuration/file',}
\DoxyCodeLine{\ \ cwd:\ process.cwd(),}
\DoxyCodeLine{\ \ debug:\ false,}
\DoxyCodeLine{\ \ maxArgLength:\ null,}
\DoxyCodeLine{\ \ quiet:\ false,}
\DoxyCodeLine{\ \ relative:\ false,}
\DoxyCodeLine{\ \ shell:\ false,}
\DoxyCodeLine{\ \ stash:\ true,}
\DoxyCodeLine{\ \ verbose:\ false,}
\DoxyCodeLine{\})}

\end{DoxyCode}


You can also pass config directly with {\ttfamily config} option\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ success\ =\ await\ lintStaged(\{}
\DoxyCodeLine{\ \ allowEmpty:\ false,}
\DoxyCodeLine{\ \ concurrent:\ true,}
\DoxyCodeLine{\ \ config:\ \{\ '*.js':\ 'eslint\ -\/-\/fix'\ \},}
\DoxyCodeLine{\ \ cwd:\ process.cwd(),}
\DoxyCodeLine{\ \ debug:\ false,}
\DoxyCodeLine{\ \ maxArgLength:\ null,}
\DoxyCodeLine{\ \ quiet:\ false,}
\DoxyCodeLine{\ \ relative:\ false,}
\DoxyCodeLine{\ \ shell:\ false,}
\DoxyCodeLine{\ \ stash:\ true,}
\DoxyCodeLine{\ \ verbose:\ false,}
\DoxyCodeLine{\})}

\end{DoxyCode}


The {\ttfamily max\+Arg\+Length} option configures chunking of tasks into multiple parts that are run one after the other. This is to avoid issues on Windows platforms where the maximum length of the command line argument string is limited to 8192 characters. Lint-\/staged might generate a very long argument string when there are many staged files. This option is set automatically from the cli, but not via the Node.\+js API by default.

\end{adjustwidth}
\hypertarget{README.md_autotoc_md21848}{}\doxysubsubsection{\texorpdfstring{Using with Jet\+Brains IDEs {\itshape (Web\+Storm, Py\+Charm, IntelliJ IDEA, Ruby\+Mine, etc.)}}{Using with Jet\+Brains IDEs {\itshape (Web\+Storm, Py\+Charm, IntelliJ IDEA, Ruby\+Mine, etc.)}}}\label{README.md_autotoc_md21848}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


{\itshape {\bfseries{Update}}}\+: The latest version of Jet\+Brains IDEs now support running hooks as you would expect.

When using the IDE\textquotesingle{}s GUI to commit changes with the {\ttfamily precommit} hook, you might see inconsistencies in the IDE and command line. This is \href{https://youtrack.jetbrains.com/issue/IDEA-135454}{\texttt{ known issue}} at Jet\+Brains so if you want this fixed, please vote for it on You\+Track.

Until the issue is resolved in the IDE, you can use the following config to work around it\+:

husky v1.\+x


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}husky"{}:\ \{}
\DoxyCodeLine{\ \ \ \ "{}hooks"{}:\ \{}
\DoxyCodeLine{\ \ \ \ \ \ "{}pre-\/commit"{}:\ "{}lint-\/staged"{},}
\DoxyCodeLine{\ \ \ \ \ \ "{}post-\/commit"{}:\ "{}git\ update-\/index\ -\/-\/again"{}}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}


husky v0.\+x


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}scripts"{}:\ \{}
\DoxyCodeLine{\ \ \ \ "{}precommit"{}:\ "{}lint-\/staged"{},}
\DoxyCodeLine{\ \ \ \ "{}postcommit"{}:\ "{}git\ update-\/index\ -\/-\/again"{}}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}


{\itshape Thanks to \href{https://youtrack.jetbrains.com/issue/IDEA-135454\#comment=27-2710654}{\texttt{ this comment}} for the fix!}

\end{adjustwidth}
\hypertarget{README.md_autotoc_md21849}{}\doxysubsubsection{\texorpdfstring{How to use {\ttfamily lint-\/staged} in a multi-\/package monorepo?}{How to use {\ttfamily lint-\/staged} in a multi-\/package monorepo?}}\label{README.md_autotoc_md21849}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


Install {\itshape lint-\/staged} on the monorepo root level, and add separate configuration files in each package. When running, {\itshape lint-\/staged} will always use the configuration closest to a staged file, so having separate configuration files makes sure tasks do not "{}leak"{} into other packages.

For example, in a monorepo with {\ttfamily packages/frontend/.lintstagedrc.\+json} and {\ttfamily packages/backend/.lintstagedrc.\+json}, a staged file inside {\ttfamily packages/frontend/} will only match that configuration, and not the one in {\ttfamily packages/backend/}.

{\bfseries{Note}}\+: {\itshape lint-\/staged} discovers the closest configuration to each staged file, even if that configuration doesn\textquotesingle{}t include any matching globs. Given these example configurations\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ ./.lintstagedrc.json}
\DoxyCodeLine{\{\ "{}*.md"{}:\ "{}prettier\ -\/-\/write"{}\ \}}

\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{//\ ./packages/frontend/.lintstagedrc.json}
\DoxyCodeLine{\{\ "{}*.js"{}:\ "{}eslint\ -\/-\/fix"{}\ \}}

\end{DoxyCode}


When committing {\ttfamily ./packages/frontend/\+README.md}, it {\bfseries{will not run}} {\itshape prettier}, because the configuration in the {\ttfamily frontend/} directory is closer to the file and doesn\textquotesingle{}t include it. You should treat all {\itshape lint-\/staged} configuration files as isolated and separated from each other. You can always use JS files to "{}extend"{} configurations, for example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ baseConfig\ from\ '../.lintstagedrc.js'}
\DoxyCodeLine{}
\DoxyCodeLine{export\ default\ \{}
\DoxyCodeLine{\ \ ...baseConfig,}
\DoxyCodeLine{\ \ '*.js':\ 'eslint\ -\/-\/fix',}
\DoxyCodeLine{\}}

\end{DoxyCode}


To support backwards-\/compatibility, monorepo features require multiple {\itshape lint-\/staged} configuration files present in the git repo. If you still want to run {\itshape lint-\/staged} in only one of the packages in a monorepo, you can use the {\ttfamily -\/-\/cwd} option (for example, {\ttfamily lint-\/staged -\/-\/cwd packages/frontend}).

\end{adjustwidth}
\hypertarget{README.md_autotoc_md21850}{}\doxysubsubsection{\texorpdfstring{Can I lint files outside of the current project folder?}{Can I lint files outside of the current project folder?}}\label{README.md_autotoc_md21850}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


tl;dr\+: Yes, but the pattern should start with {\ttfamily ../}.

By default, {\ttfamily lint-\/staged} executes tasks only on the files present inside the project folder(where {\ttfamily lint-\/staged} is installed and run from). So this question is relevant {\itshape only} when the project folder is a child folder inside the git repo. In certain project setups, it might be desirable to bypass this restriction. See \href{https://github.com/okonet/lint-staged/issues/425}{\texttt{ \#425}}, \href{https://github.com/okonet/lint-staged/issues/487}{\texttt{ \#487}} for more context.

{\ttfamily lint-\/staged} provides an escape hatch for the same({\ttfamily \texorpdfstring{$>$}{>}= v7.\+3.\+0}). For patterns that start with {\ttfamily ../}, all the staged files are allowed to match against the pattern. Note that patterns like {\ttfamily \texorpdfstring{$\ast$}{*}.js}, {\ttfamily \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}/\texorpdfstring{$\ast$}{*}.js} will still only match the project files and not any of the files in parent or sibling directories.

Example repo\+: \href{https://github.com/sudo-suhas/lint-staged-django-react-demo}{\texttt{ sudo-\/suhas/lint-\/staged-\/django-\/react-\/demo}}.

\end{adjustwidth}
\hypertarget{README.md_autotoc_md21851}{}\doxysubsubsection{\texorpdfstring{Can I run {\ttfamily lint-\/staged} in CI, or when there are no staged files?}{Can I run {\ttfamily lint-\/staged} in CI, or when there are no staged files?}}\label{README.md_autotoc_md21851}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


Lint-\/staged will by default run against files staged in git, and should be run during the git pre-\/commit hook, for example. It\textquotesingle{}s also possible to override this default behaviour and run against files in a specific diff, for example all changed files between two different branches. If you want to run {\itshape lint-\/staged} in the CI, maybe you can set it up to compare the branch in a {\itshape Pull Request}/\+\_\+\+Merge Request\+\_\+ to the target branch.

Try out the {\ttfamily git diff} command until you are satisfied with the result, for example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{git\ diff\ -\/-\/diff-\/filter=ACMR\ -\/-\/name-\/only\ main...my-\/branch}

\end{DoxyCode}


This will print a list of {\itshape added}, {\itshape changed}, {\itshape modified}, and {\itshape renamed} files between {\ttfamily main} and {\ttfamily my-\/branch}.

You can then run lint-\/staged against the same files with\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{npx\ lint-\/staged\ -\/-\/diff="{}main...my-\/branch"{}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21852}{}\doxysubsubsection{\texorpdfstring{Can I use {\ttfamily lint-\/staged} with {\ttfamily ng lint}}{Can I use {\ttfamily lint-\/staged} with {\ttfamily ng lint}}}\label{README.md_autotoc_md21852}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


You should not use {\ttfamily ng lint} through {\itshape lint-\/staged}, because it\textquotesingle{}s designed to lint an entire project. Instead, you can add {\ttfamily ng lint} to your git pre-\/commit hook the same way as you would run lint-\/staged.

See issue \href{https://github.com/okonet/lint-staged/issues/951}{\texttt{ !951}} for more details and possible workarounds.

\end{adjustwidth}
\hypertarget{README.md_autotoc_md21853}{}\doxysubsubsection{\texorpdfstring{How can I ignore files from {\ttfamily .eslintignore}?}{How can I ignore files from {\ttfamily .eslintignore}?}}\label{README.md_autotoc_md21853}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


ESLint throws out {\ttfamily warning File ignored because of a matching ignore pattern. Use "{}-\/-\/no-\/ignore"{} to override} warnings that breaks the linting process ( if you used {\ttfamily -\/-\/max-\/warnings=0} which is recommended ).

\end{adjustwidth}
\hypertarget{README.md_autotoc_md21854}{}\doxysubsubsubsection{\texorpdfstring{ESLint \texorpdfstring{$<$}{<} 7}{ESLint \texorpdfstring{$<$}{<} 7}}\label{README.md_autotoc_md21854}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


Based on the discussion from \href{https://github.com/eslint/eslint/issues/9977}{\texttt{ this issue}}, it was decided that using \href{https://github.com/eslint/eslint/issues/9977\#issuecomment-406420893}{\texttt{ the outlined script}}is the best route to fix this.

So you can setup a {\ttfamily .lintstagedrc.\+js} config file to do this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ CLIEngine\ \}\ from\ 'eslint'}
\DoxyCodeLine{}
\DoxyCodeLine{export\ default\ \{}
\DoxyCodeLine{\ \ '*.js':\ (files)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ const\ cli\ =\ new\ CLIEngine(\{\})}
\DoxyCodeLine{\ \ \ \ return\ 'eslint\ -\/-\/max-\/warnings=0\ '\ +\ files.filter((file)\ =>\ !cli.isPathIgnored(file)).join('\ ')}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21855}{}\doxysubsubsubsection{\texorpdfstring{ESLint \texorpdfstring{$>$}{>}= 7}{ESLint \texorpdfstring{$>$}{>}= 7}}\label{README.md_autotoc_md21855}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


In versions of ESLint \texorpdfstring{$>$}{>} 7, \href{https://eslint.org/docs/developer-guide/nodejs-api\#-eslintispathignoredfilepath}{\texttt{ is\+Path\+Ignored}} is an async function and now returns a promise. The code below can be used to reinstate the above functionality.

Since \href{https://github.com/okonet/lint-staged/releases}{\texttt{ 10.\+5.\+3}}, any errors due to a bad ESLint config will come through to the console.


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ ESLint\ \}\ from\ 'eslint'}
\DoxyCodeLine{}
\DoxyCodeLine{const\ removeIgnoredFiles\ =\ async\ (files)\ =>\ \{}
\DoxyCodeLine{\ \ const\ eslint\ =\ new\ ESLint()}
\DoxyCodeLine{\ \ const\ isIgnored\ =\ await\ Promise.all(}
\DoxyCodeLine{\ \ \ \ files.map((file)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ return\ eslint.isPathIgnored(file)}
\DoxyCodeLine{\ \ \ \ \})}
\DoxyCodeLine{\ \ )}
\DoxyCodeLine{\ \ const\ filteredFiles\ =\ files.filter((\_,\ i)\ =>\ !isIgnored[i])}
\DoxyCodeLine{\ \ return\ filteredFiles.join('\ ')}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{export\ default\ \{}
\DoxyCodeLine{\ \ '**/*.\{ts,tsx,js,jsx\}':\ async\ (files)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ const\ filesToLint\ =\ await\ removeIgnoredFiles(files)}
\DoxyCodeLine{\ \ \ \ return\ [`eslint\ -\/-\/max-\/warnings=0\ \$\{filesToLint\}`]}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21856}{}\doxysubsubsubsection{\texorpdfstring{ESLint \texorpdfstring{$>$}{>}= 8.\+51.\+0 \&\& \href{https://eslint.org/docs/latest/use/configure/configuration-files-new}{\texttt{ Flat ESLint config}}}{ESLint \texorpdfstring{$>$}{>}= 8.\+51.\+0 \&\& \href{https://eslint.org/docs/latest/use/configure/configuration-files-new}{\texttt{ Flat ESLint config}}}}\label{README.md_autotoc_md21856}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


ESLint v8.\+51.\+0 introduced \href{https://eslint.org/docs/latest/use/command-line-interface\#--no-warn-ignored}{\texttt{ {\ttfamily -\/-\/no-\/warn-\/ignored} CLI flag}}. It suppresses the {\ttfamily warning File ignored because of a matching ignore pattern. Use "{}-\/-\/no-\/ignore"{} to override} warning, so manually ignoring files via {\ttfamily eslint.\+is\+Path\+Ignored} is no longer necessary.


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}*.js"{}:\ "{}eslint\ -\/-\/max-\/warnings=0\ -\/-\/no-\/warn-\/ignored"{}}
\DoxyCodeLine{\}}

\end{DoxyCode}


{\bfseries{NOTE\+:}} {\ttfamily -\/-\/no-\/warn-\/ignored} flag is only available when \href{https://eslint.org/docs/latest/use/configure/configuration-files-new}{\texttt{ Flat ESLint config}} is used.

\end{adjustwidth}
\hypertarget{README.md_autotoc_md21857}{}\doxysubsubsection{\texorpdfstring{How can I resolve Type\+Script ({\ttfamily tsc}) ignoring {\ttfamily tsconfig.\+json} when {\ttfamily lint-\/staged} runs via Husky hooks?}{How can I resolve Type\+Script ({\ttfamily tsc}) ignoring {\ttfamily tsconfig.\+json} when {\ttfamily lint-\/staged} runs via Husky hooks?}}\label{README.md_autotoc_md21857}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


When running {\ttfamily lint-\/staged} via Husky hooks, Type\+Script may ignore {\ttfamily tsconfig.\+json}, leading to errors like\+:

\begin{quote}
{\bfseries{TS17004\+:}} Cannot use JSX unless the \textquotesingle{}--jsx\textquotesingle{} flag is provided. ~\newline
 {\bfseries{TS1056\+:}} Accessors are only available when targeting ECMAScript 5 and higher. ~\newline
 \end{quote}


See issue \href{https://github.com/okonet/lint-staged/issues/825}{\texttt{ \#825}} for more details. ~\newline


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21858}{}\doxysubsubsubsection{\texorpdfstring{Root Cause}{Root Cause}}\label{README.md_autotoc_md21858}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyEnumerate}
\item {\ttfamily lint-\/staged} automatically passes matched staged files as arguments to commands. ~\newline

\item Certain input files can cause Type\+Script to ignore {\ttfamily tsconfig.\+json}. For more details, see this Type\+Script issue\+: \href{https://github.com/microsoft/TypeScript/issues/27379}{\texttt{ Allow tsconfig.\+json when input files are specified}}. ~\newline

\end{DoxyEnumerate}

\end{adjustwidth}
~\newline
\hypertarget{README.md_autotoc_md21859}{}\doxysubsubsubsection{\texorpdfstring{Workaround 1\+: Use a \href{https://github.com/lint-staged/lint-staged?tab=readme-ov-file\#example-run-tsc-on-changes-to-typescript-files-but-do-not-pass-any-filename-arguments}{\texttt{ function signature}} for the {\ttfamily tsc} command}{Workaround 1\+: Use a \href{https://github.com/lint-staged/lint-staged?tab=readme-ov-file\#example-run-tsc-on-changes-to-typescript-files-but-do-not-pass-any-filename-arguments}{\texttt{ function signature}} for the {\ttfamily tsc} command}}\label{README.md_autotoc_md21859}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


As suggested by @antoinerousseau in \href{https://github.com/lint-staged/lint-staged/issues/825\#issuecomment-620018284}{\texttt{ \#825 (comment)}}, using a function prevents {\ttfamily lint-\/staged} from appending file arguments\+: ~\newline


{\bfseries{Before\+:}}


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ package.json}
\DoxyCodeLine{}
\DoxyCodeLine{"{}lint-\/staged"{}:\ \{}
\DoxyCodeLine{\ \ \ \ "{}*.\{ts,tsx\}"{}:[}
\DoxyCodeLine{\ \ \ \ \ \ "{}tsc\ -\/-\/noEmit"{},}
\DoxyCodeLine{\ \ \ \ \ \ "{}prettier\ -\/-\/write"{}}
\DoxyCodeLine{\ \ \ \ ]}
\DoxyCodeLine{\ \ \}}

\end{DoxyCode}


{\bfseries{After\+:}}


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ lint-\/staged.config.js}
\DoxyCodeLine{module.exports\ =\ \{}
\DoxyCodeLine{\ \ "{}*.\{ts,tsx\}"{}:\ [}
\DoxyCodeLine{\ \ \ \ ()\ =>\ "{}tsc\ -\/-\/noEmit"{},\ }
\DoxyCodeLine{\ \ \ \ "{}prettier\ -\/-\/write"{}}
\DoxyCodeLine{\ \ ],}
\DoxyCodeLine{\}}

\end{DoxyCode}


\end{adjustwidth}
\hypertarget{README.md_autotoc_md21860}{}\doxysubsubsubsection{\texorpdfstring{Workaround 2\+: Take the {\ttfamily sh} or {\ttfamily bash} to wrap the {\ttfamily tsc} command}{Workaround 2\+: Take the {\ttfamily sh} or {\ttfamily bash} to wrap the {\ttfamily tsc} command}}\label{README.md_autotoc_md21860}


{\bfseries{Click to expand}}\begin{adjustwidth}{1em}{0em}


As suggested by @sombrero\+En\+Puntas in \href{https://github.com/lint-staged/lint-staged/issues/825\#issuecomment-674575655}{\texttt{ \#825 (comment)}}, wrapping {\ttfamily tsc} in a shell command prevents {\ttfamily lint-\/staged} from modifying its arguments\+:

{\bfseries{Before\+:}}


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ package.json}
\DoxyCodeLine{}
\DoxyCodeLine{"{}lint-\/staged"{}:\ \{}
\DoxyCodeLine{\ \ "{}*.\{ts,tsx\}"{}:[}
\DoxyCodeLine{\ \ \ \ "{}tsc\ -\/-\/noEmit"{},}
\DoxyCodeLine{\ \ \ \ "{}prettier\ -\/-\/write"{}}
\DoxyCodeLine{\ \ ]}
\DoxyCodeLine{\}}

\end{DoxyCode}


{\bfseries{After\+:}}


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ package.json}
\DoxyCodeLine{}
\DoxyCodeLine{"{}lint-\/staged"{}:\ \{}
\DoxyCodeLine{\ \ "{}*.\{ts,tsx\}"{}:[}
\DoxyCodeLine{\ \ \ \ "{}bash\ -\/c\ 'tsc\ -\/-\/noEmit'"{}}
\DoxyCodeLine{\ \ \ \ "{}prettier\ -\/-\/write"{}}
\DoxyCodeLine{\ \ ]}
\DoxyCodeLine{\}}

\end{DoxyCode}


{\bfseries{Note\+:}} This approach may have cross-\/platform compatibility issues.

\end{adjustwidth}
