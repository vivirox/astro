\doxysection{node\+\_\+modules/@vue/compiler-\/sfc Directory Reference}
\hypertarget{dir_0cf44a29f61cd871f8e94cc728c4e3c4}{}\label{dir_0cf44a29f61cd871f8e94cc728c4e3c4}\index{node\_modules/"@vue/compiler-\/sfc Directory Reference@{node\_modules/"@vue/compiler-\/sfc Directory Reference}}
\doxysubsubsection*{Directories}
\begin{DoxyCompactItemize}
\item 
directory \mbox{\hyperlink{dir_1d8cfa72022de35821dcc4066a3b06aa}{node\+\_\+modules}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{quote}
Lower level utilities for compiling Vue Single File Components \end{quote}


{\bfseries{Note\+: as of 3.\+2.\+13+, this package is included as a dependency of the main {\ttfamily vue} package and can be accessed as {\ttfamily vue/compiler-\/sfc}. This means you no longer need to explicitly install this package and ensure its version match that of {\ttfamily vue}\textquotesingle{}s. Just use the main {\ttfamily vue/compiler-\/sfc} deep import instead.}}

This package contains lower level utilities that you can use if you are writing a plugin / transform for a bundler or module system that compiles Vue Single File Components (SFCs) into Java\+Script. It is used in \href{https://github.com/vuejs/vue-loader}{\texttt{ vue-\/loader}} and \href{https://github.com/vitejs/vite-plugin-vue/tree/main/packages/plugin-vue}{\texttt{ @vitejs/plugin-\/vue}}.\hypertarget{README.md_autotoc_md7326}{}\doxysubsection{\texorpdfstring{API}{API}}\label{README.md_autotoc_md7326}
The API is intentionally low-\/level due to the various considerations when integrating Vue SFCs in a build system\+:


\begin{DoxyItemize}
\item Separate hot-\/module replacement (HMR) for script, template and styles
\begin{DoxyItemize}
\item template updates should not reset component state
\item style updates should be performed without component re-\/render
\end{DoxyItemize}
\item Leveraging the tool\textquotesingle{}s plugin system for pre-\/processor handling. e.\+g. {\ttfamily \texorpdfstring{$<$}{<}style lang="{}scss"{}\texorpdfstring{$>$}{>}} should be processed by the corresponding webpack loader.
\item In some cases, transformers of each block in an SFC do not share the same execution context. For example, when used with {\ttfamily thread-\/loader} or other parallelized configurations, the template sub-\/loader in {\ttfamily vue-\/loader} may not have access to the full SFC and its descriptor.
\end{DoxyItemize}

The general idea is to generate a facade module that imports the individual blocks of the component. The trick is the module imports itself with different query strings so that the build system can handle each request as "{}virtual"{} modules\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ script\ transform\ \ |}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/>+\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ \ \ |\ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}
\DoxyCodeLine{|\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ |\ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{|\ \ facade\ transform\ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/>+\ template\ transform\ |}
\DoxyCodeLine{|\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ |\ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+\ \ \ \ \ |\ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/>+\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ style\ transform\ \ \ |}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}

\end{DoxyCode}


Where the facade module looks like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ main\ script}
\DoxyCodeLine{import\ script\ from\ '/project/foo.vue?vue\&type=script'}
\DoxyCodeLine{//\ template\ compiled\ to\ render\ function}
\DoxyCodeLine{import\ \{\ render\ \}\ from\ '/project/foo.vue?vue\&type=template\&id=xxxxxx'}
\DoxyCodeLine{//\ css}
\DoxyCodeLine{import\ '/project/foo.vue?vue\&type=style\&index=0\&id=xxxxxx'}
\DoxyCodeLine{}
\DoxyCodeLine{//\ attach\ render\ function\ to\ script}
\DoxyCodeLine{script.render\ =\ render}
\DoxyCodeLine{}
\DoxyCodeLine{//\ attach\ additional\ metadata}
\DoxyCodeLine{//\ some\ of\ these\ should\ be\ dev\ only}
\DoxyCodeLine{script.\_\_file\ =\ 'example.vue'}
\DoxyCodeLine{script.\_\_scopeId\ =\ 'xxxxxx'}
\DoxyCodeLine{}
\DoxyCodeLine{//\ additional\ tooling-\/specific\ HMR\ handling\ code}
\DoxyCodeLine{//\ using\ \_\_VUE\_HMR\_API\_\_\ global}
\DoxyCodeLine{}
\DoxyCodeLine{export\ default\ script}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md7327}{}\doxysubsubsection{\texorpdfstring{High Level Workflow}{High Level Workflow}}\label{README.md_autotoc_md7327}

\begin{DoxyEnumerate}
\item In facade transform, parse the source into descriptor with the {\ttfamily parse} API and generate the above facade module code based on the descriptor;
\item In script transform, use {\ttfamily compile\+Script} to process the script. This handles features like {\ttfamily \texorpdfstring{$<$}{<}script setup\texorpdfstring{$>$}{>}} and CSS variable injection. Alternatively, this can be done directly in the facade module (with the code inlined instead of imported), but it will require rewriting {\ttfamily export default} to a temp variable (a {\ttfamily rewrite\+Default} convenience API is provided for this purpose) so additional options can be attached to the exported object.
\item In template transform, use {\ttfamily compile\+Template} to compile the raw template into render function code.
\item In style transform, use {\ttfamily compile\+Style} to compile raw CSS to handle {\ttfamily \texorpdfstring{$<$}{<}style scoped\texorpdfstring{$>$}{>}}, {\ttfamily \texorpdfstring{$<$}{<}style module\texorpdfstring{$>$}{>}} and CSS variable injection.
\end{DoxyEnumerate}

Options needed for these APIs can be passed via the query string.

For detailed API references and options, check out the source type definitions. For actual usage of these APIs, check out \href{https://github.com/vitejs/vite-plugin-vue/tree/main/packages/plugin-vue}{\texttt{ @vitejs/plugin-\/vue}} or \href{https://github.com/vuejs/vue-loader/tree/next}{\texttt{ vue-\/loader}}. 