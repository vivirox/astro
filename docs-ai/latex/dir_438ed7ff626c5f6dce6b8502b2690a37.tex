\doxysection{node\+\_\+modules/busboy Directory Reference}
\hypertarget{dir_438ed7ff626c5f6dce6b8502b2690a37}{}\label{dir_438ed7ff626c5f6dce6b8502b2690a37}\index{node\_modules/busboy Directory Reference@{node\_modules/busboy Directory Reference}}


\doxysubsection{Detailed Description}
A node.\+js module for parsing incoming HTML form data.

Changes (breaking or otherwise) in v1.\+0.\+0 can be found \href{https://github.com/mscdex/busboy/issues/266}{\texttt{ here}}.\hypertarget{README.md_autotoc_md9694}{}\doxysubsection{\texorpdfstring{Requirements}{Requirements}}\label{README.md_autotoc_md9694}

\begin{DoxyItemize}
\item \href{http://nodejs.org/}{\texttt{ node.\+js}} -- v10.\+16.\+0 or newer
\end{DoxyItemize}\hypertarget{README.md_autotoc_md9695}{}\doxysubsection{\texorpdfstring{Install}{Install}}\label{README.md_autotoc_md9695}
\begin{DoxyVerb}npm install busboy
\end{DoxyVerb}
\hypertarget{README.md_autotoc_md9696}{}\doxysubsection{\texorpdfstring{Examples}{Examples}}\label{README.md_autotoc_md9696}

\begin{DoxyItemize}
\item Parsing (multipart) with default options\+:
\end{DoxyItemize}


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ http\ =\ require('http');}
\DoxyCodeLine{}
\DoxyCodeLine{const\ busboy\ =\ require('busboy');}
\DoxyCodeLine{}
\DoxyCodeLine{http.createServer((req,\ res)\ =>\ \{}
\DoxyCodeLine{\ \ if\ (req.method\ ===\ 'POST')\ \{}
\DoxyCodeLine{\ \ \ \ console.log('POST\ request');}
\DoxyCodeLine{\ \ \ \ const\ bb\ =\ busboy(\{\ headers:\ req.headers\ \});}
\DoxyCodeLine{\ \ \ \ bb.on('file',\ (name,\ file,\ info)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ const\ \{\ filename,\ encoding,\ mimeType\ \}\ =\ info;}
\DoxyCodeLine{\ \ \ \ \ \ console.log(}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \`{}File\ [\$\{name\}]:\ filename:\ \%j,\ encoding:\ \%j,\ mimeType:\ \%j`,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ filename,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ encoding,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ mimeType}
\DoxyCodeLine{\ \ \ \ \ \ );}
\DoxyCodeLine{\ \ \ \ \ \ file.on('data',\ (data)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ console.log(`File\ [\$\{name\}]\ got\ \$\{data.length\}\ bytes`);}
\DoxyCodeLine{\ \ \ \ \ \ \}).on('close',\ ()\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ console.log(`File\ [\$\{name\}]\ done`);}
\DoxyCodeLine{\ \ \ \ \ \ \});}
\DoxyCodeLine{\ \ \ \ \});}
\DoxyCodeLine{\ \ \ \ bb.on('field',\ (name,\ val,\ info)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ console.log(`Field\ [\$\{name\}]:\ value:\ \%j`,\ val);}
\DoxyCodeLine{\ \ \ \ \});}
\DoxyCodeLine{\ \ \ \ bb.on('close',\ ()\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ console.log('Done\ parsing\ form!');}
\DoxyCodeLine{\ \ \ \ \ \ res.writeHead(303,\ \{\ Connection:\ 'close',\ Location:\ '/'\ \});}
\DoxyCodeLine{\ \ \ \ \ \ res.end();}
\DoxyCodeLine{\ \ \ \ \});}
\DoxyCodeLine{\ \ \ \ req.pipe(bb);}
\DoxyCodeLine{\ \ \}\ else\ if\ (req.method\ ===\ 'GET')\ \{}
\DoxyCodeLine{\ \ \ \ res.writeHead(200,\ \{\ Connection:\ 'close'\ \});}
\DoxyCodeLine{\ \ \ \ res.end(`}
\DoxyCodeLine{\ \ \ \ \ \ <html>}
\DoxyCodeLine{\ \ \ \ \ \ \ \ <head></head>}
\DoxyCodeLine{\ \ \ \ \ \ \ \ <body>}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ <form\ method="{}POST"{}\ enctype="{}multipart/form-\/data"{}>}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ <input\ type="{}file"{}\ name="{}filefield"{}><br\ />}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ <input\ type="{}text"{}\ name="{}textfield"{}><br\ />}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ <input\ type="{}submit"{}>}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ </form>}
\DoxyCodeLine{\ \ \ \ \ \ \ \ </body>}
\DoxyCodeLine{\ \ \ \ \ \ </html>}
\DoxyCodeLine{\ \ \ \ \`{});}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}).listen(8000,\ ()\ =>\ \{}
\DoxyCodeLine{\ \ console.log('Listening\ for\ requests');}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Example\ output:}
\DoxyCodeLine{//}
\DoxyCodeLine{//\ Listening\ for\ requests}
\DoxyCodeLine{//\ \ \ <\ ...\ form\ submitted\ ...\ >}
\DoxyCodeLine{//\ POST\ request}
\DoxyCodeLine{//\ File\ [filefield]:\ filename:\ "{}logo.jpg"{},\ encoding:\ "{}binary"{},\ mime:\ "{}image/jpeg"{}}
\DoxyCodeLine{//\ File\ [filefield]\ got\ 11912\ bytes}
\DoxyCodeLine{//\ Field\ [textfield]:\ value:\ "{}testing!\ :-\/)"{}}
\DoxyCodeLine{//\ File\ [filefield]\ done}
\DoxyCodeLine{//\ Done\ parsing\ form!}

\end{DoxyCode}



\begin{DoxyItemize}
\item Save all incoming files to disk\+:
\end{DoxyItemize}


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ \{\ randomFillSync\ \}\ =\ require('crypto');}
\DoxyCodeLine{const\ fs\ =\ require('fs');}
\DoxyCodeLine{const\ http\ =\ require('http');}
\DoxyCodeLine{const\ os\ =\ require('os');}
\DoxyCodeLine{const\ path\ =\ require('path');}
\DoxyCodeLine{}
\DoxyCodeLine{const\ busboy\ =\ require('busboy');}
\DoxyCodeLine{}
\DoxyCodeLine{const\ random\ =\ (()\ =>\ \{}
\DoxyCodeLine{\ \ const\ buf\ =\ Buffer.alloc(16);}
\DoxyCodeLine{\ \ return\ ()\ =>\ randomFillSync(buf).toString('hex');}
\DoxyCodeLine{\})();}
\DoxyCodeLine{}
\DoxyCodeLine{http.createServer((req,\ res)\ =>\ \{}
\DoxyCodeLine{\ \ if\ (req.method\ ===\ 'POST')\ \{}
\DoxyCodeLine{\ \ \ \ const\ bb\ =\ busboy(\{\ headers:\ req.headers\ \});}
\DoxyCodeLine{\ \ \ \ bb.on('file',\ (name,\ file,\ info)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ const\ saveTo\ =\ path.join(os.tmpdir(),\ \`{}busboy-\/upload-\/\$\{random()\}`);}
\DoxyCodeLine{\ \ \ \ \ \ file.pipe(fs.createWriteStream(saveTo));}
\DoxyCodeLine{\ \ \ \ \});}
\DoxyCodeLine{\ \ \ \ bb.on('close',\ ()\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ res.writeHead(200,\ \{\ 'Connection':\ 'close'\ \});}
\DoxyCodeLine{\ \ \ \ \ \ res.end(`That's\ all\ folks!`);}
\DoxyCodeLine{\ \ \ \ \});}
\DoxyCodeLine{\ \ \ \ req.pipe(bb);}
\DoxyCodeLine{\ \ \ \ return;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \ res.writeHead(404);}
\DoxyCodeLine{\ \ res.end();}
\DoxyCodeLine{\}).listen(8000,\ ()\ =>\ \{}
\DoxyCodeLine{\ \ console.log('Listening\ for\ requests');}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md9697}{}\doxysubsection{\texorpdfstring{API}{API}}\label{README.md_autotoc_md9697}
\hypertarget{README.md_autotoc_md9698}{}\doxysubsubsection{\texorpdfstring{Exports}{Exports}}\label{README.md_autotoc_md9698}
{\ttfamily busboy} exports a single function\+:

{\bfseries{( {\itshape function} )}}(\texorpdfstring{$<$}{<} {\itshape object} \texorpdfstring{$>$}{>}config) -\/ Creates and returns a new {\itshape Writable} form parser stream.


\begin{DoxyItemize}
\item Valid {\ttfamily config} properties\+:
\begin{DoxyItemize}
\item {\bfseries{headers}} -\/ {\itshape object} -\/ These are the HTTP headers of the incoming request, which are used by individual parsers.
\item {\bfseries{high\+Water\+Mark}} -\/ {\itshape integer} -\/ high\+Water\+Mark to use for the parser stream. {\bfseries{Default\+:}} node\textquotesingle{}s {\itshape stream.\+Writable} default.
\item {\bfseries{file\+Hwm}} -\/ {\itshape integer} -\/ high\+Water\+Mark to use for individual file streams. {\bfseries{Default\+:}} node\textquotesingle{}s {\itshape stream.\+Readable} default.
\item {\bfseries{def\+Charset}} -\/ {\itshape string} -\/ Default character set to use when one isn\textquotesingle{}t defined. {\bfseries{Default\+:}} `\textquotesingle{}utf8'\`{}.
\item {\bfseries{def\+Param\+Charset}} -\/ {\itshape string} -\/ For multipart forms, the default character set to use for values of part header parameters (e.\+g. filename) that are not extended parameters (that contain an explicit charset). {\bfseries{Default\+:}} `\textquotesingle{}latin1'\`{}.
\item {\bfseries{preserve\+Path}} -\/ {\itshape boolean} -\/ If paths in filenames from file parts in a `\textquotesingle{}multipart/form-\/data'{\ttfamily request shall be preserved. \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}\+Default\+:\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}false\`{}.
\item {\bfseries{limits}} -\/ {\itshape object} -\/ Various limits on incoming data. Valid properties are\+:
\begin{DoxyItemize}
\item {\bfseries{field\+Name\+Size}} -\/ {\itshape integer} -\/ Max field name size (in bytes). {\bfseries{Default\+:}} {\ttfamily 100}.
\item {\bfseries{field\+Size}} -\/ {\itshape integer} -\/ Max field value size (in bytes). {\bfseries{Default\+:}} {\ttfamily 1048576} (1MB).
\item {\bfseries{fields}} -\/ {\itshape integer} -\/ Max number of non-\/file fields. {\bfseries{Default\+:}} {\ttfamily Infinity}.
\item {\bfseries{file\+Size}} -\/ {\itshape integer} -\/ For multipart forms, the max file size (in bytes). {\bfseries{Default\+:}} {\ttfamily Infinity}.
\item {\bfseries{files}} -\/ {\itshape integer} -\/ For multipart forms, the max number of file fields. {\bfseries{Default\+:}} {\ttfamily Infinity}.
\item {\bfseries{parts}} -\/ {\itshape integer} -\/ For multipart forms, the max number of parts (fields + files). {\bfseries{Default\+:}} {\ttfamily Infinity}.
\item {\bfseries{header\+Pairs}} -\/ {\itshape integer} -\/ For multipart forms, the max number of header key-\/value pairs to parse. {\bfseries{Default\+:}} {\ttfamily 2000} (same as node\textquotesingle{}s http module).
\end{DoxyItemize}
\end{DoxyItemize}
\end{DoxyItemize}

This function can throw exceptions if there is something wrong with the values in {\ttfamily config}. For example, if the Content-\/\+Type in {\ttfamily headers} is missing entirely, is not a supported type, or is missing the boundary for `\textquotesingle{}multipart/form-\/data'\`{} requests.\hypertarget{README.md_autotoc_md9699}{}\doxysubsubsection{\texorpdfstring{(Special) Parser stream events}{(Special) Parser stream events}}\label{README.md_autotoc_md9699}

\begin{DoxyItemize}
\item {\bfseries{file}}(\texorpdfstring{$<$}{<} {\itshape string} \texorpdfstring{$>$}{>}name, \texorpdfstring{$<$}{<} {\itshape Readable} \texorpdfstring{$>$}{>}stream, \texorpdfstring{$<$}{<} {\itshape object} \texorpdfstring{$>$}{>}info) -\/ Emitted for each new file found. {\ttfamily name} contains the form field name. {\ttfamily stream} is a {\itshape Readable} stream containing the file\textquotesingle{}s data. No transformations/conversions (e.\+g. base64 to raw binary) are done on the file\textquotesingle{}s data. {\ttfamily info} contains the following properties\+:
\begin{DoxyItemize}
\item {\ttfamily filename} -\/ {\itshape string} -\/ If supplied, this contains the file\textquotesingle{}s filename. {\bfseries{WARNING\+:}} You should almost {\itshape never} use this value as-\/is (especially if you are using {\ttfamily preserve\+Path\+: true} in your {\ttfamily config}) as it could contain malicious input. You are better off generating your own (safe) filenames, or at the very least using a hash of the filename.
\item {\ttfamily encoding} -\/ {\itshape string} -\/ The file\textquotesingle{}s `\textquotesingle{}Content-\/\+Transfer-\/\+Encoding'\`{} value.
\item {\ttfamily mime\+Type} -\/ {\itshape string} -\/ The file\textquotesingle{}s `\textquotesingle{}Content-\/\+Type'\`{} value.
\end{DoxyItemize}

{\bfseries{Note\+:}} If you listen for this event, you should always consume the {\ttfamily stream} whether you care about its contents or not (you can simply do {\ttfamily stream.\+resume();} if you want to discard/skip the contents), otherwise the `\textquotesingle{}finish'{\ttfamily /}\textquotesingle{}close\textquotesingle{}{\ttfamily event will never fire on the busboy parser stream. However, if you aren\textquotesingle{}t accepting files, you can either simply not listen for the}\textquotesingle{}file\textquotesingle{}{\ttfamily event at all or set}limits.\+files{\ttfamily to}0{\ttfamily , and any/all files will be automatically skipped (these skipped files will still count towards any configured}limits.\+files{\ttfamily and}limits.\+parts\`{} limits though).

{\bfseries{Note\+:}} If a configured {\ttfamily limits.\+file\+Size} limit was reached for a file, {\ttfamily stream} will both have a boolean property {\ttfamily truncated} set to {\ttfamily true} (best checked at the end of the stream) and emit a `\textquotesingle{}limit'\`{} event to notify you when this happens.
\item {\bfseries{field}}(\texorpdfstring{$<$}{<} {\itshape string} \texorpdfstring{$>$}{>}name, \texorpdfstring{$<$}{<} {\itshape string} \texorpdfstring{$>$}{>}value, \texorpdfstring{$<$}{<} {\itshape object} \texorpdfstring{$>$}{>}info) -\/ Emitted for each new non-\/file field found. {\ttfamily name} contains the form field name. {\ttfamily value} contains the string value of the field. {\ttfamily info} contains the following properties\+:
\begin{DoxyItemize}
\item {\ttfamily name\+Truncated} -\/ {\itshape boolean} -\/ Whether {\ttfamily name} was truncated or not (due to a configured {\ttfamily limits.\+field\+Name\+Size} limit)
\item {\ttfamily value\+Truncated} -\/ {\itshape boolean} -\/ Whether {\ttfamily value} was truncated or not (due to a configured {\ttfamily limits.\+field\+Size} limit)
\item {\ttfamily encoding} -\/ {\itshape string} -\/ The field\textquotesingle{}s `\textquotesingle{}Content-\/\+Transfer-\/\+Encoding'\`{} value.
\item {\ttfamily mime\+Type} -\/ {\itshape string} -\/ The field\textquotesingle{}s `\textquotesingle{}Content-\/\+Type'\`{} value.
\end{DoxyItemize}
\item {\bfseries{parts\+Limit}}() -\/ Emitted when the configured {\ttfamily limits.\+parts} limit has been reached. No more `\textquotesingle{}file'{\ttfamily or}\textquotesingle{}field\textquotesingle{}\`{} events will be emitted.
\item {\bfseries{files\+Limit}}() -\/ Emitted when the configured {\ttfamily limits.\+files} limit has been reached. No more `\textquotesingle{}file'\`{} events will be emitted.
\item {\bfseries{fields\+Limit}}() -\/ Emitted when the configured {\ttfamily limits.\+fields} limit has been reached. No more `\textquotesingle{}field'\`{} events will be emitted. 
\end{DoxyItemize}