\doxysection{node\+\_\+modules/@octokit/auth-\/token Directory Reference}
\hypertarget{dir_8bad8137cf8861413253433b1c13cc8b}{}\label{dir_8bad8137cf8861413253433b1c13cc8b}\index{node\_modules/"@octokit/auth-\/token Directory Reference@{node\_modules/"@octokit/auth-\/token Directory Reference}}


\doxysubsection{Detailed Description}
\begin{quote}
Git\+Hub API token authentication for browsers and Node.\+js \end{quote}


\href{https://www.npmjs.com/package/@octokit/auth-token}{\texttt{ }} \href{https://github.com/octokit/auth-token.js/actions?query=workflow\%3ATest}{\texttt{ }}

{\ttfamily @octokit/auth-\/token} is the simplest of \href{https://github.com/octokit/auth.js}{\texttt{ Git\+Hub’s authentication strategies}}.

It is useful if you want to support multiple authentication strategies, as it’s API is compatible with its sibling packages for \href{https://github.com/octokit/auth-basic.js}{\texttt{ basic}}, \href{https://github.com/octokit/auth-app.js}{\texttt{ Git\+Hub App}} and \href{https://github.com/octokit/auth.js}{\texttt{ OAuth app}} authentication.


\begin{DoxyItemize}
\item \doxylink{readme.md_usage}{Usage}
\item \`{}create\+Token\+Auth(token) options\`{}
\item \`{}auth()\`{}
\item Authentication object
\item \`{}auth.hook(request, route, options)\`{} or \`{}auth.hook(request, options)\`{}
\item Find more information
\begin{DoxyItemize}
\item Find out what scopes are enabled for oauth tokens
\item Find out if token is a personal access token or if it belongs to an OAuth app
\item Find out what permissions are enabled for a repository
\item Use token for git operations
\end{DoxyItemize}
\item \doxylink{README.md_license}{License}
\end{DoxyItemize}\hypertarget{README.md_autotoc_md5195}{}\doxysubsection{\texorpdfstring{Usage}{Usage}}\label{README.md_autotoc_md5195}
\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Browsers }&

Load {\ttfamily @octokit/auth-\/token} directly from \href{https://esm.sh}{\texttt{ esm.\+sh}}


\begin{DoxyCode}{0}
\DoxyCodeLine{<script\ type="{}module"{}>}
\DoxyCodeLine{\ \ import\ \{\ createTokenAuth\ \}\ from\ "{}https://esm.sh/@octokit/auth-\/token"{};}
\DoxyCodeLine{</script>}

\end{DoxyCode}


\\\cline{1-2}
\cellcolor{\tableheadbgcolor}\textbf{ Node }&

Install with {\ttfamily npm install @octokit/auth-\/token}


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ createTokenAuth\ \}\ from\ "{}@octokit/auth-\/token"{};}

\end{DoxyCode}


\\\cline{1-2}
\end{longtabu}



\begin{DoxyCode}{0}
\DoxyCodeLine{const\ auth\ =\ createTokenAuth("{}ghp\_PersonalAccessToken01245678900000000"{});}
\DoxyCodeLine{const\ authentication\ =\ await\ auth();}
\DoxyCodeLine{//\ \{}
\DoxyCodeLine{//\ \ \ type:\ 'token',}
\DoxyCodeLine{//\ \ \ token:\ 'ghp\_PersonalAccessToken01245678900000000',}
\DoxyCodeLine{//\ \ \ tokenType:\ 'oauth'}
\DoxyCodeLine{//\ \}}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md5196}{}\doxysubsection{\texorpdfstring{{\ttfamily create\+Token\+Auth(token) options}}{{\ttfamily create\+Token\+Auth(token) options}}}\label{README.md_autotoc_md5196}
The {\ttfamily create\+Token\+Auth} method accepts a single argument of type string, which is the token. The passed token can be one of the following\+:


\begin{DoxyItemize}
\item \href{https://help.github.com/en/articles/creating-a-personal-access-token-for-the-command-line}{\texttt{ Personal access token}}
\item \href{https://developer.github.com/apps/building-oauth-apps/authorizing-oauth-apps/}{\texttt{ OAuth access token}}
\item \href{https://developer.github.com/actions/creating-github-actions/accessing-the-runtime-environment/\#environment-variables}{\texttt{ GITHUB\+\_\+\+TOKEN provided to Git\+Hub Actions}}
\item Installation access token (\href{https://developer.github.com/apps/building-github-apps/authenticating-with-github-apps/\#authenticating-as-an-installation}{\texttt{ server-\/to-\/server}})
\item User authentication for installation (\href{https://docs.github.com/en/developers/apps/building-github-apps/identifying-and-authorizing-users-for-github-apps}{\texttt{ user-\/to-\/server}})
\end{DoxyItemize}

Examples


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Personal\ access\ token\ or\ OAuth\ access\ token}
\DoxyCodeLine{createTokenAuth("{}ghp\_PersonalAccessToken01245678900000000"{});}
\DoxyCodeLine{//\ \{}
\DoxyCodeLine{//\ \ \ type:\ 'token',}
\DoxyCodeLine{//\ \ \ token:\ 'ghp\_PersonalAccessToken01245678900000000',}
\DoxyCodeLine{//\ \ \ tokenType:\ 'oauth'}
\DoxyCodeLine{//\ \}}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Installation\ access\ token\ or\ GitHub\ Action\ token}
\DoxyCodeLine{createTokenAuth("{}ghs\_InstallallationOrActionToken00000000"{});}
\DoxyCodeLine{//\ \{}
\DoxyCodeLine{//\ \ \ type:\ 'token',}
\DoxyCodeLine{//\ \ \ token:\ 'ghs\_InstallallationOrActionToken00000000',}
\DoxyCodeLine{//\ \ \ tokenType:\ 'installation'}
\DoxyCodeLine{//\ \}}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Installation\ access\ token\ or\ GitHub\ Action\ token}
\DoxyCodeLine{createTokenAuth("{}ghu\_InstallationUserToServer000000000000"{});}
\DoxyCodeLine{//\ \{}
\DoxyCodeLine{//\ \ \ type:\ 'token',}
\DoxyCodeLine{//\ \ \ token:\ 'ghu\_InstallationUserToServer000000000000',}
\DoxyCodeLine{//\ \ \ tokenType:\ 'user-\/to-\/server'}
\DoxyCodeLine{//\ \}}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md5197}{}\doxysubsection{\texorpdfstring{{\ttfamily auth()}}{{\ttfamily auth()}}}\label{README.md_autotoc_md5197}
The {\ttfamily auth()} method has no options. It returns a promise which resolves with the the authentication object.\hypertarget{README.md_autotoc_md5198}{}\doxysubsection{\texorpdfstring{Authentication object}{Authentication object}}\label{README.md_autotoc_md5198}
\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ name  }&\cellcolor{\tableheadbgcolor}\textbf{ type  }&\cellcolor{\tableheadbgcolor}\textbf{ description     }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ name  }&\cellcolor{\tableheadbgcolor}\textbf{ type  }&\cellcolor{\tableheadbgcolor}\textbf{ description     }\\\cline{1-3}
\endhead
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily type}  }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily string}  }&{\ttfamily "{}token"{}}   \\\cline{1-3}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily token}  }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily string}  }&The provided token.   \\\cline{1-3}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily token\+Type}  }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily string}  }&Can be either {\ttfamily "{}oauth"{}} for personal access tokens and OAuth tokens, {\ttfamily "{}installation"{}} for installation access tokens (includes {\ttfamily GITHUB\+\_\+\+TOKEN} provided to Git\+Hub Actions), {\ttfamily "{}app"{}} for a Git\+Hub App JSON Web Token, or {\ttfamily "{}user-\/to-\/server"{}} for a user authentication token through an app installation.    \\\cline{1-3}
\end{longtabu}
\hypertarget{README.md_autotoc_md5199}{}\doxysubsection{\texorpdfstring{{\ttfamily auth.\+hook(request, route, options)} or {\ttfamily auth.\+hook(request, options)}}{{\ttfamily auth.\+hook(request, route, options)} or {\ttfamily auth.\+hook(request, options)}}}\label{README.md_autotoc_md5199}
{\ttfamily auth.\+hook()} hooks directly into the request life cycle. It authenticates the request using the provided token.

The {\ttfamily request} option is an instance of \href{https://github.com/octokit/request.js\#readme}{\texttt{ {\ttfamily @octokit/request}}}. The {\ttfamily route}/{\ttfamily options} parameters are the same as for the \href{https://github.com/octokit/request.js\#request}{\texttt{ {\ttfamily request()} method}}.

{\ttfamily auth.\+hook()} can be called directly to send an authenticated request


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ \{\ data:\ authorizations\ \}\ =\ await\ auth.hook(}
\DoxyCodeLine{\ \ request,}
\DoxyCodeLine{\ \ "{}GET\ /authorizations"{},}
\DoxyCodeLine{);}

\end{DoxyCode}


Or it can be passed as option to \href{https://github.com/octokit/request.js\#request}{\texttt{ {\ttfamily request()}}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ requestWithAuth\ =\ request.defaults(\{}
\DoxyCodeLine{\ \ request:\ \{}
\DoxyCodeLine{\ \ \ \ hook:\ auth.hook,}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{const\ \{\ data:\ authorizations\ \}\ =\ await\ requestWithAuth("{}GET\ /authorizations"{});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md5200}{}\doxysubsection{\texorpdfstring{Find more information}{Find more information}}\label{README.md_autotoc_md5200}
{\ttfamily auth()} does not send any requests, it only transforms the provided token string into an authentication object.

Here is a list of things you can do to retrieve further information\hypertarget{README.md_autotoc_md5201}{}\doxysubsubsection{\texorpdfstring{Find out what scopes are enabled for oauth tokens}{Find out what scopes are enabled for oauth tokens}}\label{README.md_autotoc_md5201}
Note that this does not work for installations. There is no way to retrieve permissions based on an installation access tokens.


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ TOKEN\ =\ "{}ghp\_PersonalAccessToken01245678900000000"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ auth\ =\ createTokenAuth(TOKEN);}
\DoxyCodeLine{const\ authentication\ =\ await\ auth();}
\DoxyCodeLine{}
\DoxyCodeLine{const\ response\ =\ await\ request("{}HEAD\ /"{});}
\DoxyCodeLine{const\ scopes\ =\ response.headers["{}x-\/oauth-\/scopes"{}].split(/,\(\backslash\)s+/);}
\DoxyCodeLine{}
\DoxyCodeLine{if\ (scopes.length)\ \{}
\DoxyCodeLine{\ \ console.log(}
\DoxyCodeLine{\ \ \ \ \`{}"{}\$\{TOKEN\}"{}\ has\ \$\{scopes.length\}\ scopes\ enabled:\ \$\{scopes.join("{},\ "{})\}`,}
\DoxyCodeLine{\ \ );}
\DoxyCodeLine{\}\ else\ \{}
\DoxyCodeLine{\ \ console.log(`"{}\$\{TOKEN\}"{}\ has\ no\ scopes\ enabled`);}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md5202}{}\doxysubsubsection{\texorpdfstring{Find out if token is a personal access token or if it belongs to an OAuth app}{Find out if token is a personal access token or if it belongs to an OAuth app}}\label{README.md_autotoc_md5202}

\begin{DoxyCode}{0}
\DoxyCodeLine{const\ TOKEN\ =\ "{}ghp\_PersonalAccessToken01245678900000000"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ auth\ =\ createTokenAuth(TOKEN);}
\DoxyCodeLine{const\ authentication\ =\ await\ auth();}
\DoxyCodeLine{}
\DoxyCodeLine{const\ response\ =\ await\ request("{}HEAD\ /"{});}
\DoxyCodeLine{const\ clientId\ =\ response.headers["{}x-\/oauth-\/client-\/id"{}];}
\DoxyCodeLine{}
\DoxyCodeLine{if\ (clientId)\ \{}
\DoxyCodeLine{\ \ console.log(}
\DoxyCodeLine{\ \ \ \ \`{}"{}\$\{token\}"{}\ is\ an\ OAuth\ token,\ its\ app’s\ client\_id\ is\ \$\{clientId\}.`,}
\DoxyCodeLine{\ \ );}
\DoxyCodeLine{\}\ else\ \{}
\DoxyCodeLine{\ \ console.log(`"{}\$\{token\}"{}\ is\ a\ personal\ access\ token`);}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md5203}{}\doxysubsubsection{\texorpdfstring{Find out what permissions are enabled for a repository}{Find out what permissions are enabled for a repository}}\label{README.md_autotoc_md5203}
Note that the {\ttfamily permissions} key is not set when authenticated using an installation access token.


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ TOKEN\ =\ "{}ghp\_PersonalAccessToken01245678900000000"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ auth\ =\ createTokenAuth(TOKEN);}
\DoxyCodeLine{const\ authentication\ =\ await\ auth();}
\DoxyCodeLine{}
\DoxyCodeLine{const\ response\ =\ await\ request("{}GET\ /repos/\{owner\}/\{repo\}"{},\ \{}
\DoxyCodeLine{\ \ owner:\ "{}octocat"{},}
\DoxyCodeLine{\ \ repo:\ "{}hello-\/world"{},}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{console.log(response.data.permissions);}
\DoxyCodeLine{//\ \{}
\DoxyCodeLine{//\ \ \ admin:\ true,}
\DoxyCodeLine{//\ \ \ push:\ true,}
\DoxyCodeLine{//\ \ \ pull:\ true}
\DoxyCodeLine{//\ \}}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md5204}{}\doxysubsubsection{\texorpdfstring{Use token for git operations}{Use token for git operations}}\label{README.md_autotoc_md5204}
Both OAuth and installation access tokens can be used for git operations. However, when using with an installation, \href{https://developer.github.com/apps/building-github-apps/authenticating-with-github-apps/\#http-based-git-access-by-an-installation}{\texttt{ the token must be prefixed with {\ttfamily x-\/access-\/token}}}.

This example is using the \href{https://github.com/sindresorhus/execa}{\texttt{ {\ttfamily execa}}} package to run a {\ttfamily git push} command.


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ TOKEN\ =\ "{}ghp\_PersonalAccessToken01245678900000000"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ auth\ =\ createTokenAuth(TOKEN);}
\DoxyCodeLine{const\ \{\ token,\ tokenType\ \}\ =\ await\ auth();}
\DoxyCodeLine{const\ tokenWithPrefix\ =}
\DoxyCodeLine{\ \ tokenType\ ===\ "{}installation"{}\ ?\ \`{}x-\/access-\/token:\$\{token\}`\ :\ token;}
\DoxyCodeLine{}
\DoxyCodeLine{const\ repositoryUrl\ =\ \`{}https://\$\{tokenWithPrefix\}@github.com/octocat/hello-\/world.git`;}
\DoxyCodeLine{}
\DoxyCodeLine{const\ \{\ stdout\ \}\ =\ await\ execa("{}git"{},\ ["{}push"{},\ repositoryUrl]);}
\DoxyCodeLine{console.log(stdout);}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md5205}{}\doxysubsection{\texorpdfstring{License}{License}}\label{README.md_autotoc_md5205}
\mbox{[}MIT\mbox{]}(LICENSE) 