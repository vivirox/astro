\doxysection{node\+\_\+modules/universal-\/github-\/app-\/jwt Directory Reference}
\hypertarget{dir_d0497afd195553e089e0382b32ba3d4b}{}\label{dir_d0497afd195553e089e0382b32ba3d4b}\index{node\_modules/universal-\/github-\/app-\/jwt Directory Reference@{node\_modules/universal-\/github-\/app-\/jwt Directory Reference}}


\doxysubsection{Detailed Description}
\begin{quote}
Calculate Git\+Hub App bearer tokens for Node, Deno, and modern browsers \end{quote}


\href{https://www.npmjs.com/universal-github-app-jwt}{\texttt{ }} \href{https://github.com/gr2m/universal-github-app-jwt/actions?query=workflow\%3ATest+branch\%3Amaster}{\texttt{ }}\hypertarget{README.md_autotoc_md34465}{}\doxysubsection{\texorpdfstring{Usage}{Usage}}\label{README.md_autotoc_md34465}
\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Browsers }&Load {\ttfamily universal-\/github-\/app-\/jwt} directly from \href{https://esm.sh}{\texttt{ esm.\+sh}}


\begin{DoxyCode}{0}
\DoxyCodeLine{<script\ type="{}module"{}>}
\DoxyCodeLine{import\ githubAppJwt\ from\ "{}https://esm.sh/universal-\/github-\/app-\/jwt"{};}
\DoxyCodeLine{</script>}

\end{DoxyCode}


\\\cline{1-2}
\cellcolor{\tableheadbgcolor}\textbf{ Node }&

Install with {\ttfamily npm install universal-\/github-\/app-\/jwt}


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ githubAppJwt\ from\ "{}universal-\/github-\/app-\/jwt"{};}

\end{DoxyCode}


\\\cline{1-2}
\cellcolor{\tableheadbgcolor}\textbf{ Deno }&

Load {\ttfamily universal-\/github-\/app-\/jwt} directly from \href{https://esm.sh}{\texttt{ esm.\+sh}}, including types.


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ githubAppJwt\ from\ "{}https://esm.sh/universal-\/github-\/app-\/jwt"{};}

\end{DoxyCode}


\\\cline{1-2}
\end{longtabu}



\begin{DoxyCode}{0}
\DoxyCodeLine{const\ \{\ token,\ appId,\ expiration\ \}\ =\ await\ githubAppJwt(\{}
\DoxyCodeLine{\ \ id:\ APP\_ID,}
\DoxyCodeLine{\ \ privateKey:\ PRIVATE\_KEY,}
\DoxyCodeLine{\});}

\end{DoxyCode}


The retrieved {\ttfamily token} can now be used in Authorization request header, e.\+g. with \href{https://github.com/octokit/request.js/\#readme}{\texttt{ {\ttfamily @octokit/request}}}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{request("{}GET\ /app"{},\ \{}
\DoxyCodeLine{\ \ headers:\ \{}
\DoxyCodeLine{\ \ \ \ authorization:\ \`{}bearer\ \$\{token\}`,}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\});}

\end{DoxyCode}


For a complete implementation of Git\+Hub App authentication strategies, see \href{https://github.com/octokit/auth-app.js/\#readme}{\texttt{ {\ttfamily @octokit/auth-\/app.\+js}}}.\hypertarget{README.md_autotoc_md34466}{}\doxysubsection{\texorpdfstring{{\ttfamily github\+App\+Jwt(options)}}{{\ttfamily github\+App\+Jwt(options)}}}\label{README.md_autotoc_md34466}
\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ name  }&\cellcolor{\tableheadbgcolor}\textbf{ type  }&\cellcolor{\tableheadbgcolor}\textbf{ description     }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ name  }&\cellcolor{\tableheadbgcolor}\textbf{ type  }&\cellcolor{\tableheadbgcolor}\textbf{ description     }\\\cline{1-3}
\endhead
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily options.\+id}  }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily number \texorpdfstring{$\vert$}{|} string}  }&{\bfseries{Required}}. The Git\+Hub App\textquotesingle{}s ID or Client ID. For {\ttfamily github.\+com} and GHES 3.\+14+, it is recommended to use the Client ID.   \\\cline{1-3}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily options.\+private\+Key}  }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily string}  }&{\bfseries{Required}}. Content of the {\ttfamily \texorpdfstring{$\ast$}{*}.pem} file you downloaded from the appâ€™s about page. You can generate a new private key if needed. Make sure to preserve the line breaks. If your private key contains escaped newlines ({\ttfamily \textbackslash{}\textbackslash{}n}), they will be automatically replaced with actual newlines.   \\\cline{1-3}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily options.\+now}  }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily number}  }&An optional override for the current time in seconds since the UNIX epoch. Defaults to {\ttfamily Math.\+floor(Date.\+now() / 1000))}. This value can be overridden to account for a time skew between the local machine and the authentication server.    \\\cline{1-3}
\end{longtabu}


{\ttfamily github\+App\+Jwt(options)} resolves with an object with the following keys

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ name  }&\cellcolor{\tableheadbgcolor}\textbf{ type  }&\cellcolor{\tableheadbgcolor}\textbf{ description     }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ name  }&\cellcolor{\tableheadbgcolor}\textbf{ type  }&\cellcolor{\tableheadbgcolor}\textbf{ description     }\\\cline{1-3}
\endhead
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily token}  }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily string}  }&The JSON Web Token (JWT) to authenticate as the app.   \\\cline{1-3}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily app\+Id}  }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily number}  }&The Git\+Hub App database ID or Client ID passed in {\ttfamily options.\+id}.   \\\cline{1-3}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily expiration}  }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily number}  }&Timestamp as UNIX epoch, e.\+g. {\ttfamily 1530922170}. A Date object can be created using {\ttfamily new Date(authentication.\+expiration)}.    \\\cline{1-3}
\end{longtabu}


\label{README.md_private-key-formats}%
\Hypertarget{README.md_private-key-formats}%
\hypertarget{README.md_autotoc_md34467}{}\doxysubsection{\texorpdfstring{About Private Key formats}{About Private Key formats}}\label{README.md_autotoc_md34467}
When downloading a {\ttfamily private-\/key.\+pem} file from Git\+Hub, the format is in {\ttfamily PKCS\#1} format. Unfortunately, the Web\+Crypto API only supports {\ttfamily PKCS\#8}.

If you use 1Password to store a private key as an SSH key, it will be transformed to the {\ttfamily Open\+SSH} format, which is also not supported by Web\+Crypto.

You can identify the format based on the the first line

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ First Line   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Format    }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ First Line   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Format    }\\\cline{1-2}
\endhead
{\ttfamily -\/-\/-\/-\/-\/BEGIN RSA PRIVATE KEY-\/-\/-\/-\/-\/}   &PKCS\#1    \\\cline{1-2}
{\ttfamily -\/-\/-\/-\/-\/BEGIN PRIVATE KEY-\/-\/-\/-\/-\/}   &PKCS\#8    \\\cline{1-2}
{\ttfamily -\/-\/-\/-\/-\/BEGIN OPENSSH PRIVATE KEY-\/-\/-\/-\/-\/}   &Open\+SSH   \\\cline{1-2}
\end{longtabu}
\hypertarget{README.md_autotoc_md34468}{}\doxysubsubsection{\texorpdfstring{Converting {\ttfamily PKCS\#1} to {\ttfamily PKCS\#8}}{Converting {\ttfamily PKCS\#1} to {\ttfamily PKCS\#8}}}\label{README.md_autotoc_md34468}

\begin{DoxyItemize}
\item \#\#\#\# Using an Online Private Key Converter
\end{DoxyItemize}

Convert quickly using the Web interface at \href{https://private-key-converter.vercel.app}{\texttt{ https\+://private-\/key-\/converter.\+vercel.\+app}}


\begin{DoxyItemize}
\item \#\#\#\# Using Node.\+js
\end{DoxyItemize}

If you use Node.\+js, you can convert the format before passing it to {\ttfamily universal-\/github-\/app-\/jwt}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ crypto\ from\ "{}node:crypto"{};}
\DoxyCodeLine{import\ githubAppJwt\ from\ "{}universal-\/github-\/app-\/jwt"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ privateKeyPkcs8\ =\ crypto}
\DoxyCodeLine{\ \ .createPrivateKey(process.env.PRIVATE\_KEY)}
\DoxyCodeLine{\ \ .export(\{}
\DoxyCodeLine{\ \ \ \ type:\ "{}pkcs8"{},}
\DoxyCodeLine{\ \ \ \ format:\ "{}pem"{},}
\DoxyCodeLine{\ \ \});}
\DoxyCodeLine{}
\DoxyCodeLine{const\ \{\ token,\ appId,\ expiration\ \}\ =\ await\ githubAppJwt(\{}
\DoxyCodeLine{\ \ id:\ process.env.APP\_ID,}
\DoxyCodeLine{\ \ privateKey:\ privateKeyPkcs8,}
\DoxyCodeLine{\});}

\end{DoxyCode}



\begin{DoxyItemize}
\item \#\#\#\# Using Open\+SSL
\end{DoxyItemize}

Convert the format using {\ttfamily openssl} before passing it to your app.


\begin{DoxyCode}{0}
\DoxyCodeLine{openssl\ pkcs8\ -\/topk8\ -\/inform\ PEM\ -\/outform\ PEM\ -\/nocrypt\ -\/in\ private-\/key.pem\ -\/out\ private-\/key-\/pkcs8.key}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md34469}{}\doxysubsubsection{\texorpdfstring{Converting {\ttfamily Open\+SSH} to {\ttfamily PKCS\#8}}{Converting {\ttfamily Open\+SSH} to {\ttfamily PKCS\#8}}}\label{README.md_autotoc_md34469}

\begin{DoxyCode}{0}
\DoxyCodeLine{cp\ private-\/key.pem\ private-\/key-\/pkcs8.key\ \&\&\ ssh-\/keygen\ -\/p\ -\/m\ PKCS8\ \ -\/N\ "{}"{}\ -\/f\ private-\/key-\/pkcs8.key}

\end{DoxyCode}


This command forces a format change by asking {\ttfamily ssh-\/keygen} to set no password and then output in a different format.

I\textquotesingle{}m looking for help to create a minimal {\ttfamily Open\+SSH} to {\ttfamily PKCS} convert library that I can recommend people to use before passing the private key to {\ttfamily github\+App\+Jwt}. Please create an issue if you\textquotesingle{}d like to help.\hypertarget{README.md_autotoc_md34470}{}\doxysubsection{\texorpdfstring{License}{License}}\label{README.md_autotoc_md34470}
\mbox{[}MIT\mbox{]}(LICENSE) 