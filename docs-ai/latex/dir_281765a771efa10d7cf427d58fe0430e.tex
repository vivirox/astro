\doxysection{node\+\_\+modules/@shikijs/engine-\/javascript/node\+\_\+modules/regex-\/recursion Directory Reference}
\hypertarget{dir_281765a771efa10d7cf427d58fe0430e}{}\label{dir_281765a771efa10d7cf427d58fe0430e}\index{node\_modules/"@shikijs/engine-\/javascript/node\_modules/regex-\/recursion Directory Reference@{node\_modules/"@shikijs/engine-\/javascript/node\_modules/regex-\/recursion Directory Reference}}


\doxysubsection{Detailed Description}
\href{https://npmjs.com/package/regex-recursion}{\texttt{ }} \href{https://bundlejs.com/?q=regex-recursion&treeshake=[*]}{\texttt{ }}

This is an official plugin for \href{https://github.com/slevithan/regex}{\texttt{ Regex+}} that adds support for recursive matching up to a specified max depth {\itshape N}, where {\itshape N} can be between 2 and 100. Generated regexes are native Java\+Script {\ttfamily Reg\+Exp} instances.

Recursive matching is added to a regex via one of the following (the recursion depth limit is provided in place of {\itshape {\ttfamily N}})\+:


\begin{DoxyItemize}
\item {\ttfamily (?R=N)} — Recursively match the entire regex at this position.
\item {\ttfamily \textbackslash{}g\texorpdfstring{$<$}{<}name\&R=N\texorpdfstring{$>$}{>}} or {\ttfamily \textbackslash{}g\texorpdfstring{$<$}{<}number\&R=N\texorpdfstring{$>$}{>}} — Recursively match the contents of the group referenced by name or number at this position.
\begin{DoxyItemize}
\item The {\ttfamily \textbackslash{}g} subroutine must be {\itshape within} the referenced group.
\end{DoxyItemize}
\end{DoxyItemize}

Multiple uses of recursion within the same pattern are allowed if they are non-\/overlapping. Named captures and backreferences are supported within recursion, and are independent per depth level. So e.\+g. {\ttfamily groups.\+name} on a match object is the value captured by group {\ttfamily name} at the top level of the recursion stack.\hypertarget{README.md_autotoc_md5849}{}\doxysubsection{\texorpdfstring{Install and use}{Install and use}}\label{README.md_autotoc_md5849}

\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ install\ regex\ regex-\/recursion}

\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{regex\}\ from\ 'regex';}
\DoxyCodeLine{import\ \{recursion\}\ from\ 'regex-\/recursion';}
\DoxyCodeLine{}
\DoxyCodeLine{const\ re\ =\ regex(\{plugins:\ [recursion]\})`…`;}

\end{DoxyCode}




{\bfseries{Using a global name (no import)}}\begin{adjustwidth}{1em}{0em}



\begin{DoxyCode}{0}
\DoxyCodeLine{<script\ src="{}https://cdn.jsdelivr.net/npm/regex@5.1.1/dist/regex.min.js"{}></script>}
\DoxyCodeLine{<script\ src="{}https://cdn.jsdelivr.net/npm/regex-\/recursion@5.1.1/dist/regex-\/recursion.min.js"{}></script>}
\DoxyCodeLine{<script>}
\DoxyCodeLine{\ \ const\ \{regex\}\ =\ Regex;}
\DoxyCodeLine{\ \ const\ \{recursion\}\ =\ Regex.plugins;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ const\ re\ =\ regex(\{plugins:\ [recursion]\})`…`;}
\DoxyCodeLine{</script>}

\end{DoxyCode}
 \end{adjustwidth}
\hypertarget{README.md_autotoc_md5850}{}\doxysubsection{\texorpdfstring{Examples}{Examples}}\label{README.md_autotoc_md5850}
\hypertarget{README.md_autotoc_md5851}{}\doxysubsubsection{\texorpdfstring{Match an equal number of two different subpatterns}{Match an equal number of two different subpatterns}}\label{README.md_autotoc_md5851}
\hypertarget{README.md_autotoc_md5852}{}\doxysubsubsubsection{\texorpdfstring{Anywhere within a string}{Anywhere within a string}}\label{README.md_autotoc_md5852}

\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Matches\ sequences\ of\ up\ to\ 50\ 'a'\ chars\ followed\ by\ the\ same\ number\ of\ 'b'}
\DoxyCodeLine{const\ re\ =\ regex(\{plugins:\ [recursion]\})`a(?R=50)?b`;}
\DoxyCodeLine{re.exec('test\ aaaaaabbb')[0];}
\DoxyCodeLine{//\ →\ 'aaabbb'}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md5853}{}\doxysubsubsubsection{\texorpdfstring{As the entire string}{As the entire string}}\label{README.md_autotoc_md5853}

\begin{DoxyCode}{0}
\DoxyCodeLine{const\ re\ =\ regex(\{plugins:\ [recursion]\})`\string^}
\DoxyCodeLine{\ \ (?<balanced>}
\DoxyCodeLine{\ \ \ \ a}
\DoxyCodeLine{\ \ \ \ \#\ Recursively\ match\ just\ the\ specified\ group}
\DoxyCodeLine{\ \ \ \ \(\backslash\)g<balanced\&R=50>?}
\DoxyCodeLine{\ \ \ \ b}
\DoxyCodeLine{\ \ )}
\DoxyCodeLine{\$`;}
\DoxyCodeLine{re.test('aaabbb');\ //\ →\ true}
\DoxyCodeLine{re.test('aaabb');\ //\ →\ false}

\end{DoxyCode}


Notice the {\ttfamily \texorpdfstring{$^\wedge$}{\string^}} and {\ttfamily \$} anchors outside of the recursive subpattern.\hypertarget{README.md_autotoc_md5854}{}\doxysubsubsection{\texorpdfstring{Match balanced parentheses}{Match balanced parentheses}}\label{README.md_autotoc_md5854}

\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Matches\ all\ balanced\ parentheses\ up\ to\ depth\ 50}
\DoxyCodeLine{const\ parens\ =\ regex(\{flags:\ 'g',\ plugins:\ [recursion]\})`}
\DoxyCodeLine{\ \ \(\backslash\)(\ (\ [\string^\(\backslash\)(\(\backslash\))]\ |\ (?R=50)\ )*\ \(\backslash\))}
\DoxyCodeLine{\`{};}
\DoxyCodeLine{}
\DoxyCodeLine{'test\ )\ (balanced\ ((parens)))\ ()\ ((a))\ (\ (b)'.match(parens);}
\DoxyCodeLine{/*\ →\ [}
\DoxyCodeLine{\ \ '(balanced\ ((parens)))',}
\DoxyCodeLine{\ \ '()',}
\DoxyCodeLine{\ \ '((a))',}
\DoxyCodeLine{\ \ '(b)'}
\DoxyCodeLine{]\ */}

\end{DoxyCode}


Following is an alternative that matches the same strings, but adds a nested quantifier. It then uses an atomic group to prevent this nested quantifier from creating the potential for \href{https://www.regular-expressions.info/catastrophic.html}{\texttt{ catastrophic backtracking}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ parens\ =\ regex(\{flags:\ 'g',\ plugins:\ [recursion]\})`}
\DoxyCodeLine{\ \ \(\backslash\)(\ (\ (?>\ [\string^\(\backslash\)(\(\backslash\))]+\ )\ |\ (?R=50)\ )*\ \(\backslash\))}
\DoxyCodeLine{\`{};}

\end{DoxyCode}


This matches sequences of non-\/parens in one step with the nested {\ttfamily +} quantifier, and avoids backtracking into these sequences by wrapping it with an atomic group {\ttfamily (?\texorpdfstring{$>$}{>}…)}. Given that what the nested quantifier {\ttfamily +} matches overlaps with what the outer group can match with its {\ttfamily \texorpdfstring{$\ast$}{*}} quantifier, the atomic group is important here. It avoids exponential backtracking when matching long strings with unbalanced parens.

\href{https://github.com/slevithan/regex\#atomic-groups}{\texttt{ Atomic groups}} are provided by the base {\ttfamily regex} library.\hypertarget{README.md_autotoc_md5855}{}\doxysubsubsection{\texorpdfstring{Match palindromes}{Match palindromes}}\label{README.md_autotoc_md5855}
\hypertarget{README.md_autotoc_md5856}{}\doxysubsubsubsection{\texorpdfstring{Match palindromes anywhere within a string}{Match palindromes anywhere within a string}}\label{README.md_autotoc_md5856}

\begin{DoxyCode}{0}
\DoxyCodeLine{const\ palindromes\ =\ regex(\{flags:\ 'gi',\ plugins:\ [recursion]\})`}
\DoxyCodeLine{\ \ (?<char>\ \(\backslash\)w\ )}
\DoxyCodeLine{\ \ \#\ Recurse,\ or\ match\ a\ lone\ unbalanced\ char\ in\ the\ middle}
\DoxyCodeLine{\ \ (\ (?R=15)\ |\ \(\backslash\)w?\ )}
\DoxyCodeLine{\ \ \(\backslash\)k<char>}
\DoxyCodeLine{\`{};}
\DoxyCodeLine{}
\DoxyCodeLine{'Racecar,\ ABBA,\ and\ redivided'.match(palindromes);}
\DoxyCodeLine{//\ →\ ['Racecar',\ 'ABBA',\ 'edivide']}

\end{DoxyCode}


In the example above, the max length of matched palindromes is 31. That\textquotesingle{}s because it sets the max recursion depth to 15 with {\ttfamily (?R=15)}. So, depth 15 × 2 chars (left + right) for each depth level + 1 optional unbalanced char in the middle = 31. To match longer palindromes, the max recursion depth can be increased to a max of 100, which would enable matching palindromes up to 201 characters long.\hypertarget{README.md_autotoc_md5857}{}\doxysubsubsubsection{\texorpdfstring{Match palindromes as complete words}{Match palindromes as complete words}}\label{README.md_autotoc_md5857}

\begin{DoxyCode}{0}
\DoxyCodeLine{const\ palindromeWords\ =\ regex(\{flags:\ 'gi',\ plugins:\ [recursion]\})`\(\backslash\)b}
\DoxyCodeLine{\ \ (?<palindrome>}
\DoxyCodeLine{\ \ \ \ (?<char>\ \(\backslash\)w\ )}
\DoxyCodeLine{\ \ \ \ (\ \(\backslash\)g<palindrome\&R=15>\ |\ \(\backslash\)w?\ )}
\DoxyCodeLine{\ \ \ \ \(\backslash\)k<char>}
\DoxyCodeLine{\ \ )}
\DoxyCodeLine{\(\backslash\)b`;}
\DoxyCodeLine{}
\DoxyCodeLine{'Racecar,\ ABBA,\ and\ redivided'.match(palindromeWords);}
\DoxyCodeLine{//\ →\ ['Racecar',\ 'ABBA']}

\end{DoxyCode}


Notice the {\ttfamily \textbackslash{}b} word boundaries outside of the recursive subpattern. 