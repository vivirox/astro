\doxysection{node\+\_\+modules/diff-\/sequences Directory Reference}
\hypertarget{dir_5ede41af7a3990c0837044364c29c189}{}\label{dir_5ede41af7a3990c0837044364c29c189}\index{node\_modules/diff-\/sequences Directory Reference@{node\_modules/diff-\/sequences Directory Reference}}


\doxysubsection{Detailed Description}
Compare items in two sequences to find a {\bfseries{longest common subsequence}}.

The items not in common are the items to delete or insert in a {\bfseries{shortest edit script}}.

To maximize flexibility and minimize memory, you write {\bfseries{callback}} functions as configuration\+:

{\bfseries{Input}} function {\ttfamily is\+Common(a\+Index, b\+Index)} compares items at indexes in the sequences and returns a truthy/falsey value. This package might call your function more than once for some pairs of indexes.


\begin{DoxyItemize}
\item Because your function encapsulates {\bfseries{comparison}}, this package can compare items according to {\ttfamily ===} operator, {\ttfamily Object.\+is} method, or other criterion.
\item Because your function encapsulates {\bfseries{sequences}}, this package can find differences in arrays, strings, or other data.
\end{DoxyItemize}

{\bfseries{Output}} function {\ttfamily found\+Subsequence(n\+Common, a\+Common, b\+Common)} receives the number of adjacent items and starting indexes of each common subsequence. If sequences do not have common items, then this package does not call your function.

If N is the sum of lengths of sequences and L is length of a longest common subsequence, then D = N – 2L is the number of {\bfseries{differences}} in the corresponding shortest edit script.

\href{http://xmailserver.org/diff2.pdf}{\texttt{ {\itshape An O(\+ND) Difference Algorithm and Its Variations}}} by Eugene W. Myers is fast when sequences have {\bfseries{few}} differences.

This package implements the {\bfseries{linear space}} variation with optimizations so it is fast even when sequences have {\bfseries{many}} differences.\hypertarget{README.md_autotoc_md11924}{}\doxysubsection{\texorpdfstring{Usage}{Usage}}\label{README.md_autotoc_md11924}
To add this package as a dependency of a project, do either of the following\+:


\begin{DoxyItemize}
\item {\ttfamily npm install diff-\/sequences}
\item {\ttfamily yarn add diff-\/sequences}
\end{DoxyItemize}

To use {\ttfamily diff} as the name of the default export from this package, do either of the following\+:


\begin{DoxyItemize}
\item `var diff = require(\textquotesingle{}diff-\/sequences').default; // Common\+JS modules{\ttfamily  -\/}import diff from \textquotesingle{}diff-\/sequences\textquotesingle{}; // ECMAScript modules\`{}
\end{DoxyItemize}

Call {\ttfamily diff} with the {\bfseries{lengths}} of sequences and your {\bfseries{callback}} functions\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ a\ =\ ['a',\ 'b',\ 'c',\ 'a',\ 'b',\ 'b',\ 'a'];}
\DoxyCodeLine{const\ b\ =\ ['c',\ 'b',\ 'a',\ 'b',\ 'a',\ 'c'];}
\DoxyCodeLine{}
\DoxyCodeLine{function\ isCommon(aIndex,\ bIndex)\ \{}
\DoxyCodeLine{\ \ return\ a[aIndex]\ ===\ b[bIndex];}
\DoxyCodeLine{\}}
\DoxyCodeLine{function\ foundSubsequence(nCommon,\ aCommon,\ bCommon)\ \{}
\DoxyCodeLine{\ \ //\ see\ examples}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{diff(a.length,\ b.length,\ isCommon,\ foundSubsequence);}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md11925}{}\doxysubsection{\texorpdfstring{Example of longest common subsequence}{Example of longest common subsequence}}\label{README.md_autotoc_md11925}
Some sequences (for example, {\ttfamily a} and {\ttfamily b} in the example of usage) have more than one longest common subsequence.

This package finds the following common items\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ comparisons of common items   }&\cellcolor{\tableheadbgcolor}\textbf{ values   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ output arguments    }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ comparisons of common items   }&\cellcolor{\tableheadbgcolor}\textbf{ values   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ output arguments    }\\\cline{1-3}
\endhead
{\ttfamily a\mbox{[}2\mbox{]} === b\mbox{[}0\mbox{]}}   &`\textquotesingle{}c'{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}found\+Subsequence(1, 2, 0){\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Even"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}a\mbox{[}4\mbox{]} === b\mbox{[}1\mbox{]}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}b\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}found\+Subsequence(1, 4, 1){\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Odd"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}a\mbox{[}5\mbox{]} === b\mbox{[}3\mbox{]} \&\& a\mbox{[}6\mbox{]} === b\mbox{[}4\mbox{]}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}b\textquotesingle{}, \textquotesingle{}a\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}found\+Subsequence(2, 5, 3)\`{}   \\\cline{1-3}
\end{longtabu}


The “edit graph” analogy in the Myers paper shows the following common items\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ comparisons of common items   }&\cellcolor{\tableheadbgcolor}\textbf{ values    }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ comparisons of common items   }&\cellcolor{\tableheadbgcolor}\textbf{ values    }\\\cline{1-2}
\endhead
{\ttfamily a\mbox{[}2\mbox{]} === b\mbox{[}0\mbox{]}}   &`\textquotesingle{}c'{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Even"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}a\mbox{[}3\mbox{]} === b\mbox{[}2\mbox{]} \&\& a\mbox{[}4\mbox{]} === b\mbox{[}3\mbox{]}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}a\textquotesingle{}, \textquotesingle{}b\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Odd"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}a\mbox{[}6\mbox{]} === b\mbox{[}4\mbox{]}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}a\textquotesingle{}\`{}   \\\cline{1-2}
\end{longtabu}


Various packages which implement the Myers algorithm will {\bfseries{always agree}} on the {\bfseries{length}} of a longest common subsequence, but might {\bfseries{sometimes disagree}} on which {\bfseries{items}} are in it.\hypertarget{README.md_autotoc_md11926}{}\doxysubsection{\texorpdfstring{Example of callback functions to count common items}{Example of callback functions to count common items}}\label{README.md_autotoc_md11926}

\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Return\ length\ of\ longest\ common\ subsequence\ according\ to\ ===\ operator.}
\DoxyCodeLine{function\ countCommonItems(a,\ b)\ \{}
\DoxyCodeLine{\ \ let\ n\ =\ 0;}
\DoxyCodeLine{\ \ function\ isCommon(aIndex,\ bIndex)\ \{}
\DoxyCodeLine{\ \ \ \ return\ a[aIndex]\ ===\ b[bIndex];}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \ function\ foundSubsequence(nCommon)\ \{}
\DoxyCodeLine{\ \ \ \ n\ +=\ nCommon;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ diff(a.length,\ b.length,\ isCommon,\ foundSubsequence);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ return\ n;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{const\ commonLength\ =\ countCommonItems(}
\DoxyCodeLine{\ \ ['a',\ 'b',\ 'c',\ 'a',\ 'b',\ 'b',\ 'a'],}
\DoxyCodeLine{\ \ ['c',\ 'b',\ 'a',\ 'b',\ 'a',\ 'c'],}
\DoxyCodeLine{);}

\end{DoxyCode}


\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ category of items   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ expression   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ value    }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ category of items   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ expression   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ value    }\\\cline{1-3}
\endhead
in common   &\PBS\raggedleft {\ttfamily common\+Length}   &\PBS\raggedleft {\ttfamily 4}    \\\cline{1-3}
to delete from {\ttfamily a}   &\PBS\raggedleft {\ttfamily a.\+length -\/ common\+Length}   &\PBS\raggedleft {\ttfamily 3}    \\\cline{1-3}
to insert from {\ttfamily b}   &\PBS\raggedleft {\ttfamily b.\+length -\/ common\+Length}   &\PBS\raggedleft {\ttfamily 2}   \\\cline{1-3}
\end{longtabu}


If the length difference {\ttfamily b.\+length -\/ a.\+length} is\+:


\begin{DoxyItemize}
\item negative\+: its absolute value is the minimum number of items to {\bfseries{delete}} from {\ttfamily a}
\item positive\+: it is the minimum number of items to {\bfseries{insert}} from {\ttfamily b}
\item zero\+: there is an {\bfseries{equal}} number of items to delete from {\ttfamily a} and insert from {\ttfamily b}
\item non-\/zero\+: there is an equal number of {\bfseries{additional}} items to delete from {\ttfamily a} and insert from {\ttfamily b}
\end{DoxyItemize}

In this example, {\ttfamily 6 -\/ 7} is\+:


\begin{DoxyItemize}
\item negative\+: {\ttfamily 1} is the minimum number of items to {\bfseries{delete}} from {\ttfamily a}
\item non-\/zero\+: {\ttfamily 2} is the number of {\bfseries{additional}} items to delete from {\ttfamily a} and insert from {\ttfamily b}
\end{DoxyItemize}\hypertarget{README.md_autotoc_md11927}{}\doxysubsection{\texorpdfstring{Example of callback functions to find common items}{Example of callback functions to find common items}}\label{README.md_autotoc_md11927}

\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Return\ array\ of\ items\ in\ longest\ common\ subsequence\ according\ to\ Object.is\ method.}
\DoxyCodeLine{const\ findCommonItems\ =\ (a,\ b)\ =>\ \{}
\DoxyCodeLine{\ \ const\ array\ =\ [];}
\DoxyCodeLine{\ \ diff(}
\DoxyCodeLine{\ \ \ \ a.length,}
\DoxyCodeLine{\ \ \ \ b.length,}
\DoxyCodeLine{\ \ \ \ (aIndex,\ bIndex)\ =>\ Object.is(a[aIndex],\ b[bIndex]),}
\DoxyCodeLine{\ \ \ \ (nCommon,\ aCommon)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ for\ (;\ nCommon\ !==\ 0;\ nCommon\ -\/=\ 1,\ aCommon\ +=\ 1)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ array.push(a[aCommon]);}
\DoxyCodeLine{\ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ );}
\DoxyCodeLine{\ \ return\ array;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ commonItems\ =\ findCommonItems(}
\DoxyCodeLine{\ \ ['a',\ 'b',\ 'c',\ 'a',\ 'b',\ 'b',\ 'a'],}
\DoxyCodeLine{\ \ ['c',\ 'b',\ 'a',\ 'b',\ 'a',\ 'c'],}
\DoxyCodeLine{);}

\end{DoxyCode}


\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily i}   }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily common\+Items\mbox{[}i\mbox{]}}   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily a\+Index}    }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily i}   }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily common\+Items\mbox{[}i\mbox{]}}   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily a\+Index}    }\\\cline{1-3}
\endhead
\PBS\raggedleft {\ttfamily 0}   &`\textquotesingle{}c'{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}2{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Even"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}1{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}b\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}4{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Odd"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}2{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}b\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}5{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Even"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}3{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}a\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}6\`{}   \\\cline{1-3}
\end{longtabu}
\hypertarget{README.md_autotoc_md11928}{}\doxysubsection{\texorpdfstring{Example of callback functions to diff index intervals}{Example of callback functions to diff index intervals}}\label{README.md_autotoc_md11928}
Instead of slicing array-\/like objects, you can adjust indexes in your callback functions.


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Diff\ index\ intervals\ that\ are\ half\ open\ [start,\ end)\ like\ array\ slice\ method.}
\DoxyCodeLine{const\ diffIndexIntervals\ =\ (a,\ aStart,\ aEnd,\ b,\ bStart,\ bEnd)\ =>\ \{}
\DoxyCodeLine{\ \ //\ Validate:\ 0\ <=\ aStart\ and\ aStart\ <=\ aEnd\ and\ aEnd\ <=\ a.length}
\DoxyCodeLine{\ \ //\ Validate:\ 0\ <=\ bStart\ and\ bStart\ <=\ bEnd\ and\ bEnd\ <=\ b.length}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ diff(}
\DoxyCodeLine{\ \ \ \ aEnd\ -\/\ aStart,}
\DoxyCodeLine{\ \ \ \ bEnd\ -\/\ bStart,}
\DoxyCodeLine{\ \ \ \ (aIndex,\ bIndex)\ =>\ Object.is(a[aStart\ +\ aIndex],\ b[bStart\ +\ bIndex]),}
\DoxyCodeLine{\ \ \ \ (nCommon,\ aCommon,\ bCommon)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ //\ aStart\ +\ aCommon,\ bStart\ +\ bCommon}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ );}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ After\ the\ last\ common\ subsequence,\ do\ any\ remaining\ work.}
\DoxyCodeLine{\};}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md11929}{}\doxysubsection{\texorpdfstring{Example of callback functions to emulate diff command}{Example of callback functions to emulate diff command}}\label{README.md_autotoc_md11929}
Linux or Unix has a {\ttfamily diff} command to compare files line by line. Its output is a {\bfseries{shortest edit script}}\+:


\begin{DoxyItemize}
\item \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}c\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}hange adjacent lines from the first file to lines from the second file
\item \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}d\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}elete lines from the first file
\item \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}a\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}ppend or insert lines from the second file
\end{DoxyItemize}


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Given\ zero-\/based\ half-\/open\ range\ [start,\ end)\ of\ array\ indexes,}
\DoxyCodeLine{//\ return\ one-\/based\ closed\ range\ [start\ +\ 1,\ end]\ as\ string.}
\DoxyCodeLine{const\ getRange\ =\ (start,\ end)\ =>}
\DoxyCodeLine{\ \ start\ +\ 1\ ===\ end\ ?\ \`{}\$\{start\ +\ 1\}`\ :\ \`{}\$\{start\ +\ 1\},\$\{end\}`;}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Given\ index\ intervals\ of\ lines\ to\ delete\ or\ insert,\ or\ both,\ or\ neither,}
\DoxyCodeLine{//\ push\ formatted\ diff\ lines\ onto\ array.}
\DoxyCodeLine{const\ pushDelIns\ =\ (aLines,\ aIndex,\ aEnd,\ bLines,\ bIndex,\ bEnd,\ array)\ =>\ \{}
\DoxyCodeLine{\ \ const\ deleteLines\ =\ aIndex\ !==\ aEnd;}
\DoxyCodeLine{\ \ const\ insertLines\ =\ bIndex\ !==\ bEnd;}
\DoxyCodeLine{\ \ const\ changeLines\ =\ deleteLines\ \&\&\ insertLines;}
\DoxyCodeLine{\ \ if\ (changeLines)\ \{}
\DoxyCodeLine{\ \ \ \ array.push(`\$\{getRange(aIndex,\ aEnd)\}c\$\{getRange(bIndex,\ bEnd)\}`);}
\DoxyCodeLine{\ \ \}\ else\ if\ (deleteLines)\ \{}
\DoxyCodeLine{\ \ \ \ array.push(`\$\{getRange(aIndex,\ aEnd)\}d\$\{String(bIndex)\}`);}
\DoxyCodeLine{\ \ \}\ else\ if\ (insertLines)\ \{}
\DoxyCodeLine{\ \ \ \ array.push(`\$\{String(aIndex)\}a\$\{getRange(bIndex,\ bEnd)\}`);}
\DoxyCodeLine{\ \ \}\ else\ \{}
\DoxyCodeLine{\ \ \ \ return;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ for\ (;\ aIndex\ !==\ aEnd;\ aIndex\ +=\ 1)\ \{}
\DoxyCodeLine{\ \ \ \ array.push(`<\ \$\{aLines[aIndex]\}`);\ //\ delete\ is\ less\ than}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ if\ (changeLines)\ \{}
\DoxyCodeLine{\ \ \ \ array.push('-\/-\/-\/');}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ for\ (;\ bIndex\ !==\ bEnd;\ bIndex\ +=\ 1)\ \{}
\DoxyCodeLine{\ \ \ \ array.push(`>\ \$\{bLines[bIndex]\}`);\ //\ insert\ is\ greater\ than}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Given\ content\ of\ two\ files,\ return\ emulated\ output\ of\ diff\ utility.}
\DoxyCodeLine{const\ findShortestEditScript\ =\ (a,\ b)\ =>\ \{}
\DoxyCodeLine{\ \ const\ aLines\ =\ a.split('\(\backslash\)n');}
\DoxyCodeLine{\ \ const\ bLines\ =\ b.split('\(\backslash\)n');}
\DoxyCodeLine{\ \ const\ aLength\ =\ aLines.length;}
\DoxyCodeLine{\ \ const\ bLength\ =\ bLines.length;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ const\ isCommon\ =\ (aIndex,\ bIndex)\ =>\ aLines[aIndex]\ ===\ bLines[bIndex];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ let\ aIndex\ =\ 0;}
\DoxyCodeLine{\ \ let\ bIndex\ =\ 0;}
\DoxyCodeLine{\ \ const\ array\ =\ [];}
\DoxyCodeLine{\ \ const\ foundSubsequence\ =\ (nCommon,\ aCommon,\ bCommon)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ pushDelIns(aLines,\ aIndex,\ aCommon,\ bLines,\ bIndex,\ bCommon,\ array);}
\DoxyCodeLine{\ \ \ \ aIndex\ =\ aCommon\ +\ nCommon;\ //\ number\ of\ lines\ compared\ in\ a}
\DoxyCodeLine{\ \ \ \ bIndex\ =\ bCommon\ +\ nCommon;\ //\ number\ of\ lines\ compared\ in\ b}
\DoxyCodeLine{\ \ \};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ diff(aLength,\ bLength,\ isCommon,\ foundSubsequence);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ After\ the\ last\ common\ subsequence,\ push\ remaining\ change\ lines.}
\DoxyCodeLine{\ \ pushDelIns(aLines,\ aIndex,\ aLength,\ bLines,\ bIndex,\ bLength,\ array);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ return\ array.length\ ===\ 0\ ?\ ''\ :\ \`{}\$\{array.join('\(\backslash\)n')\}\(\backslash\)n`;}
\DoxyCodeLine{\};}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md11930}{}\doxysubsection{\texorpdfstring{Example of callback functions to format diff lines}{Example of callback functions to format diff lines}}\label{README.md_autotoc_md11930}
Here is simplified code to format {\bfseries{changed and unchanged lines}} in expected and received values after a test fails in Jest\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Format\ diff\ with\ minus\ or\ plus\ for\ change\ lines\ and\ space\ for\ common\ lines.}
\DoxyCodeLine{const\ formatDiffLines\ =\ (a,\ b)\ =>\ \{}
\DoxyCodeLine{\ \ //\ Jest\ depends\ on\ pretty-\/format\ package\ to\ serialize\ objects\ as\ strings.}
\DoxyCodeLine{\ \ //\ Unindented\ for\ comparison\ to\ avoid\ distracting\ differences:}
\DoxyCodeLine{\ \ const\ aLinesUn\ =\ format(a,\ \{indent:\ 0\ /*,\ other\ options*/\}).split('\(\backslash\)n');}
\DoxyCodeLine{\ \ const\ bLinesUn\ =\ format(b,\ \{indent:\ 0\ /*,\ other\ options*/\}).split('\(\backslash\)n');}
\DoxyCodeLine{\ \ //\ Indented\ to\ display\ changed\ and\ unchanged\ lines:}
\DoxyCodeLine{\ \ const\ aLinesIn\ =\ format(a,\ \{indent:\ 2\ /*,\ other\ options*/\}).split('\(\backslash\)n');}
\DoxyCodeLine{\ \ const\ bLinesIn\ =\ format(b,\ \{indent:\ 2\ /*,\ other\ options*/\}).split('\(\backslash\)n');}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ const\ aLength\ =\ aLinesIn.length;\ //\ Validate:\ aLinesUn.length\ ===\ aLength}
\DoxyCodeLine{\ \ const\ bLength\ =\ bLinesIn.length;\ //\ Validate:\ bLinesUn.length\ ===\ bLength}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ const\ isCommon\ =\ (aIndex,\ bIndex)\ =>\ aLinesUn[aIndex]\ ===\ bLinesUn[bIndex];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ Only\ because\ the\ GitHub\ Flavored\ Markdown\ doc\ collapses\ adjacent\ spaces,}
\DoxyCodeLine{\ \ //\ this\ example\ code\ and\ the\ following\ table\ represent\ spaces\ as\ middle\ dots.}
\DoxyCodeLine{\ \ let\ aIndex\ =\ 0;}
\DoxyCodeLine{\ \ let\ bIndex\ =\ 0;}
\DoxyCodeLine{\ \ const\ array\ =\ [];}
\DoxyCodeLine{\ \ const\ foundSubsequence\ =\ (nCommon,\ aCommon,\ bCommon)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ for\ (;\ aIndex\ !==\ aCommon;\ aIndex\ +=\ 1)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ array.push(`-\/·\$\{aLinesIn[aIndex]\}`);\ //\ delete\ is\ minus}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ for\ (;\ bIndex\ !==\ bCommon;\ bIndex\ +=\ 1)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ array.push(`+·\$\{bLinesIn[bIndex]\}`);\ //\ insert\ is\ plus}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ for\ (;\ nCommon\ !==\ 0;\ nCommon\ -\/=\ 1,\ aIndex\ +=\ 1,\ bIndex\ +=\ 1)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ //\ For\ common\ lines,\ received\ indentation\ seems\ more\ intuitive.}
\DoxyCodeLine{\ \ \ \ \ \ array.push(`··\$\{bLinesIn[bIndex]\}`);\ //\ common\ is\ space}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ diff(aLength,\ bLength,\ isCommon,\ foundSubsequence);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ After\ the\ last\ common\ subsequence,\ push\ remaining\ change\ lines.}
\DoxyCodeLine{\ \ for\ (;\ aIndex\ !==\ aLength;\ aIndex\ +=\ 1)\ \{}
\DoxyCodeLine{\ \ \ \ array.push(`-\/·\$\{aLinesIn[aIndex]\}`);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \ for\ (;\ bIndex\ !==\ bLength;\ bIndex\ +=\ 1)\ \{}
\DoxyCodeLine{\ \ \ \ array.push(`+·\$\{bLinesIn[bIndex]\}`);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ return\ array;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ expected\ =\ \{}
\DoxyCodeLine{\ \ searching:\ '',}
\DoxyCodeLine{\ \ sorting:\ \{}
\DoxyCodeLine{\ \ \ \ ascending:\ true,}
\DoxyCodeLine{\ \ \ \ fieldKey:\ 'what',}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\};}
\DoxyCodeLine{const\ received\ =\ \{}
\DoxyCodeLine{\ \ searching:\ '',}
\DoxyCodeLine{\ \ sorting:\ [}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ descending:\ false,}
\DoxyCodeLine{\ \ \ \ \ \ fieldKey:\ 'what',}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ ],}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ diffLines\ =\ formatDiffLines(expected,\ received);}

\end{DoxyCode}


If N is the sum of lengths of sequences and L is length of a longest common subsequence, then N – L is length of an array of diff lines. In this example, N is 7 + 9, L is 5, and N – L is 11.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily i}   }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily diff\+Lines\mbox{[}i\mbox{]}}   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily a\+Index}   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily b\+Index}    }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily i}   }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily diff\+Lines\mbox{[}i\mbox{]}}   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily a\+Index}   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily b\+Index}    }\\\cline{1-4}
\endhead
\PBS\raggedleft {\ttfamily 0}   &`\textquotesingle{}··\+Object \{'{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}0{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}0{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Even"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}1{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}····"{}searching"{}\+: "{}"{},\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}1{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}1{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Odd"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}2{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}-\/···"{}sorting"{}\+: Object \{\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}2{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>} \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Even"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}3{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}-\/·····"{}ascending"{}\+: true,\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}3{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>} \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Odd"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}4{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}+·····"{}sorting"{}\+: Array \mbox{[}\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>} \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}2{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Even"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}5{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}+·······\+Object \{\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>} \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}3{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Odd"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}6{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}+·········"{}descending"{}\+: false,\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>} \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}4{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Even"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}7{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}··········"{}field\+Key"{}\+: "{}what"{},\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}4{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}5{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Odd"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}8{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}········\},\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}5{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}6{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Even"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}9{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}+·····\mbox{]},\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>} \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}7{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Odd"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}10{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}··\}\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}6{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}8\`{}   \\\cline{1-4}
\end{longtabu}
\hypertarget{README.md_autotoc_md11931}{}\doxysubsection{\texorpdfstring{Example of callback functions to find diff items}{Example of callback functions to find diff items}}\label{README.md_autotoc_md11931}
Here is simplified code to find changed and unchanged substrings {\bfseries{within adjacent changed lines}} in expected and received values after a test fails in Jest\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Return\ diff\ items\ for\ strings\ (compatible\ with\ diff-\/match-\/patch\ package).}
\DoxyCodeLine{const\ findDiffItems\ =\ (a,\ b)\ =>\ \{}
\DoxyCodeLine{\ \ const\ isCommon\ =\ (aIndex,\ bIndex)\ =>\ a[aIndex]\ ===\ b[bIndex];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ let\ aIndex\ =\ 0;}
\DoxyCodeLine{\ \ let\ bIndex\ =\ 0;}
\DoxyCodeLine{\ \ const\ array\ =\ [];}
\DoxyCodeLine{\ \ const\ foundSubsequence\ =\ (nCommon,\ aCommon,\ bCommon)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ if\ (aIndex\ !==\ aCommon)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ array.push([-\/1,\ a.slice(aIndex,\ aCommon)]);\ //\ delete\ is\ -\/1}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ if\ (bIndex\ !==\ bCommon)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ array.push([1,\ b.slice(bIndex,\ bCommon)]);\ //\ insert\ is\ 1}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ aIndex\ =\ aCommon\ +\ nCommon;\ //\ number\ of\ characters\ compared\ in\ a}
\DoxyCodeLine{\ \ \ \ bIndex\ =\ bCommon\ +\ nCommon;\ //\ number\ of\ characters\ compared\ in\ b}
\DoxyCodeLine{\ \ \ \ array.push([0,\ a.slice(aCommon,\ aIndex)]);\ //\ common\ is\ 0}
\DoxyCodeLine{\ \ \};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ diff(a.length,\ b.length,\ isCommon,\ foundSubsequence);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ After\ the\ last\ common\ subsequence,\ push\ remaining\ change\ items.}
\DoxyCodeLine{\ \ if\ (aIndex\ !==\ a.length)\ \{}
\DoxyCodeLine{\ \ \ \ array.push([-\/1,\ a.slice(aIndex)]);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \ if\ (bIndex\ !==\ b.length)\ \{}
\DoxyCodeLine{\ \ \ \ array.push([1,\ b.slice(bIndex)]);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ return\ array;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ expectedDeleted\ =\ ['"{}sorting"{}:\ Object\ \{',\ '"{}ascending"{}:\ true,'].join(}
\DoxyCodeLine{\ \ '\(\backslash\)n',}
\DoxyCodeLine{);}
\DoxyCodeLine{const\ receivedInserted\ =\ [}
\DoxyCodeLine{\ \ '"{}sorting"{}:\ Array\ [',}
\DoxyCodeLine{\ \ 'Object\ \{',}
\DoxyCodeLine{\ \ '"{}descending"{}:\ false,',}
\DoxyCodeLine{].join('\(\backslash\)n');}
\DoxyCodeLine{}
\DoxyCodeLine{const\ diffItems\ =\ findDiffItems(expectedDeleted,\ receivedInserted);}

\end{DoxyCode}


\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily i}   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily diff\+Items\mbox{[}i\mbox{]}\mbox{[}0\mbox{]}}   }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily diff\+Items\mbox{[}i\mbox{]}\mbox{[}1\mbox{]}}    }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily i}   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily diff\+Items\mbox{[}i\mbox{]}\mbox{[}0\mbox{]}}   }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily diff\+Items\mbox{[}i\mbox{]}\mbox{[}1\mbox{]}}    }\\\cline{1-3}
\endhead
\PBS\raggedleft {\ttfamily 0}   &\PBS\raggedleft {\ttfamily 0}   &`'"{}sorting"{}\+: \textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Even"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}1{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}1{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}Array \mbox{[}~\newline
\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Odd"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}2{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}0{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}Object \{~\newline
"{}\textquotesingle{}\`{}    \\\cline{1-3}
\PBS\raggedleft \`{}3\`{}   &\PBS\raggedleft \`{}-\/1\`{}   &\`{}\textquotesingle{}a\textquotesingle{}\`{}    \\\cline{1-3}
\PBS\raggedleft \`{}4\`{}   &\PBS\raggedleft \`{}1\`{}   &\`{}\textquotesingle{}de\textquotesingle{}\`{}    \\\cline{1-3}
\PBS\raggedleft \`{}5\`{}   &\PBS\raggedleft \`{}0\`{}   &\`{}\textquotesingle{}scending"{}\+: \textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Odd"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}6{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}-\/1{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}tru\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Even"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}7{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}1{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}fals\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Odd"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}8{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}0{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}e,\textquotesingle{}\`{}   \\\cline{1-3}
\end{longtabu}


The length difference {\ttfamily b.\+length -\/ a.\+length} is equal to the sum of {\ttfamily diff\+Items\mbox{[}i\mbox{]}\mbox{[}0\mbox{]}} values times {\ttfamily diff\+Items\mbox{[}i\mbox{]}\mbox{[}1\mbox{]}} lengths. In this example, the difference {\ttfamily 48 -\/ 38} is equal to the sum {\ttfamily 10}.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ category of diff item   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily \mbox{[}0\mbox{]}}   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily \mbox{[}1\mbox{]}} lengths   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ subtotal    }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ category of diff item   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily \mbox{[}0\mbox{]}}   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily \mbox{[}1\mbox{]}} lengths   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ subtotal    }\\\cline{1-4}
\endhead
in common   &\PBS\raggedleft {\ttfamily 0}   &\PBS\raggedleft {\ttfamily 11 + 10 + 11 + 2}   &\PBS\raggedleft {\ttfamily 0}    \\\cline{1-4}
to delete from {\ttfamily a}   &\PBS\raggedleft {\ttfamily –1}   &\PBS\raggedleft {\ttfamily 1 + 3}   &\PBS\raggedleft {\ttfamily -\/4}    \\\cline{1-4}
to insert from {\ttfamily b}   &\PBS\raggedleft {\ttfamily 1}   &\PBS\raggedleft {\ttfamily 8 + 2 + 4}   &\PBS\raggedleft {\ttfamily 14}   \\\cline{1-4}
\end{longtabu}


Instead of formatting the changed substrings with escape codes for colors in the {\ttfamily found\+Subsequence} function to save memory, this example spends memory to {\bfseries{gain flexibility}} before formatting, so a separate heuristic algorithm might modify the generic array of diff items to show changes more clearly\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily i}   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily diff\+Items\mbox{[}i\mbox{]}\mbox{[}0\mbox{]}}   }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily diff\+Items\mbox{[}i\mbox{]}\mbox{[}1\mbox{]}}    }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily i}   }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily diff\+Items\mbox{[}i\mbox{]}\mbox{[}0\mbox{]}}   }&\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily diff\+Items\mbox{[}i\mbox{]}\mbox{[}1\mbox{]}}    }\\\cline{1-3}
\endhead
\PBS\raggedleft {\ttfamily 6}   &\PBS\raggedleft {\ttfamily -\/1}   &`\textquotesingle{}true'{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Even"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}7{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}1{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{}false\textquotesingle{}{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}/tr\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}tr class="{}markdown\+Table\+Row\+Odd"{}\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}8{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Right"{}\texorpdfstring{$>$}{>}}0{\ttfamily \textbackslash{}ilinebr \texorpdfstring{$<$}{<}/td\texorpdfstring{$>$}{>} \texorpdfstring{$<$}{<}td class="{}markdown\+Table\+Body\+Left"{}\texorpdfstring{$>$}{>}}\textquotesingle{},\textquotesingle{}\`{}   \\\cline{1-3}
\end{longtabu}


For expected and received strings of serialized data, the result of finding changed {\bfseries{lines}}, and then finding changed {\bfseries{substrings}} within adjacent changed lines (as in the preceding two examples) sometimes displays the changes in a more intuitive way than the result of finding changed substrings, and then splitting them into changed and unchanged lines. 