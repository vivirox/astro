\chapter{Security Guide}
\hypertarget{md_src_2docs_2guides_2security}{}\label{md_src_2docs_2guides_2security}\index{Security Guide@{Security Guide}}
\label{md_src_2docs_2guides_2security_autotoc_md37252}%
\Hypertarget{md_src_2docs_2guides_2security_autotoc_md37252}%
\hypertarget{md_src_2docs_2guides_2security_autotoc_md37253}{}\doxysection{\texorpdfstring{Table of Contents}{Table of Contents}}\label{md_src_2docs_2guides_2security_autotoc_md37253}

\begin{DoxyEnumerate}
\item \doxylink{md_node__modules_2safer-buffer_2_porting-_buffer_overview}{Overview}
\item Security Architecture
\item Security Best Practices
\item Security Configurations
\item Security Operations
\item Incident Response
\end{DoxyEnumerate}\hypertarget{md_src_2docs_2guides_2security_autotoc_md37254}{}\doxysection{\texorpdfstring{Overview}{Overview}}\label{md_src_2docs_2guides_2security_autotoc_md37254}
Our security architecture follows AWS Well-\/\+Architected Framework\textquotesingle{}s security pillar and implements defense in depth with multiple security layers\+:


\begin{DoxyEnumerate}
\item Network Security
\begin{DoxyItemize}
\item VPC with public and private subnets
\item Security groups with least privilege access
\item WAF for web application protection
\item Shield Advanced for DDoS protection
\end{DoxyItemize}
\item Data Security
\begin{DoxyItemize}
\item KMS encryption for data at rest
\item TLS encryption for data in transit
\item S3 bucket security with versioning and replication
\item Secrets management with automatic rotation
\end{DoxyItemize}
\item Identity and Access
\begin{DoxyItemize}
\item IAM policies following least privilege
\item Resource-\/based policies with conditions
\item Code signing for Lambda functions
\item Multi-\/factor authentication
\end{DoxyItemize}
\item Monitoring and Audit
\begin{DoxyItemize}
\item Cloud\+Watch logs with encryption
\item Cloud\+Trail for API auditing
\item Guard\+Duty for threat detection
\item Open\+Search for log analysis
\end{DoxyItemize}
\end{DoxyEnumerate}\hypertarget{md_src_2docs_2guides_2security_autotoc_md37255}{}\doxysection{\texorpdfstring{Security Architecture}{Security Architecture}}\label{md_src_2docs_2guides_2security_autotoc_md37255}
\hypertarget{md_src_2docs_2guides_2security_autotoc_md37256}{}\doxysubsection{\texorpdfstring{Network Security}{Network Security}}\label{md_src_2docs_2guides_2security_autotoc_md37256}

\begin{DoxyCode}{0}
\DoxyCodeLine{graph\ TD}
\DoxyCodeLine{\ \ \ \ Internet\ -\/-\/>\ WAF}
\DoxyCodeLine{\ \ \ \ WAF\ -\/-\/>\ Shield}
\DoxyCodeLine{\ \ \ \ Shield\ -\/-\/>\ ALB[Application\ Load\ Balancer]}
\DoxyCodeLine{\ \ \ \ ALB\ -\/-\/>\ ECS[ECS\ Tasks]}
\DoxyCodeLine{\ \ \ \ ECS\ -\/-\/>\ Aurora[Aurora\ Database]}
\DoxyCodeLine{\ \ \ \ ECS\ -\/-\/>\ S3[S3\ Storage]}
\DoxyCodeLine{\ \ \ \ ECS\ -\/-\/>\ OpenSearch[OpenSearch]}

\end{DoxyCode}



\begin{DoxyEnumerate}
\item VPC Configuration
\begin{DoxyItemize}
\item Public subnets for ALB only
\item Private subnets for workloads
\item NAT Gateway for outbound traffic
\item VPC Flow Logs enabled
\end{DoxyItemize}
\item Security Groups
\begin{DoxyItemize}
\item ALB\+: HTTPS inbound only
\item ECS\+: Traffic from ALB only
\item Aurora\+: Traffic from ECS only
\item Open\+Search\+: Internal traffic only
\end{DoxyItemize}
\end{DoxyEnumerate}\hypertarget{md_src_2docs_2guides_2security_autotoc_md37257}{}\doxysubsection{\texorpdfstring{Data Protection}{Data Protection}}\label{md_src_2docs_2guides_2security_autotoc_md37257}

\begin{DoxyEnumerate}
\item Encryption at Rest
\begin{DoxyItemize}
\item KMS keys with automatic rotation
\item S3 bucket encryption with KMS
\item RDS encryption with KMS
\item Open\+Search encryption with KMS
\end{DoxyItemize}
\item Encryption in Transit
\begin{DoxyItemize}
\item TLS 1.\+3 for ALB listeners
\item VPC endpoints for AWS services
\item TLS for database connections
\item HTTPS for API endpoints
\end{DoxyItemize}
\item Data Lifecycle
\begin{DoxyItemize}
\item S3 versioning enabled
\item Cross-\/region replication
\item Lifecycle policies
\item Backup retention policies
\end{DoxyItemize}
\end{DoxyEnumerate}\hypertarget{md_src_2docs_2guides_2security_autotoc_md37258}{}\doxysection{\texorpdfstring{Security Best Practices}{Security Best Practices}}\label{md_src_2docs_2guides_2security_autotoc_md37258}
\hypertarget{md_src_2docs_2guides_2security_autotoc_md37259}{}\doxysubsection{\texorpdfstring{Infrastructure Security}{Infrastructure Security}}\label{md_src_2docs_2guides_2security_autotoc_md37259}

\begin{DoxyEnumerate}
\item S3 Bucket Security
\begin{DoxyItemize}
\item Access logging enabled
\item Public access blocked
\item Versioning enabled
\item Cross-\/region replication
\item Event notifications
\item Lifecycle management
\end{DoxyItemize}
\item KMS and Secrets
\begin{DoxyItemize}
\item Automatic key rotation
\item Secrets rotation
\item Key policies with conditions
\item Multi-\/region keys
\item Audit logging
\end{DoxyItemize}
\item IAM Policies
\begin{DoxyItemize}
\item Resource-\/level permissions
\item Condition constraints
\item Least privilege access
\item Regular access reviews
\item Service control policies
\end{DoxyItemize}
\item Security Groups
\begin{DoxyItemize}
\item Specific CIDR blocks
\item Service-\/linked rules
\item Proper descriptions
\item Regular reviews
\item Default deny
\end{DoxyItemize}
\item Lambda Security
\begin{DoxyItemize}
\item VPC configuration
\item X-\/\+Ray tracing
\item Code signing
\item Concurrent limits
\item Environment encryption
\end{DoxyItemize}
\end{DoxyEnumerate}\hypertarget{md_src_2docs_2guides_2security_autotoc_md37260}{}\doxysubsection{\texorpdfstring{Application Security}{Application Security}}\label{md_src_2docs_2guides_2security_autotoc_md37260}

\begin{DoxyEnumerate}
\item Input Validation
\begin{DoxyItemize}
\item API Gateway validation
\item WAF rules
\item Schema validation
\item Sanitization
\end{DoxyItemize}
\item Authentication
\begin{DoxyItemize}
\item Multi-\/factor authentication
\item Token-\/based auth
\item Session management
\item JWT with rotation
\end{DoxyItemize}
\item Authorization
\begin{DoxyItemize}
\item Role-\/based access
\item Resource policies
\item Context-\/based rules
\item Regular audits
\end{DoxyItemize}
\end{DoxyEnumerate}\hypertarget{md_src_2docs_2guides_2security_autotoc_md37261}{}\doxysection{\texorpdfstring{Security Configurations}{Security Configurations}}\label{md_src_2docs_2guides_2security_autotoc_md37261}
\hypertarget{md_src_2docs_2guides_2security_autotoc_md37262}{}\doxysubsection{\texorpdfstring{WAF Rules}{WAF Rules}}\label{md_src_2docs_2guides_2security_autotoc_md37262}

\begin{DoxyCode}{0}
\DoxyCodeLine{resource\ "{}aws\_wafv2\_web\_acl"{}\ "{}app"{}\ \{}
\DoxyCodeLine{\ \ name\ \ \ \ \ \ \ \ =\ "{}\$\{local.name\_prefix\}-\/waf"{}}
\DoxyCodeLine{\ \ description\ =\ "{}WAF\ for\ application\ protection"{}}
\DoxyCodeLine{\ \ scope\ \ \ \ \ \ \ =\ "{}REGIONAL"{}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ default\_action\ \{}
\DoxyCodeLine{\ \ \ \ allow\ \{\}}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ rule\ \{}
\DoxyCodeLine{\ \ \ \ name\ \ \ \ \ =\ "{}AWSManagedRulesCommonRuleSet"{}}
\DoxyCodeLine{\ \ \ \ priority\ =\ 1}
\DoxyCodeLine{\ \ \ \ override\_action\ \{\ none\ \{\}\ \}}
\DoxyCodeLine{\ \ \ \ statement\ \{}
\DoxyCodeLine{\ \ \ \ \ \ managed\_rule\_group\_statement\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ name\ \ \ \ \ \ \ \ =\ "{}AWSManagedRulesCommonRuleSet"{}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ vendor\_name\ =\ "{}AWS"{}}
\DoxyCodeLine{\ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ visibility\_config\ \{}
\DoxyCodeLine{\ \ \ \ \ \ cloudwatch\_metrics\_enabled\ =\ true}
\DoxyCodeLine{\ \ \ \ \ \ metric\_name\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ "{}CommonRuleMetric"{}}
\DoxyCodeLine{\ \ \ \ \ \ sampled\_requests\_enabled\ \ =\ true}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_src_2docs_2guides_2security_autotoc_md37263}{}\doxysubsection{\texorpdfstring{KMS Configuration}{KMS Configuration}}\label{md_src_2docs_2guides_2security_autotoc_md37263}

\begin{DoxyCode}{0}
\DoxyCodeLine{resource\ "{}aws\_kms\_key"{}\ "{}app"{}\ \{}
\DoxyCodeLine{\ \ description\ \ \ \ \ \ \ \ \ \ \ \ \ =\ "{}Application\ encryption\ key"{}}
\DoxyCodeLine{\ \ deletion\_window\_in\_days\ =\ 30}
\DoxyCodeLine{\ \ enable\_key\_rotation\ \ \ \ \ =\ true}
\DoxyCodeLine{\ \ multi\_region\ \ \ \ \ \ \ \ \ \ \ =\ true}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ policy\ =\ jsonencode(\{}
\DoxyCodeLine{\ \ \ \ Version\ =\ "{}2012-\/10-\/17"{}}
\DoxyCodeLine{\ \ \ \ Statement\ =\ [}
\DoxyCodeLine{\ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Sid\ \ \ \ =\ "{}Enable\ IAM\ User\ Permissions"{}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Effect\ =\ "{}Allow"{}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Principal\ =\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ AWS\ =\ "{}arn:aws:iam::\$\{account\_id\}:root"{}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Action\ \ \ =\ "{}kms:*"{}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Resource\ =\ "{}*"{}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Condition\ =\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ StringEquals\ =\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ "{}aws:PrincipalOrgID"{}:\ "{}\$\{org\_id\}"{}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ ]}
\DoxyCodeLine{\ \ \})}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_src_2docs_2guides_2security_autotoc_md37264}{}\doxysubsection{\texorpdfstring{Security Group Rules}{Security Group Rules}}\label{md_src_2docs_2guides_2security_autotoc_md37264}

\begin{DoxyCode}{0}
\DoxyCodeLine{resource\ "{}aws\_security\_group\_rule"{}\ "{}alb\_ingress"{}\ \{}
\DoxyCodeLine{\ \ type\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ "{}ingress"{}}
\DoxyCodeLine{\ \ from\_port\ \ \ \ \ \ \ \ \ =\ 443}
\DoxyCodeLine{\ \ to\_port\ \ \ \ \ \ \ \ \ \ \ =\ 443}
\DoxyCodeLine{\ \ protocol\ \ \ \ \ \ \ \ \ \ =\ "{}tcp"{}}
\DoxyCodeLine{\ \ cidr\_blocks\ \ \ \ \ \ \ =\ ["{}0.0.0.0/0"{}]}
\DoxyCodeLine{\ \ description\ \ \ \ \ \ \ =\ "{}HTTPS\ inbound"{}}
\DoxyCodeLine{\ \ security\_group\_id\ =\ aws\_security\_group.alb.id}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{resource\ "{}aws\_security\_group\_rule"{}\ "{}ecs\_ingress"{}\ \{}
\DoxyCodeLine{\ \ type\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ "{}ingress"{}}
\DoxyCodeLine{\ \ from\_port\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 3000}
\DoxyCodeLine{\ \ to\_port\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 3000}
\DoxyCodeLine{\ \ protocol\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ "{}tcp"{}}
\DoxyCodeLine{\ \ source\_security\_group\_id\ =\ aws\_security\_group.alb.id}
\DoxyCodeLine{\ \ description\ \ \ \ \ \ \ \ \ \ \ \ \ =\ "{}Traffic\ from\ ALB"{}}
\DoxyCodeLine{\ \ security\_group\_id\ \ \ \ \ \ \ =\ aws\_security\_group.ecs.id}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_src_2docs_2guides_2security_autotoc_md37265}{}\doxysection{\texorpdfstring{Security Operations}{Security Operations}}\label{md_src_2docs_2guides_2security_autotoc_md37265}
\hypertarget{md_src_2docs_2guides_2security_autotoc_md37266}{}\doxysubsection{\texorpdfstring{Monitoring}{Monitoring}}\label{md_src_2docs_2guides_2security_autotoc_md37266}

\begin{DoxyEnumerate}
\item Cloud\+Watch Metrics
\begin{DoxyItemize}
\item Error rates
\item Request latency
\item Authentication failures
\item Authorization failures
\item WAF blocks
\end{DoxyItemize}
\item Cloud\+Watch Logs
\begin{DoxyItemize}
\item Application logs
\item Access logs
\item Audit logs
\item WAF logs
\item VPC Flow Logs
\end{DoxyItemize}
\item Guard\+Duty Findings
\begin{DoxyItemize}
\item Unauthorized access
\item Suspicious activity
\item Data exfiltration
\item Cryptocurrency mining
\end{DoxyItemize}
\end{DoxyEnumerate}\hypertarget{md_src_2docs_2guides_2security_autotoc_md37267}{}\doxysubsection{\texorpdfstring{Alerting}{Alerting}}\label{md_src_2docs_2guides_2security_autotoc_md37267}

\begin{DoxyEnumerate}
\item High Priority
\begin{DoxyItemize}
\item Security group changes
\item IAM policy changes
\item Root account usage
\item KMS key deletion
\item Guard\+Duty high severity
\end{DoxyItemize}
\item Medium Priority
\begin{DoxyItemize}
\item Failed login attempts
\item WAF blocks
\item S3 public access
\item Unusual traffic patterns
\item API throttling
\end{DoxyItemize}
\item Low Priority
\begin{DoxyItemize}
\item Configuration changes
\item Resource creation
\item Tag modifications
\item Cost anomalies
\end{DoxyItemize}
\end{DoxyEnumerate}\hypertarget{md_src_2docs_2guides_2security_autotoc_md37268}{}\doxysection{\texorpdfstring{Incident Response}{Incident Response}}\label{md_src_2docs_2guides_2security_autotoc_md37268}
\hypertarget{md_src_2docs_2guides_2security_autotoc_md37269}{}\doxysubsection{\texorpdfstring{Response Procedures}{Response Procedures}}\label{md_src_2docs_2guides_2security_autotoc_md37269}

\begin{DoxyEnumerate}
\item Detection
\begin{DoxyItemize}
\item Monitor alerts
\item Review logs
\item Analyze metrics
\item Check Guard\+Duty
\end{DoxyItemize}
\item Analysis
\begin{DoxyItemize}
\item Identify scope
\item Determine impact
\item Review audit logs
\item Check configurations
\end{DoxyItemize}
\item Containment
\begin{DoxyItemize}
\item Isolate resources
\item Block access
\item Rotate credentials
\item Update policies
\end{DoxyItemize}
\item Eradication
\begin{DoxyItemize}
\item Remove threats
\item Update configurations
\item Apply patches
\item Verify removal
\end{DoxyItemize}
\item Recovery
\begin{DoxyItemize}
\item Restore services
\item Verify functionality
\item Monitor closely
\item Document changes
\end{DoxyItemize}
\item Post-\/\+Incident
\begin{DoxyItemize}
\item Review response
\item Update procedures
\item Improve detection
\item Train team
\end{DoxyItemize}
\end{DoxyEnumerate}\hypertarget{md_src_2docs_2guides_2security_autotoc_md37270}{}\doxysubsection{\texorpdfstring{Contact Information}{Contact Information}}\label{md_src_2docs_2guides_2security_autotoc_md37270}

\begin{DoxyEnumerate}
\item Security Team
\begin{DoxyItemize}
\item Slack\+: \#security-\/team
\item Email\+: \href{mailto:security@example.com}{\texttt{ security@example.\+com}}
\item Phone\+: 1-\/800-\/xxx-\/xxxx
\item On-\/call\+: Pager\+Duty
\end{DoxyItemize}
\item AWS Support
\begin{DoxyItemize}
\item Enterprise Support
\item Security Response
\item TAM Contact
\item Account Team
\end{DoxyItemize}
\item External Partners
\begin{DoxyItemize}
\item SOC Provider
\item MSSP Contact
\item Forensics Team
\item Legal Team 
\end{DoxyItemize}
\end{DoxyEnumerate}