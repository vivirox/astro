\doxysection{node\+\_\+modules/tryer Directory Reference}
\hypertarget{dir_40d9e91e7573db5f2c3cf222f0f46198}{}\label{dir_40d9e91e7573db5f2c3cf222f0f46198}\index{node\_modules/tryer Directory Reference@{node\_modules/tryer Directory Reference}}


\doxysubsection{Detailed Description}
\href{https://gitlab.com/philbooth/tryer/pipelines}{\texttt{ }} \href{https://www.npmjs.com/package/tryer}{\texttt{ }} \href{https://www.npmjs.com/package/tryer}{\texttt{ }} \href{https://opensource.org/licenses/MIT}{\texttt{ }}

Because everyone loves a tryer! Conditional and repeated function invocation for node and browser.


\begin{DoxyItemize}
\item Say what?
\item What size is it?
\item How do I install it?
\item How do I use it?
\begin{DoxyItemize}
\item Loading the library
\item Calling the exported function
\item \doxylink{README.md_examples}{Examples}
\end{DoxyItemize}
\item How do I set up the dev environment?
\item What license is it released under?
\end{DoxyItemize}\hypertarget{README.md_autotoc_md33228}{}\doxysubsection{\texorpdfstring{Say what?}{Say what?}}\label{README.md_autotoc_md33228}
Sometimes, you want to defer calling a function until a certain pre-\/requisite condition is met. Other times, you want to call a function repeatedly until some post-\/requisite condition is satisfied. Occasionally, you might even want to do both for the same function.

To save you writing explicit conditions and loops on each of those occasions, {\ttfamily tryer} implements a predicate-\/based approach that hides the cruft behind a simple, functional interface.

Additionally, it allows you to easily specify retry intervals and limits, so that your code doesn\textquotesingle{}t hog the CPU. It also supports exponential backoff of retry intervals, which can be useful when handling indefinite error states such as network failure.\hypertarget{README.md_autotoc_md33229}{}\doxysubsection{\texorpdfstring{What size is it?}{What size is it?}}\label{README.md_autotoc_md33229}
5.\+6 kb unminified with comments, 1.\+1 kb minified, 0.\+5 kb minified + gzipped.\hypertarget{README.md_autotoc_md33230}{}\doxysubsection{\texorpdfstring{How do I install it?}{How do I install it?}}\label{README.md_autotoc_md33230}
Via npm\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ i\ tryer\ -\/-\/save}

\end{DoxyCode}


Or if you just want the git repo\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{git\ clone\ git@gitlab.com:philbooth/tryer.git}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33231}{}\doxysubsection{\texorpdfstring{How do I use it?}{How do I use it?}}\label{README.md_autotoc_md33231}
\hypertarget{README.md_autotoc_md33232}{}\doxysubsubsection{\texorpdfstring{Loading the library}{Loading the library}}\label{README.md_autotoc_md33232}
If you are running in Node.\+js or another Common\+JS-\/style environment, you can {\ttfamily require} tryer like so\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ tryer\ =\ require('tryer');}

\end{DoxyCode}


It also the supports the AMD-\/style format preferred by Require.\+js.

If you are including {\ttfamily tryer} with an HTML {\ttfamily \texorpdfstring{$<$}{<}script\texorpdfstring{$>$}{>}} tag, or neither of the above environments are detected, it will be exported globally as {\ttfamily tryer}.\hypertarget{README.md_autotoc_md33233}{}\doxysubsubsection{\texorpdfstring{Calling the exported function}{Calling the exported function}}\label{README.md_autotoc_md33233}
{\ttfamily tryer} is a function that can be invoked to call other functions conditionally and repeatedly, without the need for explicit {\ttfamily if} statements or loops in your own code.

{\ttfamily tryer} takes one argument, an options object that supports the following properties\+:


\begin{DoxyItemize}
\item {\ttfamily action}\+: The function that you want to invoke. If {\ttfamily action} returns a promise, iterations will not end until the promise is resolved or rejected. Alternatively, {\ttfamily action} may take a callback argument, {\ttfamily done}, to signal that it is asynchronous. In that case, you are responsible for calling {\ttfamily done} when the action is finished. If {\ttfamily action} is not set, it defaults to an empty function.
\item {\ttfamily when}\+: A predicate that tests the pre-\/condition for invoking {\ttfamily action}. Until {\ttfamily when} returns true (or a truthy value), {\ttfamily action} will not be called. Defaults to a function that immediately returns {\ttfamily true}.
\item {\ttfamily until}\+: A predicate that tests the post-\/condition for invoking {\ttfamily action}. After {\ttfamily until} returns true (or a truthy value), {\ttfamily action} will no longer be called. Defaults to a function that immediately returns {\ttfamily true}.
\item {\ttfamily fail}\+: The error handler. A function that will be called if {\ttfamily limit} falsey values are returned by {\ttfamily when} or {\ttfamily until}. Defaults to an empty function.
\item {\ttfamily pass}\+: Success handler. A function that will be called after {\ttfamily until} has returned truthily. Defaults to an empty function.
\item {\ttfamily limit}\+: Failure limit, representing the maximum number of falsey returns from {\ttfamily when} or {\ttfamily until} that will be permitted before invocation is deemed to have failed. A negative number indicates that the attempt should never fail, instead continuing for as long as {\ttfamily when} and {\ttfamily until} have returned truthy values. Defaults to {\ttfamily -\/1}.
\item {\ttfamily interval}\+: The retry interval, in milliseconds. A negative number indicates that each subsequent retry should wait for twice the interval from the preceding iteration (i.\+e. exponential backoff). The default value is {\ttfamily -\/1000}, signifying that the initial retry interval should be one second and that each subsequent attempt should wait for double the length of the previous interval.
\end{DoxyItemize}\hypertarget{README.md_autotoc_md33234}{}\doxysubsubsection{\texorpdfstring{Examples}{Examples}}\label{README.md_autotoc_md33234}

\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Attempt\ to\ insert\ a\ database\ record,\ waiting\ until\ \`{}db.isConnected`}
\DoxyCodeLine{//\ before\ doing\ so.\ The\ retry\ interval\ is\ 1\ second\ on\ each\ iteration}
\DoxyCodeLine{//\ and\ the\ call\ will\ fail\ after\ 10\ attempts.}
\DoxyCodeLine{tryer(\{}
\DoxyCodeLine{\ \ action:\ ()\ =>\ db.insert(record),}
\DoxyCodeLine{\ \ when:\ ()\ =>\ db.isConnected,}
\DoxyCodeLine{\ \ interval:\ 1000,}
\DoxyCodeLine{\ \ limit:\ 10,}
\DoxyCodeLine{\ \ fail\ ()\ \{}
\DoxyCodeLine{\ \ \ \ log.error('No\ database\ connection,\ terminating.');}
\DoxyCodeLine{\ \ \ \ process.exit(1);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\});}

\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Attempt\ to\ send\ an\ email\ message,\ optionally\ retrying\ with}
\DoxyCodeLine{//\ exponential\ backoff\ starting\ at\ 1\ second.\ Continue\ to\ make}
\DoxyCodeLine{//\ attempts\ indefinitely\ until\ the\ call\ succeeds.}
\DoxyCodeLine{let\ sent\ =\ false;}
\DoxyCodeLine{tryer(\{}
\DoxyCodeLine{\ \ action\ (done)\ \{}
\DoxyCodeLine{\ \ \ \ smtp.send(email,\ error\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ if\ (!\ error)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ sent\ =\ true;}
\DoxyCodeLine{\ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ done();}
\DoxyCodeLine{\ \ \ \ \});}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\ \ until:\ ()\ =>\ sent,}
\DoxyCodeLine{\ \ interval:\ -\/1000,}
\DoxyCodeLine{\ \ limit:\ -\/1}
\DoxyCodeLine{\});}

\end{DoxyCode}



\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Poll\ a\ device\ at\ 30-\/second\ intervals,\ continuing\ indefinitely.}
\DoxyCodeLine{tryer(\{}
\DoxyCodeLine{\ \ action:\ ()\ =>\ device.poll().then(response\ =>\ handle(response)),}
\DoxyCodeLine{\ \ interval:\ 30000,}
\DoxyCodeLine{\ \ limit:\ -\/1}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33235}{}\doxysubsection{\texorpdfstring{How do I set up the dev environment?}{How do I set up the dev environment?}}\label{README.md_autotoc_md33235}
The dev environment relies on \href{http://chaijs.com/}{\texttt{ Chai}}, \href{http://jshint.com/}{\texttt{ JSHint}}, \href{http://mochajs.org/}{\texttt{ Mocha}}, \href{https://gitlab.com/philbooth/please-release-me}{\texttt{ please-\/release-\/me}}, \href{https://gitlab.com/philbooth/spooks.js}{\texttt{ spooks.\+js}} and \href{http://lisperator.net/uglifyjs/}{\texttt{ Uglify\+JS}}. The source code is in {\ttfamily src/tryer.\+js} and the unit tests are in {\ttfamily test/unit.\+js}.

To install the dependencies\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ i}

\end{DoxyCode}


To run the tests\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ t}

\end{DoxyCode}


To lint the code\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ run\ lint}

\end{DoxyCode}


To regenerate the minified lib\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ run\ minify}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md33236}{}\doxysubsection{\texorpdfstring{What license is it released under?}{What license is it released under?}}\label{README.md_autotoc_md33236}
\mbox{[}MIT\mbox{]}(COPYING) 