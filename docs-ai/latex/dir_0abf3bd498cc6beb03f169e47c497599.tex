\doxysection{node\+\_\+modules/before-\/after-\/hook Directory Reference}
\hypertarget{dir_0abf3bd498cc6beb03f169e47c497599}{}\label{dir_0abf3bd498cc6beb03f169e47c497599}\index{node\_modules/before-\/after-\/hook Directory Reference@{node\_modules/before-\/after-\/hook Directory Reference}}


\doxysubsection{Detailed Description}
\begin{quote}
asynchronous hooks for internal functionality \end{quote}


\href{https://www.npmjs.com/package/before-after-hook}{\texttt{ }} \href{https://github.com/gr2m/before-after-hook/actions/workflows/test.yml}{\texttt{ }}\hypertarget{README.md_autotoc_md9211}{}\doxysubsection{\texorpdfstring{Usage}{Usage}}\label{README.md_autotoc_md9211}
\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Browsers }&Load {\ttfamily before-\/after-\/hook} directly from \href{https://cdn.skypack.dev}{\texttt{ cdn.\+skypack.\+dev}}


\begin{DoxyCode}{0}
\DoxyCodeLine{<script\ type="{}module"{}>}
\DoxyCodeLine{\ \ import\ Hook\ from\ "{}https://cdn.skypack.dev/before-\/after-\/hook"{};}
\DoxyCodeLine{</script>}

\end{DoxyCode}


\\\cline{1-2}
\cellcolor{\tableheadbgcolor}\textbf{ Node }&

Install with {\ttfamily npm install before-\/after-\/hook}


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ Hook\ from\ "{}before-\/after-\/hook"{};}

\end{DoxyCode}


\\\cline{1-2}
\end{longtabu}
\hypertarget{README.md_autotoc_md9212}{}\doxysubsubsection{\texorpdfstring{Singular hook}{Singular hook}}\label{README.md_autotoc_md9212}

\begin{DoxyCode}{0}
\DoxyCodeLine{//\ instantiate\ singular\ hook\ API}
\DoxyCodeLine{const\ hook\ =\ new\ Hook.Singular();}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Create\ a\ hook}
\DoxyCodeLine{async\ function\ getData(options)\ \{}
\DoxyCodeLine{\ \ try\ \{}
\DoxyCodeLine{\ \ \ \ const\ result\ =\ await\ hook(fetchFromDatabase,\ options);}
\DoxyCodeLine{\ \ \ \ return\ handleData(result);}
\DoxyCodeLine{\ \ \}\ catch\ (error)\ \{}
\DoxyCodeLine{\ \ \ \ return\ handleGetError(error);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{//\ register\ before/error/after\ hooks.}
\DoxyCodeLine{//\ The\ methods\ can\ be\ async\ or\ return\ a\ promise}
\DoxyCodeLine{hook.before(beforeHook);}
\DoxyCodeLine{hook.error(errorHook);}
\DoxyCodeLine{hook.after(afterHook);}
\DoxyCodeLine{}
\DoxyCodeLine{getData(\{\ id:\ 123\ \});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md9213}{}\doxysubsubsection{\texorpdfstring{Hook collection}{Hook collection}}\label{README.md_autotoc_md9213}

\begin{DoxyCode}{0}
\DoxyCodeLine{//\ instantiate\ hook\ collection\ API}
\DoxyCodeLine{const\ hookCollection\ =\ new\ Hook.Collection();}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Create\ a\ hook}
\DoxyCodeLine{async\ function\ getData(options)\ \{}
\DoxyCodeLine{\ \ try\ \{}
\DoxyCodeLine{\ \ \ \ const\ result\ =\ await\ hookCollection("{}get"{},\ fetchFromDatabase,\ options);}
\DoxyCodeLine{\ \ \ \ return\ handleData(result);}
\DoxyCodeLine{\ \ \}\ catch\ (error)\ \{}
\DoxyCodeLine{\ \ \ \ return\ handleGetError(error);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{//\ register\ before/error/after\ hooks.}
\DoxyCodeLine{//\ The\ methods\ can\ be\ async\ or\ return\ a\ promise}
\DoxyCodeLine{hookCollection.before("{}get"{},\ beforeHook);}
\DoxyCodeLine{hookCollection.error("{}get"{},\ errorHook);}
\DoxyCodeLine{hookCollection.after("{}get"{},\ afterHook);}
\DoxyCodeLine{}
\DoxyCodeLine{getData(\{\ id:\ 123\ \});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md9214}{}\doxysubsubsection{\texorpdfstring{Hook.\+Singular vs Hook.\+Collection}{Hook.\+Singular vs Hook.\+Collection}}\label{README.md_autotoc_md9214}
There\textquotesingle{}s no fundamental difference between the {\ttfamily Hook.\+Singular} and {\ttfamily Hook.\+Collection} hooks except for the fact that a hook from a collection requires you to pass along the name. Therefore the following explanation applies to both code snippets as described above.

The methods are executed in the following order


\begin{DoxyEnumerate}
\item {\ttfamily before\+Hook}
\item {\ttfamily fetch\+From\+Database}
\item {\ttfamily after\+Hook}
\item {\ttfamily handle\+Data}
\end{DoxyEnumerate}

{\ttfamily before\+Hook} can mutate {\ttfamily options} before it’s passed to {\ttfamily fetch\+From\+Database}.

If an error is thrown in {\ttfamily before\+Hook} or {\ttfamily fetch\+From\+Database} then {\ttfamily error\+Hook} is called next.

If {\ttfamily after\+Hook} throws an error then {\ttfamily handle\+Get\+Error} is called instead of {\ttfamily handle\+Data}.

If {\ttfamily error\+Hook} throws an error then {\ttfamily handle\+Get\+Error} is called next, otherwise {\ttfamily after\+Hook} and {\ttfamily handle\+Data}.

You can also use {\ttfamily hook.\+wrap} to achieve the same thing as shown above (collection example)\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection.wrap("{}get"{},\ async\ (getData,\ options)\ =>\ \{}
\DoxyCodeLine{\ \ await\ beforeHook(options);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ try\ \{}
\DoxyCodeLine{\ \ \ \ const\ result\ =\ getData(options);}
\DoxyCodeLine{\ \ \}\ catch\ (error)\ \{}
\DoxyCodeLine{\ \ \ \ await\ errorHook(error,\ options);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ await\ afterHook(result,\ options);}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md9215}{}\doxysubsection{\texorpdfstring{API}{API}}\label{README.md_autotoc_md9215}

\begin{DoxyItemize}
\item Singular Hook Constructor
\item Hook Collection Constructor
\end{DoxyItemize}\hypertarget{README.md_autotoc_md9216}{}\doxysubsection{\texorpdfstring{Singular hook API}{Singular hook API}}\label{README.md_autotoc_md9216}

\begin{DoxyItemize}
\item Singular constructor
\item hook.api
\item hook()
\item hook.before()
\item hook.error()
\item hook.after()
\item hook.wrap()
\item hook.remove()
\end{DoxyItemize}\hypertarget{README.md_autotoc_md9217}{}\doxysubsubsection{\texorpdfstring{Singular constructor}{Singular constructor}}\label{README.md_autotoc_md9217}
The {\ttfamily Hook.\+Singular} constructor has no options and returns a {\ttfamily hook} instance with the methods below\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ hook\ =\ new\ Hook.Singular();}

\end{DoxyCode}


Using the singular hook is recommended for Type\+Script\hypertarget{README.md_autotoc_md9218}{}\doxysubsubsection{\texorpdfstring{Singular API}{Singular API}}\label{README.md_autotoc_md9218}
The singular hook is a reference to a single hook. This means that there\textquotesingle{}s no need to pass along any identifier (such as a {\ttfamily name} as can be seen in the Hook.Collection API).

The API of a singular hook is exactly the same as a collection hook and we therefore suggest you read the Hook.Collection API and leave out any use of the {\ttfamily name} argument. Just skip it like described in this example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ hook\ =\ new\ Hook.Singular();}
\DoxyCodeLine{}
\DoxyCodeLine{//\ good}
\DoxyCodeLine{hook.before(beforeHook);}
\DoxyCodeLine{hook.after(afterHook);}
\DoxyCodeLine{hook(fetchFromDatabase,\ options);}
\DoxyCodeLine{}
\DoxyCodeLine{//\ bad}
\DoxyCodeLine{hook.before("{}get"{},\ beforeHook);}
\DoxyCodeLine{hook.after("{}get"{},\ afterHook);}
\DoxyCodeLine{hook("{}get"{},\ fetchFromDatabase,\ options);}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md9219}{}\doxysubsection{\texorpdfstring{Hook collection API}{Hook collection API}}\label{README.md_autotoc_md9219}

\begin{DoxyItemize}
\item Collection constructor
\item hook\+Collection.api
\item hook\+Collection()
\item hook\+Collection.before()
\item hook\+Collection.error()
\item hook\+Collection.after()
\item hook\+Collection.wrap()
\item hook\+Collection.remove()
\end{DoxyItemize}\hypertarget{README.md_autotoc_md9220}{}\doxysubsubsection{\texorpdfstring{Collection constructor}{Collection constructor}}\label{README.md_autotoc_md9220}
The {\ttfamily Hook.\+Collection} constructor has no options and returns a {\ttfamily hook\+Collection} instance with the methods below


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ hookCollection\ =\ new\ Hook.Collection();}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md9221}{}\doxysubsubsection{\texorpdfstring{hook\+Collection.\+api}{hook\+Collection.\+api}}\label{README.md_autotoc_md9221}
Use the {\ttfamily api} property to return the public API\+:


\begin{DoxyItemize}
\item hook\+Collection.before()
\item hook\+Collection.after()
\item hook\+Collection.error()
\item hook\+Collection.wrap()
\item hook\+Collection.remove()
\end{DoxyItemize}

That way you don’t need to expose the hook\+Collection() method to consumers of your library\hypertarget{README.md_autotoc_md9222}{}\doxysubsubsection{\texorpdfstring{hook\+Collection()}{hook\+Collection()}}\label{README.md_autotoc_md9222}
Invoke before and after hooks. Returns a promise.


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection(nameOrNames,\ method\ /*,\ options\ */);}

\end{DoxyCode}


\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Argument }&\cellcolor{\tableheadbgcolor}\textbf{ Type }&\cellcolor{\tableheadbgcolor}\textbf{ Description }&\cellcolor{\tableheadbgcolor}\textbf{ Required   }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Argument }&\cellcolor{\tableheadbgcolor}\textbf{ Type }&\cellcolor{\tableheadbgcolor}\textbf{ Description }&\cellcolor{\tableheadbgcolor}\textbf{ Required   }\\\cline{1-4}
\endhead
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily name} }&String or Array of Strings &Hook name, for example {\ttfamily \textquotesingle{}save\textquotesingle{}}. Or an array of names, see example below. &Yes  \\\cline{1-4}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily method} }&Function &Callback to be executed after all before hooks finished execution successfully. {\ttfamily options} is passed as first argument &Yes  \\\cline{1-4}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily options} }&Object &Will be passed to all before hooks as reference, so they can mutate it &No, defaults to empty object ({\ttfamily \{\}})  \\\cline{1-4}
\end{longtabu}


Resolves with whatever {\ttfamily method} returns or resolves with. Rejects with error that is thrown or rejected with by


\begin{DoxyEnumerate}
\item Any of the before hooks, whichever rejects / throws first
\item {\ttfamily method}
\item Any of the after hooks, whichever rejects / throws first
\end{DoxyEnumerate}

Simple Example


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection(}
\DoxyCodeLine{\ \ "{}save"{},}
\DoxyCodeLine{\ \ (record)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ return\ store.save(record);}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\ \ record}
\DoxyCodeLine{);}
\DoxyCodeLine{//\ shorter:\ \ hookCollection('save',\ store.save,\ record)}
\DoxyCodeLine{}
\DoxyCodeLine{hookCollection.before("{}save"{},\ function\ addTimestamps(record)\ \{}
\DoxyCodeLine{\ \ const\ now\ =\ new\ Date().toISOString();}
\DoxyCodeLine{\ \ if\ (record.createdAt)\ \{}
\DoxyCodeLine{\ \ \ \ record.updatedAt\ =\ now;}
\DoxyCodeLine{\ \ \}\ else\ \{}
\DoxyCodeLine{\ \ \ \ record.createdAt\ =\ now;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\});}

\end{DoxyCode}


Example defining multiple hooks at once.


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection(}
\DoxyCodeLine{\ \ ["{}add"{},\ "{}save"{}],}
\DoxyCodeLine{\ \ (record)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ return\ store.save(record);}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\ \ record}
\DoxyCodeLine{);}
\DoxyCodeLine{}
\DoxyCodeLine{hookCollection.before("{}add"{},\ function\ addTimestamps(record)\ \{}
\DoxyCodeLine{\ \ if\ (!record.type)\ \{}
\DoxyCodeLine{\ \ \ \ throw\ new\ Error("{}type\ property\ is\ required"{});}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{hookCollection.before("{}save"{},\ function\ addTimestamps(record)\ \{}
\DoxyCodeLine{\ \ if\ (!record.type)\ \{}
\DoxyCodeLine{\ \ \ \ throw\ new\ Error("{}type\ property\ is\ required"{});}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\});}

\end{DoxyCode}


Defining multiple hooks is helpful if you have similar methods for which you want to define separate hooks, but also an additional hook that gets called for all at once. The example above is equal to this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection(}
\DoxyCodeLine{\ \ "{}add"{},}
\DoxyCodeLine{\ \ (record)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ return\ hookCollection(}
\DoxyCodeLine{\ \ \ \ \ \ "{}save"{},}
\DoxyCodeLine{\ \ \ \ \ \ (record)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ return\ store.save(record);}
\DoxyCodeLine{\ \ \ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \ \ record}
\DoxyCodeLine{\ \ \ \ );}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\ \ record}
\DoxyCodeLine{);}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md9223}{}\doxysubsubsection{\texorpdfstring{hook\+Collection.\+before()}{hook\+Collection.\+before()}}\label{README.md_autotoc_md9223}
Add before hook for given name.


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection.before(name,\ method);}

\end{DoxyCode}


\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Argument }&\cellcolor{\tableheadbgcolor}\textbf{ Type }&\cellcolor{\tableheadbgcolor}\textbf{ Description }&\cellcolor{\tableheadbgcolor}\textbf{ Required   }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Argument }&\cellcolor{\tableheadbgcolor}\textbf{ Type }&\cellcolor{\tableheadbgcolor}\textbf{ Description }&\cellcolor{\tableheadbgcolor}\textbf{ Required   }\\\cline{1-4}
\endhead
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily name} }&String &Hook name, for example {\ttfamily \textquotesingle{}save\textquotesingle{}} &Yes  \\\cline{1-4}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily method} }&Function &Executed before the wrapped method. Called with the hook’s {\ttfamily options} argument. Before hooks can mutate the passed options before they are passed to the wrapped method.  &Yes  \\\cline{1-4}
\end{longtabu}


Example


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection.before("{}save"{},\ function\ validate(record)\ \{}
\DoxyCodeLine{\ \ if\ (!record.name)\ \{}
\DoxyCodeLine{\ \ \ \ throw\ new\ Error("{}name\ property\ is\ required"{});}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md9224}{}\doxysubsubsection{\texorpdfstring{hook\+Collection.\+error()}{hook\+Collection.\+error()}}\label{README.md_autotoc_md9224}
Add error hook for given name.


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection.error(name,\ method);}

\end{DoxyCode}


\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Argument }&\cellcolor{\tableheadbgcolor}\textbf{ Type }&\cellcolor{\tableheadbgcolor}\textbf{ Description }&\cellcolor{\tableheadbgcolor}\textbf{ Required   }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Argument }&\cellcolor{\tableheadbgcolor}\textbf{ Type }&\cellcolor{\tableheadbgcolor}\textbf{ Description }&\cellcolor{\tableheadbgcolor}\textbf{ Required   }\\\cline{1-4}
\endhead
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily name} }&String &Hook name, for example {\ttfamily \textquotesingle{}save\textquotesingle{}} &Yes  \\\cline{1-4}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily method} }&Function &Executed when an error occurred in either the wrapped method or a {\ttfamily before} hook. Called with the thrown {\ttfamily error} and the hook’s {\ttfamily options} argument. The first {\ttfamily method} which does not throw an error will set the result that the after hook methods will receive.  &Yes  \\\cline{1-4}
\end{longtabu}


Example


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection.error("{}save"{},\ (error,\ options)\ =>\ \{}
\DoxyCodeLine{\ \ if\ (error.ignore)\ return;}
\DoxyCodeLine{\ \ throw\ error;}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md9225}{}\doxysubsubsection{\texorpdfstring{hook\+Collection.\+after()}{hook\+Collection.\+after()}}\label{README.md_autotoc_md9225}
Add after hook for given name.


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection.after(name,\ method);}

\end{DoxyCode}


\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Argument }&\cellcolor{\tableheadbgcolor}\textbf{ Type }&\cellcolor{\tableheadbgcolor}\textbf{ Description }&\cellcolor{\tableheadbgcolor}\textbf{ Required   }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Argument }&\cellcolor{\tableheadbgcolor}\textbf{ Type }&\cellcolor{\tableheadbgcolor}\textbf{ Description }&\cellcolor{\tableheadbgcolor}\textbf{ Required   }\\\cline{1-4}
\endhead
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily name} }&String &Hook name, for example {\ttfamily \textquotesingle{}save\textquotesingle{}} &Yes  \\\cline{1-4}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily method} }&Function &Executed after wrapped method. Called with what the wrapped method resolves with the hook’s {\ttfamily options} argument.  &Yes  \\\cline{1-4}
\end{longtabu}


Example


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection.after("{}save"{},\ (result,\ options)\ =>\ \{}
\DoxyCodeLine{\ \ if\ (result.updatedAt)\ \{}
\DoxyCodeLine{\ \ \ \ app.emit("{}update"{},\ result);}
\DoxyCodeLine{\ \ \}\ else\ \{}
\DoxyCodeLine{\ \ \ \ app.emit("{}create"{},\ result);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md9226}{}\doxysubsubsection{\texorpdfstring{hook\+Collection.\+wrap()}{hook\+Collection.\+wrap()}}\label{README.md_autotoc_md9226}
Add wrap hook for given name.


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection.wrap(name,\ method);}

\end{DoxyCode}


\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Argument }&\cellcolor{\tableheadbgcolor}\textbf{ Type }&\cellcolor{\tableheadbgcolor}\textbf{ Description }&\cellcolor{\tableheadbgcolor}\textbf{ Required   }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Argument }&\cellcolor{\tableheadbgcolor}\textbf{ Type }&\cellcolor{\tableheadbgcolor}\textbf{ Description }&\cellcolor{\tableheadbgcolor}\textbf{ Required   }\\\cline{1-4}
\endhead
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily name} }&String &Hook name, for example {\ttfamily \textquotesingle{}save\textquotesingle{}} &Yes  \\\cline{1-4}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily method} }&Function &Receives both the wrapped method and the passed options as arguments so it can add logic before and after the wrapped method, it can handle errors and even replace the wrapped method altogether  &Yes  \\\cline{1-4}
\end{longtabu}


Example


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection.wrap("{}save"{},\ async\ (saveInDatabase,\ options)\ =>\ \{}
\DoxyCodeLine{\ \ if\ (!record.name)\ \{}
\DoxyCodeLine{\ \ \ \ throw\ new\ Error("{}name\ property\ is\ required"{});}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ try\ \{}
\DoxyCodeLine{\ \ \ \ const\ result\ =\ await\ saveInDatabase(options);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ if\ (result.updatedAt)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ app.emit("{}update"{},\ result);}
\DoxyCodeLine{\ \ \ \ \}\ else\ \{}
\DoxyCodeLine{\ \ \ \ \ \ app.emit("{}create"{},\ result);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ return\ result;}
\DoxyCodeLine{\ \ \}\ catch\ (error)\ \{}
\DoxyCodeLine{\ \ \ \ if\ (error.ignore)\ return;}
\DoxyCodeLine{\ \ \ \ throw\ error;}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\});}

\end{DoxyCode}


See also\+: Test mock example\hypertarget{README.md_autotoc_md9227}{}\doxysubsubsection{\texorpdfstring{hook\+Collection.\+remove()}{hook\+Collection.\+remove()}}\label{README.md_autotoc_md9227}
Removes hook for given name.


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection.remove(name,\ hookMethod);}

\end{DoxyCode}


\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Argument }&\cellcolor{\tableheadbgcolor}\textbf{ Type }&\cellcolor{\tableheadbgcolor}\textbf{ Description }&\cellcolor{\tableheadbgcolor}\textbf{ Required   }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\cellcolor{\tableheadbgcolor}\textbf{ Argument }&\cellcolor{\tableheadbgcolor}\textbf{ Type }&\cellcolor{\tableheadbgcolor}\textbf{ Description }&\cellcolor{\tableheadbgcolor}\textbf{ Required   }\\\cline{1-4}
\endhead
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily name} }&String &Hook name, for example {\ttfamily \textquotesingle{}save\textquotesingle{}} &Yes  \\\cline{1-4}
\cellcolor{\tableheadbgcolor}\textbf{ {\ttfamily before\+Hook\+Method} }&Function &Same function that was previously passed to {\ttfamily hook\+Collection.\+before()}, {\ttfamily hook\+Collection.\+error()}, {\ttfamily hook\+Collection.\+after()} or {\ttfamily hook\+Collection.\+wrap()}  &Yes  \\\cline{1-4}
\end{longtabu}


Example


\begin{DoxyCode}{0}
\DoxyCodeLine{hookCollection.remove("{}save"{},\ validateRecord);}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md9228}{}\doxysubsection{\texorpdfstring{Type\+Script}{Type\+Script}}\label{README.md_autotoc_md9228}
This library contains type definitions for Type\+Script.\hypertarget{README.md_autotoc_md9229}{}\doxysubsubsection{\texorpdfstring{Type support for {\ttfamily Singular}\+:}{Type support for {\ttfamily Singular}\+:}}\label{README.md_autotoc_md9229}

\begin{DoxyCode}{0}
\DoxyCodeLine{import\ Hook\ from\ "{}before-\/after-\/hook"{};}
\DoxyCodeLine{}
\DoxyCodeLine{type\ TOptions\ =\ \{\ foo:\ string\ \};\ //\ type\ for\ options}
\DoxyCodeLine{type\ TResult\ =\ \{\ bar:\ number\ \};\ //\ type\ for\ result}
\DoxyCodeLine{type\ TError\ =\ Error;\ //\ type\ for\ error}
\DoxyCodeLine{}
\DoxyCodeLine{const\ hook\ =\ new\ Hook.Singular<TOptions,\ TResult,\ TError>();}
\DoxyCodeLine{}
\DoxyCodeLine{hook.before((options)\ =>\ \{}
\DoxyCodeLine{\ \ //\ \`{}options.foo`\ has\ \`{}string`\ type}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ not\ allowed}
\DoxyCodeLine{\ \ options.foo\ =\ 42;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ allowed}
\DoxyCodeLine{\ \ options.foo\ =\ "{}Forty-\/Two"{};}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{const\ hookedMethod\ =\ hook(}
\DoxyCodeLine{\ \ (options)\ =>\ \{}
\DoxyCodeLine{\ \ \ \ //\ \`{}options.foo`\ has\ \`{}string`\ type}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ //\ not\ allowed,\ because\ it\ does\ not\ satisfy\ the\ \`{}R`\ type}
\DoxyCodeLine{\ \ \ \ return\ \{\ foo:\ 42\ \};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ //\ allowed}
\DoxyCodeLine{\ \ \ \ return\ \{\ bar:\ 42\ \};}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\ \ \{\ foo:\ "{}Forty-\/Two"{}\ \}}
\DoxyCodeLine{);}

\end{DoxyCode}


You can choose not to pass the types for options, result or error. So, these are completely valid\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ hook\ =\ new\ Hook.Singular<O,\ R>();}
\DoxyCodeLine{const\ hook\ =\ new\ Hook.Singular<O>();}
\DoxyCodeLine{const\ hook\ =\ new\ Hook.Singular();}

\end{DoxyCode}


In these cases, the omitted types will implicitly be {\ttfamily any}.\hypertarget{README.md_autotoc_md9230}{}\doxysubsubsection{\texorpdfstring{Type support for {\ttfamily Collection}\+:}{Type support for {\ttfamily Collection}\+:}}\label{README.md_autotoc_md9230}
{\ttfamily Collection} also has strict type support. You can use it like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ Hook\ \}\ from\ "{}before-\/after-\/hook"{};}
\DoxyCodeLine{}
\DoxyCodeLine{type\ HooksType\ =\ \{}
\DoxyCodeLine{\ \ add:\ \{}
\DoxyCodeLine{\ \ \ \ Options:\ \{\ type:\ string\ \};}
\DoxyCodeLine{\ \ \ \ Result:\ \{\ id:\ number\ \};}
\DoxyCodeLine{\ \ \ \ Error:\ Error;}
\DoxyCodeLine{\ \ \};}
\DoxyCodeLine{\ \ save:\ \{}
\DoxyCodeLine{\ \ \ \ Options:\ \{\ type:\ string\ \};}
\DoxyCodeLine{\ \ \ \ Result:\ \{\ id:\ number\ \};}
\DoxyCodeLine{\ \ \};}
\DoxyCodeLine{\ \ read:\ \{}
\DoxyCodeLine{\ \ \ \ Options:\ \{\ id:\ number;\ foo:\ number\ \};}
\DoxyCodeLine{\ \ \};}
\DoxyCodeLine{\ \ destroy:\ \{}
\DoxyCodeLine{\ \ \ \ Options:\ \{\ id:\ number;\ foo:\ string\ \};}
\DoxyCodeLine{\ \ \};}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ hooks\ =\ new\ Hook.Collection<HooksType>();}
\DoxyCodeLine{}
\DoxyCodeLine{hooks.before("{}destroy"{},\ (options)\ =>\ \{}
\DoxyCodeLine{\ \ //\ \`{}options.id`\ has\ \`{}number`\ type}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{hooks.error("{}add"{},\ (err,\ options)\ =>\ \{}
\DoxyCodeLine{\ \ //\ \`{}options.type`\ has\ \`{}string`\ type}
\DoxyCodeLine{\ \ //\ \`{}err`\ is\ \`{}instanceof\ Error`}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{hooks.error("{}save"{},\ (err,\ options)\ =>\ \{}
\DoxyCodeLine{\ \ //\ \`{}options.type`\ has\ \`{}string`\ type}
\DoxyCodeLine{\ \ //\ \`{}err`\ has\ type\ \`{}any`}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{hooks.after("{}save"{},\ (result,\ options)\ =>\ \{}
\DoxyCodeLine{\ \ //\ \`{}options.type`\ has\ \`{}string`\ type}
\DoxyCodeLine{\ \ //\ \`{}result.id`\ has\ \`{}number`\ type}
\DoxyCodeLine{\});}

\end{DoxyCode}


You can choose not to pass the types altogether. In that case, everything will implicitly be {\ttfamily any}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ hook\ =\ new\ Hook.Collection();}

\end{DoxyCode}


Alternative imports\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{\ Singular,\ Collection\ \}\ from\ "{}before-\/after-\/hook"{};}
\DoxyCodeLine{}
\DoxyCodeLine{const\ hook\ =\ new\ Singular();}
\DoxyCodeLine{const\ hooks\ =\ new\ Collection();}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md9231}{}\doxysubsection{\texorpdfstring{Upgrading to 1.\+4}{Upgrading to 1.\+4}}\label{README.md_autotoc_md9231}
Since version 1.\+4 the {\ttfamily Hook} constructor has been deprecated in favor of returning {\ttfamily Hook.\+Singular} in an upcoming breaking release.

Version 1.\+4 is still 100\% backwards-\/compatible, but if you want to continue using hook collections, we recommend using the {\ttfamily Hook.\+Collection} constructor instead before the next release.

For even more details, check out \href{https://github.com/gr2m/before-after-hook/pull/52}{\texttt{ the PR}}.\hypertarget{README.md_autotoc_md9232}{}\doxysubsection{\texorpdfstring{See also}{See also}}\label{README.md_autotoc_md9232}
If {\ttfamily before-\/after-\/hook} is not for you, have a look at one of these alternatives\+:


\begin{DoxyItemize}
\item \href{https://github.com/keystonejs/grappling-hook}{\texttt{ https\+://github.\+com/keystonejs/grappling-\/hook}}
\item \href{https://github.com/sebelga/promised-hooks}{\texttt{ https\+://github.\+com/sebelga/promised-\/hooks}}
\item \href{https://github.com/bnoguchi/hooks-js}{\texttt{ https\+://github.\+com/bnoguchi/hooks-\/js}}
\item \href{https://github.com/cb1kenobi/hook-emitter}{\texttt{ https\+://github.\+com/cb1kenobi/hook-\/emitter}}
\end{DoxyItemize}\hypertarget{README.md_autotoc_md9233}{}\doxysubsection{\texorpdfstring{License}{License}}\label{README.md_autotoc_md9233}
\mbox{[}Apache 2.\+0\mbox{]}(LICENSE) 