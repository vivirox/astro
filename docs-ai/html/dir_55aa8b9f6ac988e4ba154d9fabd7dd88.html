<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gradiant Ascent: node_modules/mlly Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Gradiant Ascent
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dir_55aa8b9f6ac988e4ba154d9fabd7dd88.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">mlly Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="subdirs" name="subdirs"></a>
Directories</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top"><span class="iconfclosed"></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_abf09d3ea3c57abc03a5454579a09905.html">node_modules</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p><a href="https://npmjs.com/package/mlly"><img src="https://img.shields.io/npm/v/mlly?style=flat&amp;colorA=18181B&amp;colorB=F0DB4F" alt="npm version" class="inline"/></a> <a href="https://npmjs.com/package/mlly"><img src="https://img.shields.io/npm/dm/mlly?style=flat&amp;colorA=18181B&amp;colorB=F0DB4F" alt="npm downloads" class="inline"/></a> <a href="https://codecov.io/gh/unjs/mlly"><img src="https://img.shields.io/codecov/c/gh/unjs/mlly/main?style=flat&amp;colorA=18181B&amp;colorB=F0DB4F" alt="Codecov" class="inline"/></a></p>
<blockquote class="doxtable">
<p>Missing <a href="https://nodejs.org/api/esm.html">ECMAScript module</a> utils for Node.js </p>
</blockquote>
<p>While ESM Modules are evolving in Node.js ecosystem, there are still many required features that are still experimental or missing or needed to support ESM. This package tries to fill in the gap.</p>
<h1><a class="anchor" id="autotoc_md24247"></a>
Usage</h1>
<p>Install npm package:</p>
<div class="fragment"><div class="line"># using yarn</div>
<div class="line">yarn add mlly</div>
<div class="line"> </div>
<div class="line"># using npm</div>
<div class="line">npm install mlly</div>
</div><!-- fragment --><p><b>Note:</b> Node.js 14+ is recommended.</p>
<p>Import utils:</p>
<div class="fragment"><div class="line">// ESM</div>
<div class="line">import {} from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// CommonJS</div>
<div class="line">const {} = require(&quot;mlly&quot;);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md24248"></a>
Resolving ESM modules</h1>
<p>Several utilities to make ESM resolution easier:</p>
<ul>
<li>Respecting <a href="https://nodejs.org/dist/latest-v14.x/docs/api/esm.html#esm_resolver_algorithm">ECMAScript Resolver algorithm</a></li>
<li>Exposed from Node.js implementation</li>
<li>Windows paths normalized</li>
<li>Supporting custom <code>extensions</code> and <code>/index</code> resolution</li>
<li>Supporting custom <code>conditions</code></li>
<li>Support resolving from multiple paths or urls</li>
</ul>
<h2><a class="anchor" id="autotoc_md24249"></a>
<code>resolve</code> / <code>resolveSync</code></h2>
<p>Resolve a module by respecting <a href="https://nodejs.org/dist/latest-v14.x/docs/api/esm.html#esm_resolver_algorithm">ECMAScript Resolver algorithm</a> (using <a href="https://github.com/wooorm/import-meta-resolve">wooorm/import-meta-resolve</a>).</p>
<p>Additionally supports resolving without extension and <code>/index</code> similar to CommonJS.</p>
<div class="fragment"><div class="line">import { resolve, resolveSync } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// file:///home/user/project/module.mjs</div>
<div class="line">console.log(await resolve(&quot;./module.mjs&quot;, { url: import.meta.url }));</div>
</div><!-- fragment --><p><b>Resolve options:</b></p>
<ul>
<li><code>url</code>: URL or string to resolve from (default is <code>pwd()</code>)</li>
<li><code>conditions</code>: Array of conditions used for resolution algorithm (default is &lsquo;['node&rsquo;, 'import']<code>) -</code>extensions<code>: Array of additional extensions to check if import failed (default is</code>['.mjs', '.cjs', '.js', '.json']`)</li>
</ul>
<h2><a class="anchor" id="autotoc_md24250"></a>
<code>resolvePath</code> / <code>resolvePathSync</code></h2>
<p>Similar to <code>resolve</code> but returns a path instead of URL using <code>fileURLToPath</code>.</p>
<div class="fragment"><div class="line">import { resolvePath, resolveSync } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// /home/user/project/module.mjs</div>
<div class="line">console.log(await resolvePath(&quot;./module.mjs&quot;, { url: import.meta.url }));</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24251"></a>
<code>createResolve</code></h2>
<p>Create a <code>resolve</code> function with defaults.</p>
<div class="fragment"><div class="line">import { createResolve } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">const _resolve = createResolve({ url: import.meta.url });</div>
<div class="line"> </div>
<div class="line">// file:///home/user/project/module.mjs</div>
<div class="line">console.log(await _resolve(&quot;./module.mjs&quot;));</div>
</div><!-- fragment --><p><b>Example:</b> Ponyfill <a href="https://nodejs.org/api/esm.html#esm_import_meta_resolve_specifier_parent">import.meta.resolve</a>:</p>
<div class="fragment"><div class="line">import { createResolve } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">import.meta.resolve = createResolve({ url: import.meta.url });</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24252"></a>
<code>resolveImports</code></h2>
<p>Resolve all static and dynamic imports with relative paths to full resolved path.</p>
<div class="fragment"><div class="line">import { resolveImports } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// import foo from &#39;file:///home/user/project/bar.mjs&#39;</div>
<div class="line">console.log(</div>
<div class="line">  await resolveImports(`import foo from &#39;./bar.mjs&#39;`, { url: import.meta.url }),</div>
<div class="line">);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md24253"></a>
Syntax Analyzes</h1>
<h2><a class="anchor" id="autotoc_md24254"></a>
<code>isValidNodeImport</code></h2>
<p>Using various syntax detection and heuristics, this method can determine if import is a valid import or not to be imported using dynamic <code>import()</code> before hitting an error!</p>
<p>When result is <code>false</code>, we usually need a to create a CommonJS require context or add specific rules to the bundler to transform dependency.</p>
<div class="fragment"><div class="line">import { isValidNodeImport } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// If returns true, we are safe to use `import(&#39;some-lib&#39;)`</div>
<div class="line">await isValidNodeImport(&quot;some-lib&quot;, {});</div>
</div><!-- fragment --><p><b>Algorithm:</b></p>
<ul>
<li>Check import protocol - If is <code>data:</code> return <code>true</code> (✅ valid) - If is not <code>node:</code>, <code>file:</code> or <code>data:</code>, return <code>false</code> ( ❌ invalid)</li>
<li>Resolve full path of import using Node.js <a href="https://nodejs.org/api/esm.html#resolution-algorithm">Resolution algorithm</a></li>
<li>Check full path extension<ul>
<li>If is <code>.mjs</code>, <code>.cjs</code>, <code>.node</code> or <code>.wasm</code>, return <code>true</code> (✅ valid)</li>
<li>If is not <code>.js</code>, return <code>false</code> (❌ invalid)</li>
<li>If is matching known mixed syntax (<code>.esm.js</code>, <code>.es.js</code>, etc) return <code>false</code> ( ❌ invalid)</li>
</ul>
</li>
<li>Read closest <code>package.json</code> file to resolve path</li>
<li>If &lsquo;type: 'module&rsquo;<code>field is set, return</code>true<code>(✅ valid)</code></li>
<li><code>Read source code of resolved path</code></li>
<li><code>Try to detect CommonJS syntax usage<ul>
<li>If yes, return</li>
</ul>
</code>true<code>(✅ valid)</code></li>
<li><code>Try to detect ESM syntax usage<ul>
<li>if yes, return</li>
</ul>
</code>false` ( ❌ invalid)</li>
</ul>
<p><b>Notes:</b></p>
<ul>
<li>There might be still edge cases algorithm cannot cover. It is designed with best-efforts.</li>
<li>This method also allows using dynamic import of CommonJS libraries considering Node.js has <a href="https://nodejs.org/api/esm.html#interoperability-with-commonjs">Interoperability with CommonJS</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md24255"></a>
<code>hasESMSyntax</code></h2>
<p>Detect if code, has usage of ESM syntax (Static <code>import</code>, ESM <code>export</code> and <code>import.meta</code> usage)</p>
<div class="fragment"><div class="line">import { hasESMSyntax } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">hasESMSyntax(&quot;export default foo = 123&quot;); // true</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24256"></a>
<code>hasCJSSyntax</code></h2>
<p>Detect if code, has usage of CommonJS syntax (<code>exports</code>, <code>module.exports</code>, <code>require</code> and <code>global</code> usage)</p>
<div class="fragment"><div class="line">import { hasCJSSyntax } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">hasCJSSyntax(&quot;export default foo = 123&quot;); // false</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24257"></a>
<code>detectSyntax</code></h2>
<p>Tests code against both CJS and ESM.</p>
<p><code>isMixed</code> indicates if both are detected! This is a common case with legacy packages exporting semi-compatible ESM syntax meant to be used by bundlers.</p>
<div class="fragment"><div class="line">import { detectSyntax } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// { hasESM: true, hasCJS: true, isMixed: true }</div>
<div class="line">detectSyntax(&#39;export default require(&quot;lodash&quot;)&#39;);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md24258"></a>
CommonJS Context</h1>
<h2><a class="anchor" id="autotoc_md24259"></a>
<code>createCommonJS</code></h2>
<p>This utility creates a compatible CommonJS context that is missing in ECMAScript modules.</p>
<div class="fragment"><div class="line">import { createCommonJS } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">const { __dirname, __filename, require } = createCommonJS(import.meta.url);</div>
</div><!-- fragment --><p>Note: <code>require</code> and <code>require.resolve</code> implementation are lazy functions. <a href="https://nodejs.org/api/module.html#module_module_createrequire_filename"><code>createRequire</code></a> will be called on first usage.</p>
<h1><a class="anchor" id="autotoc_md24260"></a>
Import/Export Analyzes</h1>
<p>Tools to quickly analyze ESM syntax and extract static <code>import</code>/<code>export</code></p>
<ul>
<li>Super fast Regex based implementation</li>
<li>Handle most edge cases</li>
<li>Find all static ESM imports</li>
<li>Find all dynamic ESM imports</li>
<li>Parse static import statement</li>
<li>Find all named, declared and default exports</li>
</ul>
<h2><a class="anchor" id="autotoc_md24261"></a>
<code>findStaticImports</code></h2>
<p>Find all static ESM imports.</p>
<p>Example:</p>
<div class="fragment"><div class="line">import { findStaticImports } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">console.log(</div>
<div class="line">  findStaticImports(`</div>
<div class="line">// Empty line</div>
<div class="line">import foo, { bar /* foo */ } from &#39;baz&#39;</div>
<div class="line">`),</div>
<div class="line">);</div>
</div><!-- fragment --><p>Outputs:</p>
<div class="fragment"><div class="line">[</div>
<div class="line">  {</div>
<div class="line">    type: &quot;static&quot;,</div>
<div class="line">    imports: &quot;foo, { bar /* foo */ } &quot;,</div>
<div class="line">    specifier: &quot;baz&quot;,</div>
<div class="line">    code: &quot;import foo, { bar /* foo */ } from &#39;baz&#39;&quot;,</div>
<div class="line">    start: 15,</div>
<div class="line">    end: 55,</div>
<div class="line">  },</div>
<div class="line">];</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24262"></a>
<code>parseStaticImport</code></h2>
<p>Parse a dynamic ESM import statement previously matched by <code>findStaticImports</code>.</p>
<p>Example:</p>
<div class="fragment"><div class="line">import { findStaticImports, parseStaticImport } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">const [match0] = findStaticImports(`import baz, { x, y as z } from &#39;baz&#39;`);</div>
<div class="line">console.log(parseStaticImport(match0));</div>
</div><!-- fragment --><p>Outputs:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  type: &#39;static&#39;,</div>
<div class="line">  imports: &#39;baz, { x, y as z } &#39;,</div>
<div class="line">  specifier: &#39;baz&#39;,</div>
<div class="line">  code: &quot;import baz, { x, y as z } from &#39;baz&#39;&quot;,</div>
<div class="line">  start: 0,</div>
<div class="line">  end: 36,</div>
<div class="line">  defaultImport: &#39;baz&#39;,</div>
<div class="line">  namespacedImport: undefined,</div>
<div class="line">  namedImports: { x: &#39;x&#39;, y: &#39;z&#39; }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24263"></a>
<code>findDynamicImports</code></h2>
<p>Find all dynamic ESM imports.</p>
<p>Example:</p>
<div class="fragment"><div class="line">import { findDynamicImports } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">console.log(</div>
<div class="line">  findDynamicImports(`</div>
<div class="line">const foo = await import(&#39;bar&#39;)</div>
<div class="line">`),</div>
<div class="line">);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24264"></a>
<code>findExports</code></h2>
<div class="fragment"><div class="line">import { findExports } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">console.log(</div>
<div class="line">  findExports(`</div>
<div class="line">export const foo = &#39;bar&#39;</div>
<div class="line">export { bar, baz }</div>
<div class="line">export default something</div>
<div class="line">`),</div>
<div class="line">);</div>
</div><!-- fragment --><p>Outputs:</p>
<div class="fragment"><div class="line">[</div>
<div class="line">  {</div>
<div class="line">    type: &quot;declaration&quot;,</div>
<div class="line">    declaration: &quot;const&quot;,</div>
<div class="line">    name: &quot;foo&quot;,</div>
<div class="line">    code: &quot;export const foo&quot;,</div>
<div class="line">    start: 1,</div>
<div class="line">    end: 17,</div>
<div class="line">  },</div>
<div class="line">  {</div>
<div class="line">    type: &quot;named&quot;,</div>
<div class="line">    exports: &quot; bar, baz &quot;,</div>
<div class="line">    code: &quot;export { bar, baz }&quot;,</div>
<div class="line">    start: 26,</div>
<div class="line">    end: 45,</div>
<div class="line">    names: [&quot;bar&quot;, &quot;baz&quot;],</div>
<div class="line">  },</div>
<div class="line">  { type: &quot;default&quot;, code: &quot;export default &quot;, start: 46, end: 61 },</div>
<div class="line">];</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24265"></a>
<code>findExportNames</code></h2>
<p>Same as <code>findExports</code> but returns array of export names.</p>
<div class="fragment"><div class="line">import { findExportNames } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// [ &quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;, &quot;default&quot; ]</div>
<div class="line">console.log(</div>
<div class="line">  findExportNames(`</div>
<div class="line">export const foo = &#39;bar&#39;</div>
<div class="line">export { bar, baz }</div>
<div class="line">export default something</div>
<div class="line">`),</div>
<div class="line">);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md24266"></a>
<code>resolveModuleExportNames</code></h1>
<p>Resolves module and reads its contents to extract possible export names using static analyzes.</p>
<div class="fragment"><div class="line">import { resolveModuleExportNames } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// [&quot;basename&quot;, &quot;dirname&quot;, ... ]</div>
<div class="line">console.log(await resolveModuleExportNames(&quot;mlly&quot;));</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md24267"></a>
Evaluating Modules</h1>
<p>Set of utilities to evaluate ESM modules using <code>data:</code> imports</p>
<ul>
<li>Automatic import rewrite to resolved path using static analyzes</li>
<li>Allow bypass ESM Cache</li>
<li>Stack-trace support</li>
<li><code>.json</code> loader</li>
</ul>
<h2><a class="anchor" id="autotoc_md24268"></a>
<code>evalModule</code></h2>
<p>Transform and evaluates module code using dynamic imports.</p>
<div class="fragment"><div class="line">import { evalModule } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">await evalModule(`console.log(&quot;Hello World!&quot;)`);</div>
<div class="line"> </div>
<div class="line">await evalModule(</div>
<div class="line">  `</div>
<div class="line">  import { reverse } from &#39;./utils.mjs&#39;</div>
<div class="line">  console.log(reverse(&#39;!emosewa si sj&#39;))</div>
<div class="line">`,</div>
<div class="line">  { url: import.meta.url },</div>
<div class="line">);</div>
</div><!-- fragment --><p><b>Options:</b></p>
<ul>
<li>all <code>resolve</code> options</li>
<li><code>url</code>: File URL</li>
</ul>
<h2><a class="anchor" id="autotoc_md24269"></a>
<code>loadModule</code></h2>
<p>Dynamically loads a module by evaluating source code.</p>
<div class="fragment"><div class="line">import { loadModule } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">await loadModule(&quot;./hello.mjs&quot;, { url: import.meta.url });</div>
</div><!-- fragment --><p>Options are same as <code>evalModule</code>.</p>
<h2><a class="anchor" id="autotoc_md24270"></a>
<code>transformModule</code></h2>
<ul>
<li>Resolves all relative imports will be resolved</li>
<li>All usages of <code>import.meta.url</code> will be replaced with <code>url</code> or <code>from</code> option</li>
</ul>
<div class="fragment"><div class="line">import { transformModule } from &quot;mlly&quot;;</div>
<div class="line">console.log(transformModule(`console.log(import.meta.url)`), {</div>
<div class="line">  url: &quot;test.mjs&quot;,</div>
<div class="line">});</div>
</div><!-- fragment --><p>Options are same as <code>evalModule</code>.</p>
<h1><a class="anchor" id="autotoc_md24271"></a>
Other Utils</h1>
<h2><a class="anchor" id="autotoc_md24272"></a>
<code>fileURLToPath</code></h2>
<p>Similar to <a href="https://nodejs.org/api/url.html#url_url_fileurltopath_url">url.fileURLToPath</a> but also converts windows backslash <code>\</code> to unix slash <code>/</code> and handles if input is already a path.</p>
<div class="fragment"><div class="line">import { fileURLToPath } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// /foo/bar.js</div>
<div class="line">console.log(fileURLToPath(&quot;file:///foo/bar.js&quot;));</div>
<div class="line"> </div>
<div class="line">// C:/path</div>
<div class="line">console.log(fileURLToPath(&quot;file:///C:/path/&quot;));</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24273"></a>
<code>pathToFileURL</code></h2>
<p>Similar to <a href="https://nodejs.org/api/url.html#urlpathtofileurlpath">url.pathToFileURL</a> but also handles <code>URL</code> input and returns a <b>string</b> with <code><a href="file://">file://</a></code> protocol.</p>
<div class="fragment"><div class="line">import { pathToFileURL } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// /foo/bar.js</div>
<div class="line">console.log(pathToFileURL(&quot;foo/bar.js&quot;));</div>
<div class="line"> </div>
<div class="line">// C:/path</div>
<div class="line">console.log(pathToFileURL(&quot;C:\\path&quot;));</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24274"></a>
<code>normalizeid</code></h2>
<p>Ensures id has either of <code>node:</code>, <code>data:</code>, <code>http:</code>, <code>https:</code> or <code>file:</code> protocols.</p>
<div class="fragment"><div class="line">import { ensureProtocol } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// file:///foo/bar.js</div>
<div class="line">console.log(normalizeid(&quot;/foo/bar.js&quot;));</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24275"></a>
<code>loadURL</code></h2>
<p>Read source contents of a URL. (currently only file protocol supported)</p>
<div class="fragment"><div class="line">import { resolve, loadURL } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">const url = await resolve(&quot;./index.mjs&quot;, { url: import.meta.url });</div>
<div class="line">console.log(await loadURL(url));</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24276"></a>
<code>toDataURL</code></h2>
<p>Convert code to <a href="https://nodejs.org/api/esm.html#esm_data_imports"><code>data:</code></a> URL using base64 encoding.</p>
<div class="fragment"><div class="line">import { toDataURL } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">console.log(</div>
<div class="line">  toDataURL(`</div>
<div class="line">  // This is an example</div>
<div class="line">  console.log(&#39;Hello world&#39;)</div>
<div class="line">`),</div>
<div class="line">);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24277"></a>
<code>interopDefault</code></h2>
<p>Return the default export of a module at the top-level, alongside any other named exports.</p>
<div class="fragment"><div class="line">// Assuming the shape { default: { foo: &#39;bar&#39; }, baz: &#39;qux&#39; }</div>
<div class="line">import myModule from &quot;my-module&quot;;</div>
<div class="line"> </div>
<div class="line">// Returns { foo: &#39;bar&#39;, baz: &#39;qux&#39; }</div>
<div class="line">console.log(interopDefault(myModule));</div>
</div><!-- fragment --><p><b>Options:</b></p>
<ul>
<li><code>preferNamespace</code>: In case that <code>default</code> value exists but is not extendable (when is string for example), return input as-is (default is <code>false</code>, meaning <code>default</code>'s value is prefered even if cannot be extended)</li>
</ul>
<h2><a class="anchor" id="autotoc_md24278"></a>
<code>sanitizeURIComponent</code></h2>
<p>Replace reserved characters from a segment of URI to make it compatible with <a href="https://datatracker.ietf.org/doc/html/rfc2396">rfc2396</a>.</p>
<div class="fragment"><div class="line">import { sanitizeURIComponent } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// foo_bar</div>
<div class="line">console.log(sanitizeURIComponent(`foo:bar`));</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24279"></a>
<code>sanitizeFilePath</code></h2>
<p>Sanitize each path of a file name or path with <code>sanitizeURIComponent</code> for URI compatibility.</p>
<div class="fragment"><div class="line">import { sanitizeFilePath } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// C:/te_st/_...slug_.jsx&#39;</div>
<div class="line">console.log(sanitizeFilePath(&quot;C:\\te#st\\[...slug].jsx&quot;));</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24280"></a>
<code>parseNodeModulePath</code></h2>
<p>Parses an absolute file path in <code>node_modules</code> to three segments:</p>
<ul>
<li><code>dir</code>: Path to main directory of package</li>
<li><code>name</code>: Package name</li>
<li><code>subpath</code>: The optional package subpath</li>
</ul>
<p>It returns an empty object (with partial keys) if parsing fails.</p>
<div class="fragment"><div class="line">import { parseNodeModulePath } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// dir: &quot;/src/a/node_modules/&quot;</div>
<div class="line">// name: &quot;lib&quot;</div>
<div class="line">// subpath: &quot;./dist/index.mjs&quot;</div>
<div class="line">const { dir, name, subpath } = parseNodeModulePath(</div>
<div class="line">  &quot;/src/a/node_modules/lib/dist/index.mjs&quot;,</div>
<div class="line">);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24281"></a>
<code>lookupNodeModuleSubpath</code></h2>
<p>Parses an absolute file path in <code>node_modules</code> and tries to reverse lookup (or guess) the original package exports subpath for it.</p>
<div class="fragment"><div class="line">import { lookupNodeModuleSubpath } from &quot;mlly&quot;;</div>
<div class="line"> </div>
<div class="line">// subpath: &quot;./utils&quot;</div>
<div class="line">const subpath = lookupNodeModuleSubpath(</div>
<div class="line">  &quot;/src/a/node_modules/lib/dist/utils.mjs&quot;,</div>
<div class="line">);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md24282"></a>
License</h1>
<p><a href="./LICENSE">MIT</a> - Made with 💛 </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_acd06b18086a0dd2ae699b1e0b775be8.html">node_modules</a></li><li class="navelem"><a class="el" href="dir_55aa8b9f6ac988e4ba154d9fabd7dd88.html">mlly</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
