<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gradiant Ascent: node_modules/zod-to-json-schema Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Gradiant Ascent
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dir_a3ee01472ce8b3f89e14777cf1798715.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">zod-to-json-schema Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="subdirs" name="subdirs"></a>
Directories</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top"><span class="iconfclosed"></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_e2a3dbeb33fb0d92c897cb4ff591a53e.html">node_modules</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p><a href="https://npmjs.org/package/zod-to-json-schema"><img src="https://img.shields.io/npm/v/zod-to-json-schema.svg" alt="NPM Version" style="pointer-events: none;" class="inline"/></a> <a href="https://npmjs.org/package/zod-to-json-schema"><img src="https://img.shields.io/npm/dw/zod-to-json-schema.svg" alt="NPM Downloads" style="pointer-events: none;" class="inline"/></a></p>
<p><em>Looking for the exact opposite? Check out <a href="https://npmjs.org/package/json-schema-to-zod">json-schema-to-zod</a></em></p>
<h1><a class="anchor" id="autotoc_md36436"></a>
Summary</h1>
<p>Does what it says on the tin; converts <a href="https://github.com/colinhacks/zod">Zod schemas</a> into <a href="https://json-schema.org/">JSON schemas</a>!</p>
<ul>
<li>Supports all relevant schema types, basic string, number and array length validations and string patterns.</li>
<li>Resolves recursive and recurring schemas with internal <code>$ref</code>s.</li>
<li>Supports targeting legacy Open API 3.0 specification (3.1 supports regular Json Schema).</li>
<li>Supports Open AI strict mode schemas (Optional object properties are replaced with required but nullable ones).</li>
</ul>
<h1><a class="anchor" id="autotoc_md36437"></a>
Sponsors</h1>
<p>A great big thank you to our amazing sponsors! Please consider joining them through my <a href="https://github.com/sponsors/StefanTerdell">GitHub Sponsors page</a>. Every cent helps, but these fellas have really gone above and beyond 💚:</p>
<table align="center" style="justify-content: center;align-items: center;display: flex;">
<tr>
<td align="center"><p class="starttd"></p>
<p class="intertd"></p>
<p class="intertd"></p>
<p class="intertd"><a href="https://retool.com/?ref=stefanterdell&amp;utm_source=github&amp;utm_medium=referral&amp;utm_campaign=stefanterdell"><img src="https://github.com/colinhacks/zod/assets/3084745/5ef4c11b-efeb-4495-90a8-41b83f798600" alt="stainless" height="45px" class="inline"/>  </a> <br  />
 <br  />
 Build AI apps and workflows with <a href="https://retool.com/products/ai?ref=stefanterdell&amp;utm_source=github&amp;utm_medium=referral&amp;utm_campaign=stefanterdell">Retool AI</a> <br  />
 <a href="https://retool.com/?ref=stefanterdell&amp;utm_source=github&amp;utm_medium=referral&amp;utm_campaign=stefanterdell" style="text-decoration:none;">retool.com</a> </p>
<p class="intertd"></p>
<p class="intertd"></p>
<p class="endtd"></p>
</td></tr>
<tr>
<td align="center"><p class="starttd"></p>
<p class="intertd"></p>
<p class="intertd"></p>
<div style="background-color: white; padding: 4px; padding-bottom: 8px;" alt="stainless"> <a href="https://www.coderabbit.ai/"><img src="https://github.com/user-attachments/assets/d791bc7d-dc60-4d55-9c31-97779839cb74" alt="CodeRabbit logo" height="45px" class="inline"/>  </a> </div><p> <br  />
 <br  />
 Cut code review time &amp; bugs in half <br  />
 <a href="https://www.coderabbit.ai/" style="text-decoration:none;">coderabbit.ai</a> </p>
<p class="intertd"></p>
<p class="intertd"></p>
<p class="endtd"></p>
</td></tr>
</table>
<h1><a class="anchor" id="autotoc_md36438"></a>
Usage</h1>
<h2><a class="anchor" id="autotoc_md36439"></a>
Basic example</h2>
<div class="fragment"><div class="line">import { z } from &quot;zod&quot;;</div>
<div class="line">import { zodToJsonSchema } from &quot;zod-to-json-schema&quot;;</div>
<div class="line"> </div>
<div class="line">const mySchema = z</div>
<div class="line">  .object({</div>
<div class="line">    myString: z.string().min(5),</div>
<div class="line">    myUnion: z.union([z.number(), z.boolean()]),</div>
<div class="line">  })</div>
<div class="line">  .describe(&quot;My neat object schema&quot;);</div>
<div class="line"> </div>
<div class="line">const jsonSchema = zodToJsonSchema(mySchema, &quot;mySchema&quot;);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md36440"></a>
Expected output</h3>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,</div>
<div class="line">  &quot;$ref&quot;: &quot;#/definitions/mySchema&quot;,</div>
<div class="line">  &quot;definitions&quot;: {</div>
<div class="line">    &quot;mySchema&quot;: {</div>
<div class="line">      &quot;description&quot;: &quot;My neat object schema&quot;,</div>
<div class="line">      &quot;type&quot;: &quot;object&quot;,</div>
<div class="line">      &quot;properties&quot;: {</div>
<div class="line">        &quot;myString&quot;: {</div>
<div class="line">          &quot;type&quot;: &quot;string&quot;,</div>
<div class="line">          &quot;minLength&quot;: 5</div>
<div class="line">        },</div>
<div class="line">        &quot;myUnion&quot;: {</div>
<div class="line">          &quot;type&quot;: [&quot;number&quot;, &quot;boolean&quot;]</div>
<div class="line">        }</div>
<div class="line">      },</div>
<div class="line">      &quot;additionalProperties&quot;: false,</div>
<div class="line">      &quot;required&quot;: [&quot;myString&quot;, &quot;myUnion&quot;]</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md36441"></a>
Options</h1>
<h2><a class="anchor" id="autotoc_md36442"></a>
Schema name</h2>
<p>You can pass a string as the second parameter of the main zodToJsonSchema function. If you do, your schema will end up inside a definitions object property on the root and referenced from there. Alternatively, you can pass the name as the <code>name</code> property of the options object (see below).</p>
<h2><a class="anchor" id="autotoc_md36443"></a>
Options object</h2>
<p>Instead of the schema name (or nothing), you can pass an options object as the second parameter. The following options are available:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option   </th><th class="markdownTableHeadNone">Effect    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>name</b>?: <em>string</em>   </td><td class="markdownTableBodyNone">As described above.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>nameStrategy</b>?: "ref" | "title"   </td><td class="markdownTableBodyNone">Adds name as "title" meta instead of as a ref as described above    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>basePath</b>?: string[]   </td><td class="markdownTableBodyNone">The base path of the root reference builder. Defaults to ["#"].    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>$refStrategy</b>?: "root" | "relative" | "seen" | "none"   </td><td class="markdownTableBodyNone">The reference builder strategy; <ul>
<li>
<b>"root"</b> resolves $refs from the root up, ie: "#/definitions/mySchema".</li>
<li>
<b>"relative"</b> uses <a href="https://tools.ietf.org/id/draft-handrews-relative-json-pointer-00.html">relative JSON pointers</a>. <em>See known issues!</em></li>
<li>
<b>"seen"</b> reuses the output of any "seen" Zod schema. In theory it's a more performant version of "none", but in practice this behaviour can cause issues with nested schemas and has now gotten its own option. </li>
<li>
<b>"none"</b> ignores referencing all together, creating a new schema branch even on "seen" schemas. Recursive references defaults to "any", ie <code>{}</code>.</li>
</ul>
Defaults to "root".    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>effectStrategy</b>?: "input" | "any"   </td><td class="markdownTableBodyNone">The effects output strategy. Defaults to "input". <em>See known issues!</em>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>dateStrategy</b>?: "format:date" | "format:date-time" | "string" | "integer"   </td><td class="markdownTableBodyNone">Date strategy, integer allow to specify in unix-time min and max values. "format:date" creates a string schema with format: "date". "format:date-time" creates a string schema with format: "date-time". "string" is intepreted as "format:date-time". "integer" creates an integer schema with format "unix-time" (unless target "openApi3" is used min max checks are also respected)   </td></tr>
</table>
<p>| | | <b>emailStrategy</b>?: "format:email" | "format:idn-email" | "pattern:zod" | Choose how to handle the email string check. Defaults to "format:email". | | <b>base64Strategy</b>?: "format:binary" | "contentEnconding:base64" | "pattern:zod" | Choose how to handle the base64 string check. Defaults to "contentEncoding:base64" as described <a href="https://json-schema.org/understanding-json-schema/reference/non_json_data#contentencoding">here</a>. Note that "format:binary" is not represented in the output type as it's not part of the JSON Schema spec and only intended to be used when targeting OpenAPI 3.0. Later versions of OpenAPI support contentEncoding. | | <b>definitionPath</b>?: "definitions" | "$defs" | The name of the definitions property when name is passed. Defaults to "definitions". | | <b>target</b>?: "jsonSchema7" | "jsonSchema2019-09" | "openApi3" | "openAi" | Which spec to target. Defaults to "jsonSchema7" | | <b>strictUnions</b>?: boolean | Scrubs unions of any-like json schemas, like <code>{}</code> or <code>true</code>. Multiple zod types may result in these out of necessity, such as z.instanceof() | | <b>definitions</b>?: Record&lt;string, ZodSchema&gt; | See separate section below | | <b>errorMessages</b>?: boolean | Include custom error messages created via chained function checks for supported zod types. See section below | | <b>markdownDescription</b>?: boolean | Copies the <code>description</code> meta to <code>markdownDescription</code> | | <b>patternStrategy</b>?: "escape" | "preserve" | The Zod string validations <code>.includes()</code>, <code>.startsWith()</code>, and <code>.endsWith()</code> must be converted to regex to be compatible with JSON Schema's <code>pattern</code>. For safety, all non-alphanumeric characters are <code>escape</code>d by default (consider <code>z.string().includes(".")</code>), but this can occasionally cause problems with Unicode-flagged regex parsers. Use <code>preserve</code> to prevent this escaping behaviour and preserve the exact string written, even if it results in an inaccurate regex. | | <b>applyRegexFlags</b>?: boolean | JSON Schema's <code>pattern</code> doesn't support RegExp flags, but Zod's <code>z.string().regex()</code> does. When this option is true (default false), a best-effort is made to transform regexes into a flag-independent form (e.g. <code>/x/i =&gt; /[xX]/</code> ). Supported flags: <code>i</code> (basic Latin only), <code>m</code>, <code>s</code>. | | <b>pipeStrategy</b>?: "all" | "input" | "output" | Decide which types should be included when using <code>z.pipe</code>, for example <code>z.string().pipe(z.number())</code> would return both <code>string</code> and <code>number</code> by default, only <code>string</code> for "input" and only <code>number</code> for "output". | | <b>removeAdditionalStrategy</b>?: "passthrough" | "strict" | Decide when <code>additionalProperties</code> should be allowed. See the section on additional properties for details. | | <b>allowedAdditionalProperties</b>?: <code>true</code> | <code>undefined</code> | What value to give <code>additionalProperties</code> when allowed. See the section on additional properties for details. | | <b>rejectedAdditionalProperties</b>?: <code>false</code> | <code>undefined</code> | What value to give <code>additionalProperties</code> when rejected. See the section on additional properties for details. | | <b>override</b>?: callback | See section | | <b>postProcess</b>?: callback | See section |</p>
<h2><a class="anchor" id="autotoc_md36444"></a>
Definitions</h2>
<p>The definitions option lets you manually add recurring schemas into definitions for cleaner outputs. It's fully compatible with named schemas, changed definitions path and base path. Here's a simple example:</p>
<div class="fragment"><div class="line">const myRecurringSchema = z.string();</div>
<div class="line">const myObjectSchema = z.object({ a: myRecurringSchema, b: myRecurringSchema });</div>
<div class="line"> </div>
<div class="line">const myJsonSchema = zodToJsonSchema(myObjectSchema, {</div>
<div class="line">  definitions: { myRecurringSchema },</div>
<div class="line">});</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md36445"></a>
Result</h3>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;type&quot;: &quot;object&quot;,</div>
<div class="line">  &quot;properties&quot;: {</div>
<div class="line">    &quot;a&quot;: {</div>
<div class="line">      &quot;$ref&quot;: &quot;#/definitions/myRecurringSchema&quot;</div>
<div class="line">    },</div>
<div class="line">    &quot;b&quot;: {</div>
<div class="line">      &quot;$ref&quot;: &quot;#/definitions/myRecurringSchema&quot;</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line">  &quot;definitions&quot;: {</div>
<div class="line">    &quot;myRecurringSchema&quot;: {</div>
<div class="line">      &quot;type&quot;: &quot;string&quot;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md36446"></a>
Error Messages</h2>
<p>This feature allows optionally including error messages created via chained function calls for supported zod types:</p>
<div class="fragment"><div class="line">// string schema with additional chained function call checks</div>
<div class="line">const EmailSchema = z.string().email(&quot;Invalid email&quot;).min(5, &quot;Too short&quot;);</div>
<div class="line"> </div>
<div class="line">const jsonSchema = zodToJsonSchema(EmailSchema, { errorMessages: true });</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md36447"></a>
Result</h3>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,</div>
<div class="line">  &quot;type&quot;: &quot;string&quot;,</div>
<div class="line">  &quot;format&quot;: &quot;email&quot;,</div>
<div class="line">  &quot;minLength&quot;: 5,</div>
<div class="line">  &quot;errorMessage&quot;: {</div>
<div class="line">    &quot;format&quot;: &quot;Invalid email&quot;,</div>
<div class="line">    &quot;minLength&quot;: &quot;Too short&quot;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>This allows for field specific, validation step specific error messages which can be useful for building forms and such. This format is accepted by <code>react-hook-form</code>'s ajv resolver (and therefor <code>ajv-errors</code> which it uses under the hood). Note that if using AJV with this format will require <a href="https://ajv.js.org/packages/ajv-errors.html#usage">enabling <code>ajv-errors</code></a> as vanilla AJV does not accept this format by default.</p>
<h3><a class="anchor" id="autotoc_md36448"></a>
Custom Error Message Support</h3>
<ul>
<li>ZodString<ul>
<li>regex</li>
<li>min, max</li>
<li>email, cuid, uuid, url</li>
<li>endsWith, startsWith</li>
</ul>
</li>
<li>ZodNumber<ul>
<li>min, max, lt, lte, gt, gte,</li>
<li>int</li>
<li>multipleOf</li>
</ul>
</li>
<li>ZodSet<ul>
<li>min, max</li>
</ul>
</li>
<li>ZodArray<ul>
<li>min, max</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md36449"></a>
Additional properties</h2>
<p>By default, Zod removes undeclared properties when parsing object schemas. In order to replicate the expected output of this behaviour, the default for behaviour of zodToJsonSchema is to set <code>"additionalProperties"</code> to <code>false</code> (although the correctness of this can be debated). If you wish to allow undeclared properties you can either:</p>
<ul>
<li>Set <code>removeAdditionalStrategy</code> to <code>"strict"</code>. This will allow additional properties for any object schema that is not declared with <code>.strict()</code>.</li>
<li>Leave <code>removeAdditionalStrategy</code> set to its default value of <code>"passthrough"</code>, and add <code>.passtrough()</code> to your object schema.</li>
</ul>
<h3><a class="anchor" id="autotoc_md36450"></a>
Removing the <code>additionalProperties</code> keyword using the <code>allowedAdditionalProperties</code> and/or <code>rejectedAdditionalProperties</code> options.</h3>
<p>Some schema definitions (like Googles Gen AI API for instance) does not allow the <code>additionalProperties</code> keyword at all. Luckily the JSON Schema spec allows for this: leaving the keyword undefined <em>should</em> have the same effect as setting it to true (as per usual YMMV). To enable this behaviour, set the option <code>allowedAdditionalProperties</code> to <code>undefined</code>.</p>
<p>To exclude the keyword even when additional properties are <em>not</em> allowed, set the <code>rejectedAdditionalProperties</code> to <code>undefined</code> as well.</p>
<p><em>Heads up ⚠️: Both of these options will be ignored if your schema is declared with <code>.catchall(...)</code> as the provided schema will be used instead (if valid).</em></p>
<h3><a class="anchor" id="autotoc_md36451"></a>
Expected outputs</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><code>z.object({})</code> + option   </th><th class="markdownTableHeadNone"><code>"additionalProperties"</code> value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>.strip()</code> (default)   </td><td class="markdownTableBodyNone"><code>false</code> if strategy is <code>"passtrough"</code>, <code>true</code> if <code>"strict"</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>.passtrough()</code>   </td><td class="markdownTableBodyNone"><code>true</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>.strict()</code>   </td><td class="markdownTableBodyNone"><code>false</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>.catchall(z.string())</code>   </td><td class="markdownTableBodyNone"><code>{ "type": "string" }</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>.catchall(z.function())</code>   </td><td class="markdownTableBodyNone"><code>undefined</code> (function schemas are not currently parseable)   </td></tr>
</table>
<p>Substitute <code>true</code> and <code>false</code> for <code>undefined</code> according to <code>allowedAdditionalProperties</code> and/or <code>rejectedAdditionalProperties</code> respectively.</p>
<h2><a class="anchor" id="autotoc_md36452"></a>
<code>override</code></h2>
<p>This options takes a callback receiving a Zod schema definition, the current reference object (containing the current ref path and other options), an argument containing inforation about wether or not the schema has been encountered before, and a forceResolution argument.</p>
<p>Important: if you don't want to override the current item you have to return the <code>ignoreOverride</code> symbol exported from the index. This is because <code>undefined</code> is a valid option to return when you want the property to be excluded from the resulting JSON schema.</p>
<div class="fragment"><div class="line">import zodToJsonSchema, { ignoreOverride } from &quot;zod-to-json-schema&quot;;</div>
<div class="line"> </div>
<div class="line">zodToJsonSchema(</div>
<div class="line">  z.object({</div>
<div class="line">    ignoreThis: z.string(),</div>
<div class="line">    overrideThis: z.string(),</div>
<div class="line">    removeThis: z.string(),</div>
<div class="line">  }),</div>
<div class="line">  {</div>
<div class="line">    override: (def, refs) =&gt; {</div>
<div class="line">      const path = refs.currentPath.join(&quot;/&quot;);</div>
<div class="line"> </div>
<div class="line">      if (path === &quot;#/properties/overrideThis&quot;) {</div>
<div class="line">        return {</div>
<div class="line">          type: &quot;integer&quot;,</div>
<div class="line">        };</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      if (path === &quot;#/properties/removeThis&quot;) {</div>
<div class="line">        return undefined;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      // Important! Do not return `undefined` or void unless you want to remove the property from the resulting schema completely.</div>
<div class="line">      return ignoreOverride;</div>
<div class="line">    },</div>
<div class="line">  },</div>
<div class="line">);</div>
</div><!-- fragment --><p>Expected output:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;type&quot;: &quot;object&quot;,</div>
<div class="line">  &quot;required&quot;: [&quot;ignoreThis&quot;, &quot;overrideThis&quot;],</div>
<div class="line">  &quot;properties&quot;: {</div>
<div class="line">    &quot;ignoreThis&quot;: {</div>
<div class="line">      &quot;type&quot;: &quot;string&quot;</div>
<div class="line">    },</div>
<div class="line">    &quot;overrideThis&quot;: {</div>
<div class="line">      &quot;type&quot;: &quot;integer&quot;</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line">  &quot;additionalProperties&quot;: false</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md36453"></a>
<code>postProcess</code></h2>
<p>Besided receiving all arguments of the <code>override</code> callback, the <code>postProcess</code> callback also receives the generated schema. It should always return a JSON Schema, or <code>undefined</code> if you wish to filter it out. Unlike the <code>override</code> callback you do not have to return <code>ignoreOverride</code> if you are happy with the produced schema; simply return it unchanged.</p>
<div class="fragment"><div class="line">import zodToJsonSchema, { PostProcessCallback } from &quot;zod-to-json-schema&quot;;</div>
<div class="line"> </div>
<div class="line">// Define the callback to be used to process the output using the PostProcessCallback type:</div>
<div class="line">const postProcess: PostProcessCallback = (</div>
<div class="line">  // The original output produced by the package itself:</div>
<div class="line">  jsonSchema,</div>
<div class="line">  // The ZodSchema def used to produce the original schema:</div>
<div class="line">  def,</div>
<div class="line">  // The refs object containing the current path, passed options, etc.</div>
<div class="line">  refs,</div>
<div class="line">) =&gt; {</div>
<div class="line">  if (!jsonSchema) {</div>
<div class="line">    return jsonSchema;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  // Try to expand description as JSON meta:</div>
<div class="line">  if (jsonSchema.description) {</div>
<div class="line">    try {</div>
<div class="line">      jsonSchema = {</div>
<div class="line">        ...jsonSchema,</div>
<div class="line">        ...JSON.parse(jsonSchema.description),</div>
<div class="line">      };</div>
<div class="line">    } catch {}</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  // Make all numbers nullable:</div>
<div class="line">  if (&quot;type&quot; in jsonSchema! &amp;&amp; jsonSchema.type === &quot;number&quot;) {</div>
<div class="line">    jsonSchema.type = [&quot;number&quot;, &quot;null&quot;];</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  // Add the refs path, just because</div>
<div class="line">  (jsonSchema as any).path = refs.currentPath;</div>
<div class="line"> </div>
<div class="line">  return jsonSchema;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">const jsonSchema = zodToJsonSchema(zodSchema, { postProcess });</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md36454"></a>
Using <code>postProcess</code> for including examples and other meta</h3>
<p>Adding support for examples and other JSON Schema meta keys are among the most commonly requested features for this project. Unfortunately the current Zod major (3) has pretty anemic support for this, so some userland hacking is required. Since this is such a common usecase I've included a helper function that simply tries to parse any description as JSON and expand it into the resulting schema.</p>
<p>Simply stringify whatever you want added to the output schema as the description, then import and use <code>jsonDescription</code> as the postProcess option:</p>
<div class="fragment"><div class="line">import zodToJsonSchema, { jsonDescription } from &quot;zod-to-json-schema&quot;;</div>
<div class="line"> </div>
<div class="line">const zodSchema = z.string().describe(</div>
<div class="line">  JSON.stringify({</div>
<div class="line">    title: &quot;My string&quot;,</div>
<div class="line">    description: &quot;My description&quot;,</div>
<div class="line">    examples: [&quot;Foo&quot;, &quot;Bar&quot;],</div>
<div class="line">    whatever: 123,</div>
<div class="line">  }),</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line">const jsonSchema = zodToJsonSchema(zodSchema, {</div>
<div class="line">  postProcess: jsonDescription,</div>
<div class="line">});</div>
</div><!-- fragment --><p>Expected output:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,</div>
<div class="line">  &quot;type&quot;: &quot;string&quot;,</div>
<div class="line">  &quot;title&quot;: &quot;My string&quot;,</div>
<div class="line">  &quot;description&quot;: &quot;My description&quot;,</div>
<div class="line">  &quot;examples&quot;: [&quot;Foo&quot;, &quot;Bar&quot;],</div>
<div class="line">  &quot;whatever&quot;: 123</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md36455"></a>
Known issues</h1>
<ul>
<li>The OpenAI target should be considered experimental for now, as some combination of options may break the compatibility.</li>
<li>When using <code>.transform</code>, the return type is inferred from the supplied function. In other words, there is no schema for the return type, and there is no way to convert it in runtime. Currently the JSON schema will therefore reflect the input side of the Zod schema and not necessarily the output (the latter aka. <code>z.infer</code>). If this causes problems with your schema, consider using the effectStrategy "any", which will allow any type of output.</li>
<li>JSON Schemas does not support any other key type than strings for objects. When using <code>z.record</code> with any other key type, this will be ignored. An exception to this rule is <code>z.enum</code> as is supported since 3.11.3</li>
<li>Relative JSON pointers, while published alongside <a href="https://json-schema.org/specification.html">JSON schema draft 2020-12</a>, is not technically a part of it. Currently, most resolvers do not handle them at all.</li>
<li>Since v3, the Object parser uses <code>.isOptional()</code> to check if a property should be included in <code>required</code> or not. This has the potentially dangerous behavior of calling <code>.safeParse</code> with <code>undefined</code>. To work around this, make sure your <code>preprocess</code> and other effects callbacks are pure and not liable to throw errors. An issue has been logged in the Zod repo and can be <a href="https://github.com/colinhacks/zod/issues/1460">tracked here</a>.</li>
<li>JSON Schema version 2020-12 is not yet officially supported. However, you should be able to use this library to obtain a compatible schema for the 2020-12 format just by changing the returned schema's <code>$schema</code> field to: "https://json-schema.org/draft/2020-12/schema#"</li>
</ul>
<h1><a class="anchor" id="autotoc_md36456"></a>
Versioning</h1>
<p>This package <em>does not</em> follow semantic versioning. The major and minor versions of this package instead reflects feature parity with the <a href="http://npmjs.com/package/zod">Zod package</a>.</p>
<p>I will do my best to keep API-breaking changes to an absolute minimum, but new features may appear as "patches", such as introducing the options pattern in 3.9.1.</p>
<h1><a class="anchor" id="autotoc_md36457"></a>
Changelog</h1>
<p><a href="https://github.com/StefanTerdell/zod-to-json-schema/blob/master/changelog.md">https://github.com/StefanTerdell/zod-to-json-schema/blob/master/changelog.md</a> </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_acd06b18086a0dd2ae699b1e0b775be8.html">node_modules</a></li><li class="navelem"><a class="el" href="dir_a3ee01472ce8b3f89e14777cf1798715.html">zod-to-json-schema</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
