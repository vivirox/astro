<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gradiant Ascent: node_modules/foreground-child Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Gradiant Ascent
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dir_4ddde1ca7ef7ffc9a929b80245dae6be.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">foreground-child Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Run a child as if it's the foreground process. Give it stdio. Exit when it exits.</p>
<p>Mostly this module is here to support some use cases around wrapping child processes for test coverage and such. But it's also generally useful any time you want one program to execute another as if it's the "main" process, for example, if a program takes a <code>--cmd</code> argument to execute in some way.</p>
<h1><a class="anchor" id="autotoc_md15765"></a>
USAGE</h1>
<div class="fragment"><div class="line">import { foregroundChild } from &#39;foreground-child&#39;</div>
<div class="line">// hybrid module, this also works:</div>
<div class="line">// const { foregroundChild } = require(&#39;foreground-child&#39;)</div>
<div class="line"> </div>
<div class="line">// cats out this file</div>
<div class="line">const child = foregroundChild(&#39;cat&#39;, [__filename])</div>
<div class="line"> </div>
<div class="line">// At this point, it&#39;s best to just do nothing else.</div>
<div class="line">// return or whatever.</div>
<div class="line">// If the child gets a signal, or just exits, then this</div>
<div class="line">// parent process will exit in the same way.</div>
</div><!-- fragment --><p>You can provide custom spawn options by passing an object after the program and arguments:</p>
<div class="fragment"><div class="line">const child = foregroundChild(`cat ${__filename}`, { shell: true })</div>
</div><!-- fragment --><p>A callback can optionally be provided, if you want to perform an action before your foreground-child exits:</p>
<div class="fragment"><div class="line">const child = foregroundChild(&#39;cat&#39;, [__filename], spawnOptions, () =&gt; {</div>
<div class="line">  doSomeActions()</div>
<div class="line">})</div>
</div><!-- fragment --><p>The callback can return a Promise in order to perform asynchronous actions. If the callback does not return a promise, then it must complete its actions within a single JavaScript tick.</p>
<div class="fragment"><div class="line">const child = foregroundChild(&#39;cat&#39;, [__filename], async () =&gt; {</div>
<div class="line">  await doSomeAsyncActions()</div>
<div class="line">})</div>
</div><!-- fragment --><p>If the callback throws or rejects, then it will be unhandled, and node will exit in error.</p>
<p>If the callback returns a string value, then that will be used as the signal to exit the parent process. If it returns a number, then that number will be used as the parent exit status code. If it returns boolean <code>false</code>, then the parent process will not be terminated. If it returns <code>undefined</code>, then it will exit with the same signal/code as the child process.</p>
<h1><a class="anchor" id="autotoc_md15766"></a>
Caveats</h1>
<p>The "normal" standard IO file descriptors (0, 1, and 2 for stdin, stdout, and stderr respectively) are shared with the child process. Additionally, if there is an IPC channel set up in the parent, then messages are proxied to the child on file descriptor 3.</p>
<p>In Node, it's possible to also map arbitrary file descriptors into a child process. In these cases, foreground-child will not map the file descriptors into the child. If file descriptors 0, 1, or 2 are used for the IPC channel, then strange behavior may happen (like printing IPC messages to stderr, for example).</p>
<p>Note that a SIGKILL will always kill the parent process, but will not proxy the signal to the child process, because SIGKILL cannot be caught. In order to address this, a special "watchdog" child process is spawned which will send a SIGKILL to the child process if it does not terminate within half a second after the watchdog receives a SIGHUP due to its parent terminating.</p>
<p>On Windows, issuing a <code>process.kill(process.pid, signal)</code> with a fatal termination signal may cause the process to exit with a <code>1</code> status code rather than reporting the signal properly. This module tries to do the right thing, but on Windows systems, you may see that incorrect result. There is as far as I'm aware no workaround for this.</p>
<h1><a class="anchor" id="autotoc_md15767"></a>
util: <code>foreground-child/proxy-signals</code></h1>
<p>If you just want to proxy the signals to a child process that the main process receives, you can use the <code>proxy-signals</code> export from this package.</p>
<div class="fragment"><div class="line">import { proxySignals } from &#39;foreground-child/proxy-signals&#39;</div>
<div class="line"> </div>
<div class="line">const childProcess = spawn(&#39;command&#39;, [&#39;some&#39;, &#39;args&#39;])</div>
<div class="line">proxySignals(childProcess)</div>
</div><!-- fragment --><p>Now, any fatal signal received by the current process will be proxied to the child process.</p>
<p>It doesn't go in the other direction; ie, signals sent to the child process will not affect the parent. For that, listen to the child <code>exit</code> or <code>close</code> events, and handle them appropriately.</p>
<h1><a class="anchor" id="autotoc_md15768"></a>
util: <code>foreground-child/watchdog</code></h1>
<p>If you are spawning a child process, and want to ensure that it isn't left dangling if the parent process exits, you can use the watchdog utility exported by this module.</p>
<div class="fragment"><div class="line">import { watchdog } from &#39;foreground-child/watchdog&#39;</div>
<div class="line"> </div>
<div class="line">const childProcess = spawn(&#39;command&#39;, [&#39;some&#39;, &#39;args&#39;])</div>
<div class="line">const watchdogProcess = watchdog(childProcess)</div>
<div class="line"> </div>
<div class="line">// watchdogProcess is a reference to the process monitoring the</div>
<div class="line">// parent and child. There&#39;s usually no reason to do anything</div>
<div class="line">// with it, as it&#39;s silent and will terminate</div>
<div class="line">// automatically when it&#39;s no longer needed.</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_acd06b18086a0dd2ae699b1e0b775be8.html">node_modules</a></li><li class="navelem"><a class="el" href="dir_4ddde1ca7ef7ffc9a929b80245dae6be.html">foreground-child</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
