<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gradiant Ascent: node_modules/@vercel/nft Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Gradiant Ascent
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dir_707e61e6bffdd92eee801c71aaad94e0.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">nft Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="subdirs" name="subdirs"></a>
Directories</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top"><span class="iconfclosed"></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_24c8a76d14364bfc335cf2f1093d28e8.html">node_modules</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p><a href="https://github.com/vercel/nft/actions/workflows/ci.yml"><img src="https://github.com/vercel/nft/actions/workflows/ci.yml/badge.svg" alt="CI Status" style="pointer-events: none;" class="inline"/></a></p>
<p>Used to determine exactly which files (including <code>node_modules</code>) are necessary for the application runtime.</p>
<p>This is similar to <a href="https://npmjs.com/package/@vercel/ncc">@vercel/ncc</a> except there is no bundling performed and therefore no reliance on webpack. This achieves the same tree-shaking benefits without moving any assets or binaries.</p>
<h1><a class="anchor" id="autotoc_md7181"></a>
Usage</h1>
<h2><a class="anchor" id="autotoc_md7182"></a>
Installation</h2>
<div class="fragment"><div class="line">npm i @vercel/nft</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7183"></a>
Usage</h2>
<p>Provide the list of source files as input:</p>
<div class="fragment"><div class="line">const { nodeFileTrace } = require(&#39;@vercel/nft&#39;);</div>
<div class="line">const files = [&#39;./src/main.js&#39;, &#39;./src/second.js&#39;];</div>
<div class="line">const { fileList } = await nodeFileTrace(files);</div>
</div><!-- fragment --><p>The list of files will include all <code>node_modules</code> modules and assets that may be needed by the application code.</p>
<h2><a class="anchor" id="autotoc_md7184"></a>
Options</h2>
<h3><a class="anchor" id="autotoc_md7185"></a>
Base</h3>
<p>The base path for the file list - all files will be provided as relative to this base.</p>
<p>By default the <code>process.cwd()</code> is used:</p>
<div class="fragment"><div class="line">const { fileList } = await nodeFileTrace(files, {</div>
<div class="line">  base: process.cwd(),</div>
<div class="line">});</div>
</div><!-- fragment --><p>Any files/folders above the <code>base</code> are ignored in the listing and analysis.</p>
<h3><a class="anchor" id="autotoc_md7186"></a>
Process Cwd</h3>
<p>When applying analysis certain functions rely on the <code>process.cwd()</code> value, such as &lsquo;path.resolve(&rsquo;./relative')<code>or even a direct</code>process.cwd()` invocation.</p>
<p>Setting the <code>processCwd</code> option allows this analysis to be guided to the right path to ensure that assets are correctly detected.</p>
<div class="fragment"><div class="line">const { fileList } = await nodeFileTrace(files, {</div>
<div class="line">  processCwd: path.resolve(__dirname),</div>
<div class="line">});</div>
</div><!-- fragment --><p>By default <code>processCwd</code> is the same as <code>base</code>.</p>
<h3><a class="anchor" id="autotoc_md7187"></a>
Exports &amp; Imports</h3>
<p>By default tracing of the <a href="https://nodejs.org/dist/latest-v14.x/docs/api/esm.html#esm_package_entry_points">Node.js "exports" and "imports" fields</a> is supported, with the <code>"node"</code>, <code>"require"</code>, <code>"import"</code> and <code>"default"</code> conditions traced as defined.</p>
<p>Alternatively the explicit list of conditions can be provided:</p>
<div class="fragment"><div class="line">const { fileList } = await nodeFileTrace(files, {</div>
<div class="line">  conditions: [&#39;node&#39;, &#39;production&#39;],</div>
<div class="line">});</div>
</div><!-- fragment --><p>Only the <code>"node"</code> export should be explicitly included (if needed) when specifying the exact export condition list. The <code>"require"</code>, <code>"import"</code> and <code>"default"</code> conditions will always be traced as defined, no matter what custom conditions are set.</p>
<h3><a class="anchor" id="autotoc_md7188"></a>
Exports Only</h3>
<p>When tracing exports the <code>"main"</code> / index field will still be traced for Node.js versions without <code>"exports"</code> support.</p>
<p>This can be disabled with the <code>exportsOnly</code> option:</p>
<div class="fragment"><div class="line">const { fileList } = await nodeFileTrace(files, {</div>
<div class="line">  exportsOnly: true,</div>
<div class="line">});</div>
</div><!-- fragment --><p>Any package with <code>"exports"</code> will then only have its exports traced, and the main will not be included at all. This can reduce the output size when targeting <a href="https://github.com/nodejs/node/blob/master/doc/changelogs/CHANGELOG_V12.md#12.17.0">Node.js 12.17.0</a> or newer.</p>
<h3><a class="anchor" id="autotoc_md7189"></a>
Paths</h3>
<blockquote class="doxtable">
<p>Status: Experimental. May change at any time. </p>
</blockquote>
<p>Custom resolution path definitions to use.</p>
<div class="fragment"><div class="line">const { fileList } = await nodeFileTrace(files, {</div>
<div class="line">  paths: {</div>
<div class="line">    &#39;utils/&#39;: &#39;/path/to/utils/&#39;,</div>
<div class="line">  },</div>
<div class="line">});</div>
</div><!-- fragment --><p>Trailing slashes map directories, exact paths map exact only.</p>
<h3><a class="anchor" id="autotoc_md7190"></a>
Hooks</h3>
<p>The following FS functions can be hooked by passing them as options:</p>
<ul>
<li><code>readFile(path): Promise&lt;string&gt;</code></li>
<li><code>stat(path): Promise&lt;FS.Stats&gt;</code></li>
<li><code>readlink(path): Promise&lt;string&gt;</code></li>
<li><code>resolve(id: string, parent: string): Promise&lt;string | string[]&gt;</code></li>
</ul>
<h4><a class="anchor" id="autotoc_md7191"></a>
Advanced Resolving</h4>
<p>When providing a custom resolve hook you are responsible for returning one or more absolute paths to resolved files based on the <code>id</code> input. However it may be the case that you only want to augment or override the resolve behavior in certain cases. You can use <code>nft</code>'s underlying resolver by importing it. The builtin <code>resolve</code> function expects additional arguments that need to be forwarded from the hook</p>
<ul>
<li><code>resolve(id: string, parent: string, job: Job, isCjs: boolean): Promise&lt;string | string[]&gt;</code></li>
</ul>
<p>Here is an example showing one id being resolved to a bespoke path while all other paths being resolved by the built-in resolver</p>
<div class="fragment"><div class="line">const { nodeFileTrace, resolve } = require(&#39;@vercel/nft&#39;);</div>
<div class="line">const files = [&#39;./src/main.js&#39;, &#39;./src/second.js&#39;];</div>
<div class="line">const { fileList } = await nodeFileTrace(files, {</div>
<div class="line">  resolve: async (id, parent, job, isCjs) =&gt; {</div>
<div class="line">    if (id === &#39;./src/main.js&#39;) {</div>
<div class="line">      return &#39;/path/to/some/resolved/main/file.js&#39;;</div>
<div class="line">    } else {</div>
<div class="line">      return resolve(id, parent, job, isCjs);</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line">});</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7192"></a>
TypeScript</h3>
<p>The internal resolution supports resolving <code>.ts</code> files in traces by default.</p>
<p>By its nature of integrating into existing build systems, the TypeScript compiler is not included in this project - rather the TypeScript transform layer requires separate integration into the <code>readFile</code> hook.</p>
<h3><a class="anchor" id="autotoc_md7193"></a>
File IO Concurrency</h3>
<p>In some large projects, the file tracing logic may process many files at the same time. In this case, if you do not limit the number of concurrent files IO, OOM problems are likely to occur.</p>
<p>We use a default of 1024 concurrency to balance performance and memory usage for fs operations. You can increase this value to a higher number for faster speed, but be aware of the memory issues if the concurrency is too high.</p>
<div class="fragment"><div class="line">const { fileList } = await nodeFileTrace(files, {</div>
<div class="line">  fileIOConcurrency: 2048,</div>
<div class="line">});</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7194"></a>
Analysis</h3>
<p>Analysis options allow customizing how much analysis should be performed to exactly work out the dependency list.</p>
<p>By default as much analysis as possible is done to ensure no possibly needed files are left out of the trace.</p>
<p>To disable all analysis, set <code>analysis: false</code>. Alternatively, individual analysis options can be customized via:</p>
<div class="fragment"><div class="line">const { fileList } = await nodeFileTrace(files, {</div>
<div class="line">  // default</div>
<div class="line">  analysis: {</div>
<div class="line">    // whether to glob any analysis like __dirname + &#39;/dir/&#39; or require(&#39;x/&#39; + y)</div>
<div class="line">    // that might output any file in a directory</div>
<div class="line">    emitGlobs: true,</div>
<div class="line">    // whether __filename and __dirname style</div>
<div class="line">    // expressions should be analyzed as file references</div>
<div class="line">    computeFileReferences: true,</div>
<div class="line">    // evaluate known bindings to assist with glob and file reference analysis</div>
<div class="line">    evaluatePureExpressions: true,</div>
<div class="line">  },</div>
<div class="line">});</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7195"></a>
Ignore</h3>
<p>Custom ignores can be provided to skip file inclusion (and consequently analysis of the file for references in turn as well).</p>
<div class="fragment"><div class="line">const { fileList } = await nodeFileTrace(files, {</div>
<div class="line">  ignore: [&#39;./node_modules/pkg/file.js&#39;],</div>
<div class="line">});</div>
</div><!-- fragment --><p>Ignore will also accept a function or globs.</p>
<p>Note that the path provided to ignore is relative to <code>base</code>.</p>
<h3><a class="anchor" id="autotoc_md7196"></a>
Cache</h3>
<p>To persist the file cache between builds, pass an empty <code>cache</code> object:</p>
<div class="fragment"><div class="line">const cache = Object.create(null);</div>
<div class="line">const { fileList } = await nodeFileTrace([&#39;index.ts&#39;], { cache });</div>
<div class="line">// later:</div>
<div class="line">{</div>
<div class="line">  const { fileList } = await nodeFileTrace([&#39;index.ts&#39;], { cache });</div>
<div class="line">}</div>
</div><!-- fragment --><p>Note that cache invalidations are not supported so the assumption is that the file system is not changed between runs.</p>
<h3><a class="anchor" id="autotoc_md7197"></a>
Reasons</h3>
<p>To get the underlying reasons for individual files being included, a <code>reasons</code> object is also provided by the output:</p>
<div class="fragment"><div class="line">const { fileList, reasons } = await nodeFileTrace(files);</div>
</div><!-- fragment --><p>The <code>reasons</code> output will then be an object of the following form:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  [file: string]: {</div>
<div class="line">    type: &#39;dependency&#39; | &#39;asset&#39; | &#39;sharedlib&#39;,</div>
<div class="line">    ignored: true | false,</div>
<div class="line">    parents: string[]</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p><code>reasons</code> also includes files that were ignored as <code>ignored: true</code>, with their <code>ignoreReason</code>.</p>
<p>Every file is included because it is referenced by another file. The <code>parents</code> list will contain the list of all files that caused this file to be included. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_acd06b18086a0dd2ae699b1e0b775be8.html">node_modules</a></li><li class="navelem"><a class="el" href="dir_0d549eb598669cfdb5e8a4e1047dacaf.html">@vercel</a></li><li class="navelem"><a class="el" href="dir_707e61e6bffdd92eee801c71aaad94e0.html">nft</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
