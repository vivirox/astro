"use strict";(()=>{var e={};e.id=49,e.ids=[49],e.modules={3162:(e,r,t)=>{t.r(r),t.d(r,{config:()=>d,default:()=>u,routeModule:()=>c});var n={};t.r(n),t.d(n,{GET:()=>a});var i=t(3480),o=t(8667),s=t(6435);(function(){var e=Error("Cannot find module '../../../lib/audit/log.js'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '../../../lib/auth/session.js'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module '../../../lib/db/ai/index.js'");throw e.code="MODULE_NOT_FOUND",e}();let a=async({request:e,url:r})=>{let t;try{if(!(t=await Object(function(){var e=Error("Cannot find module '../../../lib/auth/session.js'");throw e.code="MODULE_NOT_FOUND",e}())(e)))return new Response(JSON.stringify({error:"Unauthorized"}),{status:401,headers:{"Content-Type":"application/json"}});if(t?.user?.role!=="admin")return new Response(JSON.stringify({error:"Forbidden: Admin access required"}),{status:403,headers:{"Content-Type":"application/json"}});let n=Number.parseInt(r.searchParams.get("limit")||"20",10),i=Number.parseInt(r.searchParams.get("offset")||"0",10);await Object(function(){var e=Error("Cannot find module '../../../lib/audit/log.js'");throw e.code="MODULE_NOT_FOUND",e}())({userId:t?.user?.id||"anonymous",action:"ai.crisis.high-risk.request",resource:"ai",resourceId:void 0,metadata:{limit:n,offset:i}});let o=await Object(function(){var e=Error("Cannot find module '../../../lib/db/ai/index.js'");throw e.code="MODULE_NOT_FOUND",e}()).getHighRiskCrisisDetections(n,i);return await Object(function(){var e=Error("Cannot find module '../../../lib/audit/log.js'");throw e.code="MODULE_NOT_FOUND",e}())({userId:t?.user?.id||"anonymous",action:"ai.crisis.high-risk.response",resource:"ai",resourceId:void 0,metadata:{limit:n,offset:i,detectionsCount:o.length,status:"success"}}),new Response(JSON.stringify({detections:o}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error retrieving high-risk crisis detections:",e),new Response(JSON.stringify({error:e instanceof Error?e?.message:"Internal server error"}),{status:500,headers:{"Content-Type":"application/json"}})}},u=(0,s.M)(n,"default"),d=(0,s.M)(n,"config"),c=new i.PagesAPIRouteModule({definition:{kind:o.A.PAGES_API,page:"/api/ai/high-risk-detections",pathname:"/api/ai/high-risk-detections",bundlePath:"",filename:""},userland:n})},3480:(e,r,t)=>{e.exports=t(5600)},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var t=r(r.s=3162);module.exports=t})();