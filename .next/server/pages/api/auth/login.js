"use strict";(()=>{var e={};e.id=143,e.ids=[143],e.modules={3713:e=>{e.exports=import("jotai")},5091:e=>{e.exports=import("jotai/utils")},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6676:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{POST:()=>u});var n=r(3719),s=r(901),i=r(8951),o=r(6762),c=e([o]);o=(c.then?(await c)():c)[0];let d=(0,i.tZ)();async function u(e){try{let t=await e.json(),r={id:`user-${crypto.randomUUID()}`,email:t.email},a={sessionId:`session-${crypto.randomUUID()}`,userId:r.id,startTime:Date.now(),expiresAt:Date.now()+864e5,securityLevel:t.securityLevel||"medium",metadata:{ipAddress:e.headers.get("x-forwarded-for")||"unknown",userAgent:e.headers.get("user-agent")||"unknown"}},i=await (0,o.Hu)(JSON.stringify(a)),c=null;"low"!==a.securityLevel&&(await n.BO.initialize({mode:"high"===a.securityLevel?s.vS.FHE:s.vS.STANDARD,securityLevel:a.securityLevel}),c=await n.BO.encrypt(JSON.stringify({userId:a.userId,sessionId:a.sessionId,metadata:a.metadata})));let u={...a,verificationToken:i,securityMetadata:{encryptionEnabled:"low"!==a.securityLevel,encryptedData:c,encryptionMode:"high"===a.securityLevel?s.vS.FHE:s.vS.STANDARD,timestamp:Date.now()}};return d.info("User authenticated successfully",{userId:r.id,securityLevel:a.securityLevel,timestamp:Date.now()}),new Response(JSON.stringify({success:!0,session:u}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return d.error("Login error:",{message:e instanceof Error?e?.message:String(e)}),new Response(JSON.stringify({success:!1,message:"Authentication failed",error:e instanceof Error?e?.message:"Unknown error"}),{status:401,headers:{"Content-Type":"application/json"}})}}a()}catch(e){a(e)}})},6762:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{Hu:()=>u});var n=r(3713),s=r(5091),i=r(3719);r(901);var o=r(8951),c=e([n,s]);[n,s]=c.then?(await c)():c;let d=(0,o.tZ)();("undefined"!=typeof process?process.env:{}).NODE_ENV,(0,n.atom)(!1),(0,s.atomWithStorage)("chatEncryptionKeys",null),(0,s.atomWithStorage)("chatSecurityLevel","medium");let l=i.BO,p="undefined"!=typeof process&&process.env&&process.env.SECRET_KEY||"default-secret-key";async function u(e){try{if(l.createVerificationToken)return await l.createVerificationToken(e);let t=Date.now().toString(),r=`${e}:${t}`;return`${function(e){try{{let t=new TextEncoder().encode(e+p);return btoa(String.fromCharCode.apply(null,Array.from(t)))}}catch(t){let e={message:t instanceof Error?t.message:String(t)};return d.error("Signature creation error:",e),""}}(r)}.${t}`}catch(t){let e={message:t instanceof Error?t.message:String(t)};throw d.error("Verification token generation error:",e),t}}a()}catch(e){a(e)}})},8688:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>d,default:()=>u,routeModule:()=>l});var n=r(3480),s=r(8667),i=r(6435),o=r(6676),c=e([o]);o=(c.then?(await c)():c)[0];let u=(0,i.M)(o,"default"),d=(0,i.M)(o,"config"),l=new n.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/auth/login",pathname:"/api/auth/login",bundlePath:"",filename:""},userland:o});a()}catch(e){a(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[94],()=>r(8688));module.exports=a})();