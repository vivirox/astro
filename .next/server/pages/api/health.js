"use strict";(()=>{var e={};e.id=189,e.ids=[189],e.modules={325:(e,t,n)=>{n.a(e,async(e,r)=>{try{let i;n.d(t,{Ay:()=>l,_K:()=>_});var a=n(2971),s=e([a]);let E=(a=(s.then?(await s)():s)[0]).z.object({NODE_ENV:a.z.enum(["development","production","test"]).default("development"),VERCEL:a.z.string().optional(),VERCEL_ENV:a.z.enum(["development","preview","production"]).optional(),VERCEL_URL:a.z.string().optional(),VERCEL_TOKEN:a.z.string().optional(),VERCEL_ORG_ID:a.z.string().optional(),VERCEL_PROJECT_ID:a.z.string().optional(),PORT:a.z.string().transform(Number).default("3000"),LOG_LEVEL:a.z.enum(["error","warn","info","verbose","debug"]).default("info"),ENABLE_RATE_LIMITING:a.z.string().transform(e=>"true"===e).default("true"),POSTGRES_URL:a.z.string().optional(),POSTGRES_PRISMA_URL:a.z.string().optional(),POSTGRES_URL_NON_POOLING:a.z.string().optional(),SUPABASE_URL:a.z.string().url().optional(),SUPABASE_KEY:a.z.string().optional(),SUPABASE_ANON_KEY:a.z.string().optional(),SUPABASE_SERVICE_ROLE_KEY:a.z.string().optional(),SUPABASE_JWT_SECRET:a.z.string().optional(),OPENAI_API_KEY:a.z.string().optional(),OPENAI_BASE_URL:a.z.string().url().optional(),TOGETHER_API_KEY:a.z.string().optional(),GOOGLE_API_KEY:a.z.string().optional(),REPLICATE_API_TOKEN:a.z.string().optional(),SENTRY_DSN:a.z.string().url().optional(),AXIOM_DATASET:a.z.string().optional(),AXIOM_TOKEN:a.z.string().optional(),VITE_LITLYX_PROJECT_ID:a.z.string().optional(),VITE_LITLYX_API_KEY:a.z.string().optional(),EMAIL_FROM:a.z.string().email().optional(),RESEND_API_KEY:a.z.string().optional(),SECURITY_ENABLE_BRUTE_FORCE_PROTECTION:a.z.string().transform(e=>"true"===e).default("true"),SECURITY_MAX_LOGIN_ATTEMPTS:a.z.string().transform(Number).default("5"),SECURITY_ACCOUNT_LOCKOUT_DURATION:a.z.string().transform(Number).default("1800"),SECURITY_API_ABUSE_THRESHOLD:a.z.string().transform(Number).default("100"),SECURITY_ENABLE_ALERTS:a.z.string().transform(e=>"true"===e).default("true"),RATE_LIMIT_MAX_REQUESTS:a.z.string().transform(Number).default("100"),RATE_LIMIT_WINDOW_MS:a.z.string().transform(Number).default("900000"),LOG_CONSOLE:a.z.string().transform(e=>"true"===e).default("true"),LOG_AUDIT:a.z.string().transform(e=>"true"===e).default("true"),VITE_API_URL:a.z.string().url().optional(),VITE_SUPABASE_URL:a.z.string().url().optional(),VITE_SUPABASE_ANON_KEY:a.z.string().optional()});function o(){return i||(i=E.parse(process.env)),i}let _=o(),l={isDevelopment:()=>"development"===o().NODE_ENV,isProduction:()=>"production"===o().NODE_ENV,isTest:()=>"test"===o().NODE_ENV,server:{port:()=>o().PORT,logLevel:()=>o().LOG_LEVEL,enableRateLimiting:()=>o().ENABLE_RATE_LIMITING},database:{url:()=>o().POSTGRES_URL,prismaUrl:()=>o().POSTGRES_PRISMA_URL,nonPoolingUrl:()=>o().POSTGRES_URL_NON_POOLING},supabase:{url:()=>o().SUPABASE_URL,key:()=>o().SUPABASE_KEY,anonKey:()=>o().SUPABASE_ANON_KEY,serviceRoleKey:()=>o().SUPABASE_SERVICE_ROLE_KEY,jwtSecret:()=>o().SUPABASE_JWT_SECRET},ai:{openAiKey:()=>o().OPENAI_API_KEY,openAiBaseUrl:()=>o().OPENAI_BASE_URL,togetherApiKey:()=>o().TOGETHER_API_KEY,googleApiKey:()=>o().GOOGLE_API_KEY,replicateToken:()=>o().REPLICATE_API_TOKEN},monitoring:{sentryDsn:()=>o().SENTRY_DSN,axiomDataset:()=>o().AXIOM_DATASET,axiomToken:()=>o().AXIOM_TOKEN,litlyxProjectId:()=>o().VITE_LITLYX_PROJECT_ID,litlyxApiKey:()=>o().VITE_LITLYX_API_KEY},email:{from:()=>o().EMAIL_FROM,resendApiKey:()=>o().RESEND_API_KEY},deployment:{vercelEnv:()=>o().VERCEL_ENV,isVercel:()=>o().VERCEL,vercelUrl:()=>o().VERCEL_URL,vercelToken:()=>o().VERCEL_TOKEN,vercelOrgId:()=>o().VERCEL_ORG_ID,vercelProjectId:()=>o().VERCEL_PROJECT_ID},security:{enableBruteForceProtection:()=>o().SECURITY_ENABLE_BRUTE_FORCE_PROTECTION,maxLoginAttempts:()=>o().SECURITY_MAX_LOGIN_ATTEMPTS,accountLockoutDuration:()=>o().SECURITY_ACCOUNT_LOCKOUT_DURATION,apiAbuseThreshold:()=>o().SECURITY_API_ABUSE_THRESHOLD,enableAlerts:()=>o().SECURITY_ENABLE_ALERTS},rateLimiting:{maxRequests:()=>o().RATE_LIMIT_MAX_REQUESTS,windowMs:()=>o().RATE_LIMIT_WINDOW_MS},logging:{console:()=>o().LOG_CONSOLE,audit:()=>o().LOG_AUDIT},client:{apiUrl:()=>o().VITE_API_URL,supabaseUrl:()=>o().VITE_SUPABASE_URL,supabaseAnonKey:()=>o().VITE_SUPABASE_ANON_KEY}};r()}catch(e){r(e)}})},2971:e=>{e.exports=import("zod")},3480:(e,t,n)=>{e.exports=n(5600)},3939:e=>{e.exports=require("@supabase/supabase-js")},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6233:(e,t,n)=>{n.a(e,async(e,r)=>{try{n.d(t,{Oi:()=>E});var a=n(6436),s=n(325),o=e([a,s]);[a,s]=o.then?(await o)():o;let _=process.env.UPSTASH_REDIS_REST_URL||s._K?.UPSTASH_REDIS_REST_URL,l=process.env.UPSTASH_REDIS_REST_TOKEN||s._K?.UPSTASH_REDIS_REST_TOKEN;_&&l||console.error("CRITICAL: Missing Redis credentials in production environment");let u=_&&l?new a.Redis({url:_,token:l,retry:{retries:3,backoff:e=>Math.min(500*e,3e3)}}):(console.warn("CRITICAL: Using mock Redis client in production. This should never happen."),{get:async e=>null,set:async(e,t,n)=>"OK",del:async e=>1,incr:async e=>1,exists:async e=>0,expire:async(e,t)=>1,hset:async(e,t,n)=>1,hget:async(e,t)=>null,hgetall:async e=>({}),hdel:async(e,t)=>1,disconnect:async()=>{}});async function i(){try{let e=await u.ping();return"PONG"===e}catch(e){return console.error("Redis connectivity check failed:",e),!1}}async function E(){try{if(await i())return{status:"healthy"};return{status:"unhealthy",details:{message:"Could not connect to Redis"}}}catch(e){return{status:"unhealthy",details:{message:"Redis health check failed",error:e instanceof Error?e.message:String(e)}}}}r()}catch(e){r(e)}})},6240:(e,t,n)=>{n.a(e,async(e,r)=>{try{n.r(t),n.d(t,{config:()=>l,default:()=>_,routeModule:()=>u});var a=n(3480),s=n(8667),o=n(6435),i=n(8398),E=e([i]);i=(E.then?(await E)():E)[0];let _=(0,o.M)(i,"default"),l=(0,o.M)(i,"config"),u=new a.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/health",pathname:"/api/health",bundlePath:"",filename:""},userland:i});r()}catch(e){r(e)}})},6435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},6436:e=>{e.exports=import("@upstash/redis")},8398:(e,t,n)=>{n.a(e,async(e,r)=>{try{n.r(t),n.d(t,{GET:()=>E});var a=n(3939),s=n(6233),o=e([s]);s=(o.then?(await o)():o)[0];let E=async({request:e})=>{let t=performance.now(),n={status:"healthy",api:{status:"healthy",timestamp:new Date().toISOString()}},r=new URL(e.url),a=e.headers.get("x-forwarded-for")||"unknown",o=e.headers.get("user-agent")||"unknown";console.info("Health check requested",{path:r.pathname,clientIp:a,userAgent:o});let E=(void 0).PUBLIC_SUPABASE_URL,_=(void 0).PUBLIC_SUPABASE_ANON_KEY;if(E&&_)try{n.supabase=await i(E,_)}catch(e){console.error("Error during Supabase health check:",e),n.supabase={status:"unhealthy",error:e instanceof Error?e.message:String(e)},n.status="unhealthy"}else console.warn("Health check: Missing Supabase credentials, skipping database check"),n.supabase={status:"unknown",message:"No credentials available"};try{n.redis=await (0,s.Oi)(),"unhealthy"===n.redis.status&&(n.status="unhealthy")}catch(e){console.error("Error during Redis health check:",e),n.redis={status:"unhealthy",error:e instanceof Error?e.message:String(e)},n.status="unhealthy"}let l=performance.now();return n.api.responseTimeMs=Math.round(l-t),new Response(JSON.stringify(n,null,2),{status:"healthy"===n.status?200:503,headers:{"Content-Type":"application/json","Cache-Control":"no-store, max-age=0"}})};async function i(e,t){let n=(0,a.createClient)(e,t);try{let{error:e}=await n.from("_health").select("status").limit(1).maybeSingle();if(e)throw Error(`Supabase connection check failed: ${e.message}`);return{status:"healthy",timestamp:new Date().toISOString()}}catch(e){return console.error("Supabase health check failed:",e),{status:"unhealthy",error:e instanceof Error?e.message:String(e),timestamp:new Date().toISOString()}}}r()}catch(e){r(e)}})},8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return n}});var n=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var t=require("../../webpack-api-runtime.js");t.C(e);var n=t(t.s=6240);module.exports=n})();